#!/usr/bin/env node
var zl=Object.create;var Ra=Object.defineProperty;var Jl=Object.getOwnPropertyDescriptor;var Zl=Object.getOwnPropertyNames;var ed=Object.getPrototypeOf,td=Object.prototype.hasOwnProperty;var _e=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var rd=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Zl(e))!td.call(r,i)&&i!==t&&Ra(r,i,{get:()=>e[i],enumerable:!(n=Jl(e,i))||n.enumerable});return r};var ka=(r,e,t)=>(t=r!=null?zl(ed(r)):{},rd(e||!r||!r.__esModule?Ra(t,"default",{value:r,enumerable:!0}):t,r));var Ni=_e((sb,va)=>{va.exports={newInvalidAsn1Error:function(r){var e=new Error;return e.name="InvalidAsn1Error",e.message=r||"",e}}});var Ti=_e((ob,Na)=>{Na.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}});var js=_e((fb,Ta)=>{"use strict";var Li=require("buffer"),hn=Li.Buffer,Xt={},Vt;for(Vt in Li)Li.hasOwnProperty(Vt)&&(Vt==="SlowBuffer"||Vt==="Buffer"||(Xt[Vt]=Li[Vt]));var ln=Xt.Buffer={};for(Vt in hn)hn.hasOwnProperty(Vt)&&(Vt==="allocUnsafe"||Vt==="allocUnsafeSlow"||(ln[Vt]=hn[Vt]));Xt.Buffer.prototype=hn.prototype;(!ln.from||ln.from===Uint8Array.from)&&(ln.from=function(r,e,t){if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof r);if(r&&typeof r.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);return hn(r,e,t)});ln.alloc||(ln.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof r);if(r<0||r>=2*(1<<30))throw new RangeError('The value "'+r+'" is invalid for option "size"');var n=hn(r);return!e||e.length===0?n.fill(0):typeof t=="string"?n.fill(e,t):n.fill(e),n});if(!Xt.kStringMaxLength)try{Xt.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}Xt.constants||(Xt.constants={MAX_LENGTH:Xt.kMaxLength},Xt.kStringMaxLength&&(Xt.constants.MAX_STRING_LENGTH=Xt.kStringMaxLength));Ta.exports=Xt});var Ua=_e((ab,Oa)=>{var nd=require("assert"),La=js().Buffer,Fn=Ti(),id=Ni(),dn=id.newInvalidAsn1Error;function Ht(r){if(!r||!La.isBuffer(r))throw new TypeError("data must be a node Buffer");this._buf=r,this._size=r.length,this._len=0,this._offset=0}Object.defineProperty(Ht.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(Ht.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(Ht.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Ht.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Ht.prototype.readByte=function(r){if(this._size-this._offset<1)return null;var e=this._buf[this._offset]&255;return r||(this._offset+=1),e};Ht.prototype.peek=function(){return this.readByte(!0)};Ht.prototype.readLength=function(r){if(r===void 0&&(r=this._offset),r>=this._size)return null;var e=this._buf[r++]&255;if(e===null)return null;if((e&128)===128){if(e&=127,e===0)throw dn("Indefinite length not supported");if(e>4)throw dn("encoding too long");if(this._size-r<e)return null;this._len=0;for(var t=0;t<e;t++)this._len=(this._len<<8)+(this._buf[r++]&255)}else this._len=e;return r};Ht.prototype.readSequence=function(r){var e=this.peek();if(e===null)return null;if(r!==void 0&&r!==e)throw dn("Expected 0x"+r.toString(16)+": got 0x"+e.toString(16));var t=this.readLength(this._offset+1);return t===null?null:(this._offset=t,e)};Ht.prototype.readInt=function(){return this._readTag(Fn.Integer)};Ht.prototype.readBoolean=function(){return this._readTag(Fn.Boolean)!==0};Ht.prototype.readEnumeration=function(){return this._readTag(Fn.Enumeration)};Ht.prototype.readString=function(r,e){r||(r=Fn.OctetString);var t=this.peek();if(t===null)return null;if(t!==r)throw dn("Expected 0x"+r.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null||this.length>this._size-n)return null;if(this._offset=n,this.length===0)return e?La.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,e?i:i.toString("utf8")};Ht.prototype.readOID=function(r){r||(r=Fn.OID);var e=this.readString(r,!0);if(e===null)return null;for(var t=[],n=0,i=0;i<e.length;i++){var s=e[i]&255;n<<=7,n+=s&127,s&128||(t.push(n),n=0)}return n=t.shift(),t.unshift(n%40),t.unshift(n/40>>0),t.join(".")};Ht.prototype._readTag=function(r){nd.ok(r!==void 0);var e=this.peek();if(e===null)return null;if(e!==r)throw dn("Expected 0x"+r.toString(16)+": got 0x"+e.toString(16));var t=this.readLength(this._offset+1);if(t===null)return null;if(this.length>4)throw dn("Integer too long: "+this.length);if(this.length>this._size-t)return null;this._offset=t;for(var n=this._buf[this._offset],i=0,s=0;s<this.length;s++)i<<=8,i|=this._buf[this._offset++]&255;return(n&128)===128&&s!==4&&(i-=1<<s*8),i>>0};Oa.exports=Ht});var Da=_e((cb,Pa)=>{var Sr=require("assert"),Oi=js().Buffer,Ir=Ti(),sd=Ni(),Ui=sd.newInvalidAsn1Error,od={size:1024,growthFactor:8};function fd(r,e){Sr.ok(r),Sr.equal(typeof r,"object"),Sr.ok(e),Sr.equal(typeof e,"object");var t=Object.getOwnPropertyNames(r);return t.forEach(function(n){if(!e[n]){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,i)}}),e}function Pt(r){r=fd(od,r||{}),this._buf=Oi.alloc(r.size||1024),this._size=this._buf.length,this._offset=0,this._options=r,this._seq=[]}Object.defineProperty(Pt.prototype,"buffer",{get:function(){if(this._seq.length)throw Ui(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Pt.prototype.writeByte=function(r){if(typeof r!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=r};Pt.prototype.writeInt=function(r,e){if(typeof r!="number")throw new TypeError("argument must be a Number");typeof e!="number"&&(e=Ir.Integer);for(var t=4;(!(r&4286578688)||(r&4286578688)===-8388608)&&t>1;)t--,r<<=8;if(t>4)throw Ui("BER ints cannot be > 0xffffffff");for(this._ensure(2+t),this._buf[this._offset++]=e,this._buf[this._offset++]=t;t-- >0;)this._buf[this._offset++]=(r&4278190080)>>>24,r<<=8};Pt.prototype.writeNull=function(){this.writeByte(Ir.Null),this.writeByte(0)};Pt.prototype.writeEnumeration=function(r,e){if(typeof r!="number")throw new TypeError("argument must be a Number");return typeof e!="number"&&(e=Ir.Enumeration),this.writeInt(r,e)};Pt.prototype.writeBoolean=function(r,e){if(typeof r!="boolean")throw new TypeError("argument must be a Boolean");typeof e!="number"&&(e=Ir.Boolean),this._ensure(3),this._buf[this._offset++]=e,this._buf[this._offset++]=1,this._buf[this._offset++]=r?255:0};Pt.prototype.writeString=function(r,e){if(typeof r!="string")throw new TypeError("argument must be a string (was: "+typeof r+")");typeof e!="number"&&(e=Ir.OctetString);var t=Oi.byteLength(r);this.writeByte(e),this.writeLength(t),t&&(this._ensure(t),this._buf.write(r,this._offset),this._offset+=t)};Pt.prototype.writeBuffer=function(r,e){if(typeof e!="number")throw new TypeError("tag must be a number");if(!Oi.isBuffer(r))throw new TypeError("argument must be a buffer");this.writeByte(e),this.writeLength(r.length),this._ensure(r.length),r.copy(this._buf,this._offset,0,r.length),this._offset+=r.length};Pt.prototype.writeStringArray=function(r){if(!r instanceof Array)throw new TypeError("argument must be an Array[String]");var e=this;r.forEach(function(t){e.writeString(t)})};Pt.prototype.writeOID=function(r,e){if(typeof r!="string")throw new TypeError("argument must be a string");if(typeof e!="number"&&(e=Ir.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(r))throw new Error("argument is not a valid OID string");function t(o,f){f<128?o.push(f):f<16384?(o.push(f>>>7|128),o.push(f&127)):f<2097152?(o.push(f>>>14|128),o.push((f>>>7|128)&255),o.push(f&127)):f<268435456?(o.push(f>>>21|128),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127)):(o.push((f>>>28|128)&255),o.push((f>>>21|128)&255),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127))}var n=r.split("."),i=[];i.push(parseInt(n[0],10)*40+parseInt(n[1],10)),n.slice(2).forEach(function(o){t(i,parseInt(o,10))});var s=this;this._ensure(2+i.length),this.writeByte(e),this.writeLength(i.length),i.forEach(function(o){s.writeByte(o)})};Pt.prototype.writeLength=function(r){if(typeof r!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),r<=127)this._buf[this._offset++]=r;else if(r<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=r;else if(r<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=r>>8,this._buf[this._offset++]=r;else if(r<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=r>>16,this._buf[this._offset++]=r>>8,this._buf[this._offset++]=r;else throw Ui("Length too long (> 4 bytes)")};Pt.prototype.startSequence=function(r){typeof r!="number"&&(r=Ir.Sequence|Ir.Constructor),this.writeByte(r),this._seq.push(this._offset),this._ensure(3),this._offset+=3};Pt.prototype.endSequence=function(){var r=this._seq.pop(),e=r+3,t=this._offset-e;if(t<=127)this._shift(e,t,-2),this._buf[r]=t;else if(t<=255)this._shift(e,t,-1),this._buf[r]=129,this._buf[r+1]=t;else if(t<=65535)this._buf[r]=130,this._buf[r+1]=t>>8,this._buf[r+2]=t;else if(t<=16777215)this._shift(e,t,1),this._buf[r]=131,this._buf[r+1]=t>>16,this._buf[r+2]=t>>8,this._buf[r+3]=t;else throw Ui("Sequence too long")};Pt.prototype._shift=function(r,e,t){Sr.ok(r!==void 0),Sr.ok(e!==void 0),Sr.ok(t),this._buf.copy(this._buf,r+t,r,r+e),this._offset+=t};Pt.prototype._ensure=function(r){if(Sr.ok(r),this._size-this._offset<r){var e=this._size*this._options.growthFactor;e-this._offset<r&&(e+=r);var t=Oi.alloc(e);this._buf.copy(t,0,0,this._offset),this._buf=t,this._size=e}};Pa.exports=Pt});var Ha=_e((ub,Hi)=>{var Xs=Ni(),Vs=Ti(),ad=Ua(),cd=Da();Hi.exports={Reader:ad,Writer:cd};for(Pi in Vs)Vs.hasOwnProperty(Pi)&&(Hi.exports[Pi]=Vs[Pi]);var Pi;for(Di in Xs)Xs.hasOwnProperty(Di)&&(Hi.exports[Di]=Xs[Di]);var Di});var qn=_e((hb,Qa)=>{var zs=Ha();Qa.exports={Ber:zs,BerReader:zs.Reader,BerWriter:zs.Writer}});var Ma=_e((lb,Qi)=>{(function(r){"use strict";var e=function(d){var _,A=new Float64Array(16);if(d)for(_=0;_<d.length;_++)A[_]=d[_];return A},t=function(){throw new Error("no PRNG")},n=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var s=e(),o=e([1]),f=e([56129,1]),a=e([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=e([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=e([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=e([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=e([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(d,_,A,u){d[_]=A>>24&255,d[_+1]=A>>16&255,d[_+2]=A>>8&255,d[_+3]=A&255,d[_+4]=u>>24&255,d[_+5]=u>>16&255,d[_+6]=u>>8&255,d[_+7]=u&255}function y(d,_,A,u,E){var C,v=0;for(C=0;C<E;C++)v|=d[_+C]^A[u+C];return(1&v-1>>>8)-1}function b(d,_,A,u){return y(d,_,A,u,16)}function x(d,_,A,u){return y(d,_,A,u,32)}function m(d,_,A,u){for(var E=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,C=A[0]&255|(A[1]&255)<<8|(A[2]&255)<<16|(A[3]&255)<<24,v=A[4]&255|(A[5]&255)<<8|(A[6]&255)<<16|(A[7]&255)<<24,Y=A[8]&255|(A[9]&255)<<8|(A[10]&255)<<16|(A[11]&255)<<24,re=A[12]&255|(A[13]&255)<<8|(A[14]&255)<<16|(A[15]&255)<<24,ue=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,fe=_[0]&255|(_[1]&255)<<8|(_[2]&255)<<16|(_[3]&255)<<24,ze=_[4]&255|(_[5]&255)<<8|(_[6]&255)<<16|(_[7]&255)<<24,ce=_[8]&255|(_[9]&255)<<8|(_[10]&255)<<16|(_[11]&255)<<24,ve=_[12]&255|(_[13]&255)<<8|(_[14]&255)<<16|(_[15]&255)<<24,Ne=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,Pe=A[16]&255|(A[17]&255)<<8|(A[18]&255)<<16|(A[19]&255)<<24,Ue=A[20]&255|(A[21]&255)<<8|(A[22]&255)<<16|(A[23]&255)<<24,Te=A[24]&255|(A[25]&255)<<8|(A[26]&255)<<16|(A[27]&255)<<24,Oe=A[28]&255|(A[29]&255)<<8|(A[30]&255)<<16|(A[31]&255)<<24,Le=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,he=E,Ee=C,ae=v,de=Y,Ae=re,oe=ue,U=fe,P=ze,V=ce,G=ve,j=Ne,Z=Pe,Se=Ue,De=Te,Qe=Oe,He=Le,w,Fe=0;Fe<20;Fe+=2)w=he+Se|0,Ae^=w<<7|w>>>32-7,w=Ae+he|0,V^=w<<9|w>>>32-9,w=V+Ae|0,Se^=w<<13|w>>>32-13,w=Se+V|0,he^=w<<18|w>>>32-18,w=oe+Ee|0,G^=w<<7|w>>>32-7,w=G+oe|0,De^=w<<9|w>>>32-9,w=De+G|0,Ee^=w<<13|w>>>32-13,w=Ee+De|0,oe^=w<<18|w>>>32-18,w=j+U|0,Qe^=w<<7|w>>>32-7,w=Qe+j|0,ae^=w<<9|w>>>32-9,w=ae+Qe|0,U^=w<<13|w>>>32-13,w=U+ae|0,j^=w<<18|w>>>32-18,w=He+Z|0,de^=w<<7|w>>>32-7,w=de+He|0,P^=w<<9|w>>>32-9,w=P+de|0,Z^=w<<13|w>>>32-13,w=Z+P|0,He^=w<<18|w>>>32-18,w=he+de|0,Ee^=w<<7|w>>>32-7,w=Ee+he|0,ae^=w<<9|w>>>32-9,w=ae+Ee|0,de^=w<<13|w>>>32-13,w=de+ae|0,he^=w<<18|w>>>32-18,w=oe+Ae|0,U^=w<<7|w>>>32-7,w=U+oe|0,P^=w<<9|w>>>32-9,w=P+U|0,Ae^=w<<13|w>>>32-13,w=Ae+P|0,oe^=w<<18|w>>>32-18,w=j+G|0,Z^=w<<7|w>>>32-7,w=Z+j|0,V^=w<<9|w>>>32-9,w=V+Z|0,G^=w<<13|w>>>32-13,w=G+V|0,j^=w<<18|w>>>32-18,w=He+Qe|0,Se^=w<<7|w>>>32-7,w=Se+He|0,De^=w<<9|w>>>32-9,w=De+Se|0,Qe^=w<<13|w>>>32-13,w=Qe+De|0,He^=w<<18|w>>>32-18;he=he+E|0,Ee=Ee+C|0,ae=ae+v|0,de=de+Y|0,Ae=Ae+re|0,oe=oe+ue|0,U=U+fe|0,P=P+ze|0,V=V+ce|0,G=G+ve|0,j=j+Ne|0,Z=Z+Pe|0,Se=Se+Ue|0,De=De+Te|0,Qe=Qe+Oe|0,He=He+Le|0,d[0]=he>>>0&255,d[1]=he>>>8&255,d[2]=he>>>16&255,d[3]=he>>>24&255,d[4]=Ee>>>0&255,d[5]=Ee>>>8&255,d[6]=Ee>>>16&255,d[7]=Ee>>>24&255,d[8]=ae>>>0&255,d[9]=ae>>>8&255,d[10]=ae>>>16&255,d[11]=ae>>>24&255,d[12]=de>>>0&255,d[13]=de>>>8&255,d[14]=de>>>16&255,d[15]=de>>>24&255,d[16]=Ae>>>0&255,d[17]=Ae>>>8&255,d[18]=Ae>>>16&255,d[19]=Ae>>>24&255,d[20]=oe>>>0&255,d[21]=oe>>>8&255,d[22]=oe>>>16&255,d[23]=oe>>>24&255,d[24]=U>>>0&255,d[25]=U>>>8&255,d[26]=U>>>16&255,d[27]=U>>>24&255,d[28]=P>>>0&255,d[29]=P>>>8&255,d[30]=P>>>16&255,d[31]=P>>>24&255,d[32]=V>>>0&255,d[33]=V>>>8&255,d[34]=V>>>16&255,d[35]=V>>>24&255,d[36]=G>>>0&255,d[37]=G>>>8&255,d[38]=G>>>16&255,d[39]=G>>>24&255,d[40]=j>>>0&255,d[41]=j>>>8&255,d[42]=j>>>16&255,d[43]=j>>>24&255,d[44]=Z>>>0&255,d[45]=Z>>>8&255,d[46]=Z>>>16&255,d[47]=Z>>>24&255,d[48]=Se>>>0&255,d[49]=Se>>>8&255,d[50]=Se>>>16&255,d[51]=Se>>>24&255,d[52]=De>>>0&255,d[53]=De>>>8&255,d[54]=De>>>16&255,d[55]=De>>>24&255,d[56]=Qe>>>0&255,d[57]=Qe>>>8&255,d[58]=Qe>>>16&255,d[59]=Qe>>>24&255,d[60]=He>>>0&255,d[61]=He>>>8&255,d[62]=He>>>16&255,d[63]=He>>>24&255}function L(d,_,A,u){for(var E=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,C=A[0]&255|(A[1]&255)<<8|(A[2]&255)<<16|(A[3]&255)<<24,v=A[4]&255|(A[5]&255)<<8|(A[6]&255)<<16|(A[7]&255)<<24,Y=A[8]&255|(A[9]&255)<<8|(A[10]&255)<<16|(A[11]&255)<<24,re=A[12]&255|(A[13]&255)<<8|(A[14]&255)<<16|(A[15]&255)<<24,ue=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,fe=_[0]&255|(_[1]&255)<<8|(_[2]&255)<<16|(_[3]&255)<<24,ze=_[4]&255|(_[5]&255)<<8|(_[6]&255)<<16|(_[7]&255)<<24,ce=_[8]&255|(_[9]&255)<<8|(_[10]&255)<<16|(_[11]&255)<<24,ve=_[12]&255|(_[13]&255)<<8|(_[14]&255)<<16|(_[15]&255)<<24,Ne=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,Pe=A[16]&255|(A[17]&255)<<8|(A[18]&255)<<16|(A[19]&255)<<24,Ue=A[20]&255|(A[21]&255)<<8|(A[22]&255)<<16|(A[23]&255)<<24,Te=A[24]&255|(A[25]&255)<<8|(A[26]&255)<<16|(A[27]&255)<<24,Oe=A[28]&255|(A[29]&255)<<8|(A[30]&255)<<16|(A[31]&255)<<24,Le=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,he=E,Ee=C,ae=v,de=Y,Ae=re,oe=ue,U=fe,P=ze,V=ce,G=ve,j=Ne,Z=Pe,Se=Ue,De=Te,Qe=Oe,He=Le,w,Fe=0;Fe<20;Fe+=2)w=he+Se|0,Ae^=w<<7|w>>>32-7,w=Ae+he|0,V^=w<<9|w>>>32-9,w=V+Ae|0,Se^=w<<13|w>>>32-13,w=Se+V|0,he^=w<<18|w>>>32-18,w=oe+Ee|0,G^=w<<7|w>>>32-7,w=G+oe|0,De^=w<<9|w>>>32-9,w=De+G|0,Ee^=w<<13|w>>>32-13,w=Ee+De|0,oe^=w<<18|w>>>32-18,w=j+U|0,Qe^=w<<7|w>>>32-7,w=Qe+j|0,ae^=w<<9|w>>>32-9,w=ae+Qe|0,U^=w<<13|w>>>32-13,w=U+ae|0,j^=w<<18|w>>>32-18,w=He+Z|0,de^=w<<7|w>>>32-7,w=de+He|0,P^=w<<9|w>>>32-9,w=P+de|0,Z^=w<<13|w>>>32-13,w=Z+P|0,He^=w<<18|w>>>32-18,w=he+de|0,Ee^=w<<7|w>>>32-7,w=Ee+he|0,ae^=w<<9|w>>>32-9,w=ae+Ee|0,de^=w<<13|w>>>32-13,w=de+ae|0,he^=w<<18|w>>>32-18,w=oe+Ae|0,U^=w<<7|w>>>32-7,w=U+oe|0,P^=w<<9|w>>>32-9,w=P+U|0,Ae^=w<<13|w>>>32-13,w=Ae+P|0,oe^=w<<18|w>>>32-18,w=j+G|0,Z^=w<<7|w>>>32-7,w=Z+j|0,V^=w<<9|w>>>32-9,w=V+Z|0,G^=w<<13|w>>>32-13,w=G+V|0,j^=w<<18|w>>>32-18,w=He+Qe|0,Se^=w<<7|w>>>32-7,w=Se+He|0,De^=w<<9|w>>>32-9,w=De+Se|0,Qe^=w<<13|w>>>32-13,w=Qe+De|0,He^=w<<18|w>>>32-18;d[0]=he>>>0&255,d[1]=he>>>8&255,d[2]=he>>>16&255,d[3]=he>>>24&255,d[4]=oe>>>0&255,d[5]=oe>>>8&255,d[6]=oe>>>16&255,d[7]=oe>>>24&255,d[8]=j>>>0&255,d[9]=j>>>8&255,d[10]=j>>>16&255,d[11]=j>>>24&255,d[12]=He>>>0&255,d[13]=He>>>8&255,d[14]=He>>>16&255,d[15]=He>>>24&255,d[16]=U>>>0&255,d[17]=U>>>8&255,d[18]=U>>>16&255,d[19]=U>>>24&255,d[20]=P>>>0&255,d[21]=P>>>8&255,d[22]=P>>>16&255,d[23]=P>>>24&255,d[24]=V>>>0&255,d[25]=V>>>8&255,d[26]=V>>>16&255,d[27]=V>>>24&255,d[28]=G>>>0&255,d[29]=G>>>8&255,d[30]=G>>>16&255,d[31]=G>>>24&255}function W(d,_,A,u){m(d,_,A,u)}function N(d,_,A,u){L(d,_,A,u)}var K=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function q(d,_,A,u,E,C,v){var Y=new Uint8Array(16),re=new Uint8Array(64),ue,fe;for(fe=0;fe<16;fe++)Y[fe]=0;for(fe=0;fe<8;fe++)Y[fe]=C[fe];for(;E>=64;){for(W(re,Y,v,K),fe=0;fe<64;fe++)d[_+fe]=A[u+fe]^re[fe];for(ue=1,fe=8;fe<16;fe++)ue=ue+(Y[fe]&255)|0,Y[fe]=ue&255,ue>>>=8;E-=64,_+=64,u+=64}if(E>0)for(W(re,Y,v,K),fe=0;fe<E;fe++)d[_+fe]=A[u+fe]^re[fe];return 0}function X(d,_,A,u,E){var C=new Uint8Array(16),v=new Uint8Array(64),Y,re;for(re=0;re<16;re++)C[re]=0;for(re=0;re<8;re++)C[re]=u[re];for(;A>=64;){for(W(v,C,E,K),re=0;re<64;re++)d[_+re]=v[re];for(Y=1,re=8;re<16;re++)Y=Y+(C[re]&255)|0,C[re]=Y&255,Y>>>=8;A-=64,_+=64}if(A>0)for(W(v,C,E,K),re=0;re<A;re++)d[_+re]=v[re];return 0}function S(d,_,A,u,E){var C=new Uint8Array(32);N(C,u,E,K);for(var v=new Uint8Array(8),Y=0;Y<8;Y++)v[Y]=u[Y+16];return X(d,_,A,v,C)}function I(d,_,A,u,E,C,v){var Y=new Uint8Array(32);N(Y,C,v,K);for(var re=new Uint8Array(8),ue=0;ue<8;ue++)re[ue]=C[ue+16];return q(d,_,A,u,E,re,Y)}var O=function(d){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var _,A,u,E,C,v,Y,re;_=d[0]&255|(d[1]&255)<<8,this.r[0]=_&8191,A=d[2]&255|(d[3]&255)<<8,this.r[1]=(_>>>13|A<<3)&8191,u=d[4]&255|(d[5]&255)<<8,this.r[2]=(A>>>10|u<<6)&7939,E=d[6]&255|(d[7]&255)<<8,this.r[3]=(u>>>7|E<<9)&8191,C=d[8]&255|(d[9]&255)<<8,this.r[4]=(E>>>4|C<<12)&255,this.r[5]=C>>>1&8190,v=d[10]&255|(d[11]&255)<<8,this.r[6]=(C>>>14|v<<2)&8191,Y=d[12]&255|(d[13]&255)<<8,this.r[7]=(v>>>11|Y<<5)&8065,re=d[14]&255|(d[15]&255)<<8,this.r[8]=(Y>>>8|re<<8)&8191,this.r[9]=re>>>5&127,this.pad[0]=d[16]&255|(d[17]&255)<<8,this.pad[1]=d[18]&255|(d[19]&255)<<8,this.pad[2]=d[20]&255|(d[21]&255)<<8,this.pad[3]=d[22]&255|(d[23]&255)<<8,this.pad[4]=d[24]&255|(d[25]&255)<<8,this.pad[5]=d[26]&255|(d[27]&255)<<8,this.pad[6]=d[28]&255|(d[29]&255)<<8,this.pad[7]=d[30]&255|(d[31]&255)<<8};O.prototype.blocks=function(d,_,A){for(var u=this.fin?0:2048,E,C,v,Y,re,ue,fe,ze,ce,ve,Ne,Pe,Ue,Te,Oe,Le,he,Ee,ae,de=this.h[0],Ae=this.h[1],oe=this.h[2],U=this.h[3],P=this.h[4],V=this.h[5],G=this.h[6],j=this.h[7],Z=this.h[8],Se=this.h[9],De=this.r[0],Qe=this.r[1],He=this.r[2],w=this.r[3],Fe=this.r[4],Je=this.r[5],Ze=this.r[6],Me=this.r[7],je=this.r[8],Xe=this.r[9];A>=16;)E=d[_+0]&255|(d[_+1]&255)<<8,de+=E&8191,C=d[_+2]&255|(d[_+3]&255)<<8,Ae+=(E>>>13|C<<3)&8191,v=d[_+4]&255|(d[_+5]&255)<<8,oe+=(C>>>10|v<<6)&8191,Y=d[_+6]&255|(d[_+7]&255)<<8,U+=(v>>>7|Y<<9)&8191,re=d[_+8]&255|(d[_+9]&255)<<8,P+=(Y>>>4|re<<12)&8191,V+=re>>>1&8191,ue=d[_+10]&255|(d[_+11]&255)<<8,G+=(re>>>14|ue<<2)&8191,fe=d[_+12]&255|(d[_+13]&255)<<8,j+=(ue>>>11|fe<<5)&8191,ze=d[_+14]&255|(d[_+15]&255)<<8,Z+=(fe>>>8|ze<<8)&8191,Se+=ze>>>5|u,ce=0,ve=ce,ve+=de*De,ve+=Ae*(5*Xe),ve+=oe*(5*je),ve+=U*(5*Me),ve+=P*(5*Ze),ce=ve>>>13,ve&=8191,ve+=V*(5*Je),ve+=G*(5*Fe),ve+=j*(5*w),ve+=Z*(5*He),ve+=Se*(5*Qe),ce+=ve>>>13,ve&=8191,Ne=ce,Ne+=de*Qe,Ne+=Ae*De,Ne+=oe*(5*Xe),Ne+=U*(5*je),Ne+=P*(5*Me),ce=Ne>>>13,Ne&=8191,Ne+=V*(5*Ze),Ne+=G*(5*Je),Ne+=j*(5*Fe),Ne+=Z*(5*w),Ne+=Se*(5*He),ce+=Ne>>>13,Ne&=8191,Pe=ce,Pe+=de*He,Pe+=Ae*Qe,Pe+=oe*De,Pe+=U*(5*Xe),Pe+=P*(5*je),ce=Pe>>>13,Pe&=8191,Pe+=V*(5*Me),Pe+=G*(5*Ze),Pe+=j*(5*Je),Pe+=Z*(5*Fe),Pe+=Se*(5*w),ce+=Pe>>>13,Pe&=8191,Ue=ce,Ue+=de*w,Ue+=Ae*He,Ue+=oe*Qe,Ue+=U*De,Ue+=P*(5*Xe),ce=Ue>>>13,Ue&=8191,Ue+=V*(5*je),Ue+=G*(5*Me),Ue+=j*(5*Ze),Ue+=Z*(5*Je),Ue+=Se*(5*Fe),ce+=Ue>>>13,Ue&=8191,Te=ce,Te+=de*Fe,Te+=Ae*w,Te+=oe*He,Te+=U*Qe,Te+=P*De,ce=Te>>>13,Te&=8191,Te+=V*(5*Xe),Te+=G*(5*je),Te+=j*(5*Me),Te+=Z*(5*Ze),Te+=Se*(5*Je),ce+=Te>>>13,Te&=8191,Oe=ce,Oe+=de*Je,Oe+=Ae*Fe,Oe+=oe*w,Oe+=U*He,Oe+=P*Qe,ce=Oe>>>13,Oe&=8191,Oe+=V*De,Oe+=G*(5*Xe),Oe+=j*(5*je),Oe+=Z*(5*Me),Oe+=Se*(5*Ze),ce+=Oe>>>13,Oe&=8191,Le=ce,Le+=de*Ze,Le+=Ae*Je,Le+=oe*Fe,Le+=U*w,Le+=P*He,ce=Le>>>13,Le&=8191,Le+=V*Qe,Le+=G*De,Le+=j*(5*Xe),Le+=Z*(5*je),Le+=Se*(5*Me),ce+=Le>>>13,Le&=8191,he=ce,he+=de*Me,he+=Ae*Ze,he+=oe*Je,he+=U*Fe,he+=P*w,ce=he>>>13,he&=8191,he+=V*He,he+=G*Qe,he+=j*De,he+=Z*(5*Xe),he+=Se*(5*je),ce+=he>>>13,he&=8191,Ee=ce,Ee+=de*je,Ee+=Ae*Me,Ee+=oe*Ze,Ee+=U*Je,Ee+=P*Fe,ce=Ee>>>13,Ee&=8191,Ee+=V*w,Ee+=G*He,Ee+=j*Qe,Ee+=Z*De,Ee+=Se*(5*Xe),ce+=Ee>>>13,Ee&=8191,ae=ce,ae+=de*Xe,ae+=Ae*je,ae+=oe*Me,ae+=U*Ze,ae+=P*Je,ce=ae>>>13,ae&=8191,ae+=V*Fe,ae+=G*w,ae+=j*He,ae+=Z*Qe,ae+=Se*De,ce+=ae>>>13,ae&=8191,ce=(ce<<2)+ce|0,ce=ce+ve|0,ve=ce&8191,ce=ce>>>13,Ne+=ce,de=ve,Ae=Ne,oe=Pe,U=Ue,P=Te,V=Oe,G=Le,j=he,Z=Ee,Se=ae,_+=16,A-=16;this.h[0]=de,this.h[1]=Ae,this.h[2]=oe,this.h[3]=U,this.h[4]=P,this.h[5]=V,this.h[6]=G,this.h[7]=j,this.h[8]=Z,this.h[9]=Se},O.prototype.finish=function(d,_){var A=new Uint16Array(10),u,E,C,v;if(this.leftover){for(v=this.leftover,this.buffer[v++]=1;v<16;v++)this.buffer[v]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(u=this.h[1]>>>13,this.h[1]&=8191,v=2;v<10;v++)this.h[v]+=u,u=this.h[v]>>>13,this.h[v]&=8191;for(this.h[0]+=u*5,u=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=u,u=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=u,A[0]=this.h[0]+5,u=A[0]>>>13,A[0]&=8191,v=1;v<10;v++)A[v]=this.h[v]+u,u=A[v]>>>13,A[v]&=8191;for(A[9]-=8192,E=(u^1)-1,v=0;v<10;v++)A[v]&=E;for(E=~E,v=0;v<10;v++)this.h[v]=this.h[v]&E|A[v];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,C=this.h[0]+this.pad[0],this.h[0]=C&65535,v=1;v<8;v++)C=(this.h[v]+this.pad[v]|0)+(C>>>16)|0,this.h[v]=C&65535;d[_+0]=this.h[0]>>>0&255,d[_+1]=this.h[0]>>>8&255,d[_+2]=this.h[1]>>>0&255,d[_+3]=this.h[1]>>>8&255,d[_+4]=this.h[2]>>>0&255,d[_+5]=this.h[2]>>>8&255,d[_+6]=this.h[3]>>>0&255,d[_+7]=this.h[3]>>>8&255,d[_+8]=this.h[4]>>>0&255,d[_+9]=this.h[4]>>>8&255,d[_+10]=this.h[5]>>>0&255,d[_+11]=this.h[5]>>>8&255,d[_+12]=this.h[6]>>>0&255,d[_+13]=this.h[6]>>>8&255,d[_+14]=this.h[7]>>>0&255,d[_+15]=this.h[7]>>>8&255},O.prototype.update=function(d,_,A){var u,E;if(this.leftover){for(E=16-this.leftover,E>A&&(E=A),u=0;u<E;u++)this.buffer[this.leftover+u]=d[_+u];if(A-=E,_+=E,this.leftover+=E,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(A>=16&&(E=A-A%16,this.blocks(d,_,E),_+=E,A-=E),A){for(u=0;u<A;u++)this.buffer[this.leftover+u]=d[_+u];this.leftover+=A}};function F(d,_,A,u,E,C){var v=new O(C);return v.update(A,u,E),v.finish(d,_),0}function H(d,_,A,u,E,C){var v=new Uint8Array(16);return F(v,0,A,u,E,C),b(d,_,v,0)}function ne(d,_,A,u,E){var C;if(A<32)return-1;for(I(d,0,_,0,A,u,E),F(d,16,d,32,A-32,d),C=0;C<16;C++)d[C]=0;return 0}function ee(d,_,A,u,E){var C,v=new Uint8Array(32);if(A<32||(S(v,0,32,u,E),H(_,16,_,32,A-32,v)!==0))return-1;for(I(d,0,_,0,A,u,E),C=0;C<32;C++)d[C]=0;return 0}function J(d,_){var A;for(A=0;A<16;A++)d[A]=_[A]|0}function te(d){var _,A,u=1;for(_=0;_<16;_++)A=d[_]+u+65535,u=Math.floor(A/65536),d[_]=A-u*65536;d[0]+=u-1+37*(u-1)}function ie(d,_,A){for(var u,E=~(A-1),C=0;C<16;C++)u=E&(d[C]^_[C]),d[C]^=u,_[C]^=u}function T(d,_){var A,u,E,C=e(),v=e();for(A=0;A<16;A++)v[A]=_[A];for(te(v),te(v),te(v),u=0;u<2;u++){for(C[0]=v[0]-65517,A=1;A<15;A++)C[A]=v[A]-65535-(C[A-1]>>16&1),C[A-1]&=65535;C[15]=v[15]-32767-(C[14]>>16&1),E=C[15]>>16&1,C[14]&=65535,ie(v,C,1-E)}for(A=0;A<16;A++)d[2*A]=v[A]&255,d[2*A+1]=v[A]>>8}function M(d,_){var A=new Uint8Array(32),u=new Uint8Array(32);return T(A,d),T(u,_),x(A,0,u,0)}function Q(d){var _=new Uint8Array(32);return T(_,d),_[0]&1}function z(d,_){var A;for(A=0;A<16;A++)d[A]=_[2*A]+(_[2*A+1]<<8);d[15]&=32767}function le(d,_,A){for(var u=0;u<16;u++)d[u]=_[u]+A[u]}function pe(d,_,A){for(var u=0;u<16;u++)d[u]=_[u]-A[u]}function ge(d,_,A){var u,E,C=0,v=0,Y=0,re=0,ue=0,fe=0,ze=0,ce=0,ve=0,Ne=0,Pe=0,Ue=0,Te=0,Oe=0,Le=0,he=0,Ee=0,ae=0,de=0,Ae=0,oe=0,U=0,P=0,V=0,G=0,j=0,Z=0,Se=0,De=0,Qe=0,He=0,w=A[0],Fe=A[1],Je=A[2],Ze=A[3],Me=A[4],je=A[5],Xe=A[6],xt=A[7],nt=A[8],Et=A[9],bt=A[10],yt=A[11],Bt=A[12],Lt=A[13],Ot=A[14],Ut=A[15];u=_[0],C+=u*w,v+=u*Fe,Y+=u*Je,re+=u*Ze,ue+=u*Me,fe+=u*je,ze+=u*Xe,ce+=u*xt,ve+=u*nt,Ne+=u*Et,Pe+=u*bt,Ue+=u*yt,Te+=u*Bt,Oe+=u*Lt,Le+=u*Ot,he+=u*Ut,u=_[1],v+=u*w,Y+=u*Fe,re+=u*Je,ue+=u*Ze,fe+=u*Me,ze+=u*je,ce+=u*Xe,ve+=u*xt,Ne+=u*nt,Pe+=u*Et,Ue+=u*bt,Te+=u*yt,Oe+=u*Bt,Le+=u*Lt,he+=u*Ot,Ee+=u*Ut,u=_[2],Y+=u*w,re+=u*Fe,ue+=u*Je,fe+=u*Ze,ze+=u*Me,ce+=u*je,ve+=u*Xe,Ne+=u*xt,Pe+=u*nt,Ue+=u*Et,Te+=u*bt,Oe+=u*yt,Le+=u*Bt,he+=u*Lt,Ee+=u*Ot,ae+=u*Ut,u=_[3],re+=u*w,ue+=u*Fe,fe+=u*Je,ze+=u*Ze,ce+=u*Me,ve+=u*je,Ne+=u*Xe,Pe+=u*xt,Ue+=u*nt,Te+=u*Et,Oe+=u*bt,Le+=u*yt,he+=u*Bt,Ee+=u*Lt,ae+=u*Ot,de+=u*Ut,u=_[4],ue+=u*w,fe+=u*Fe,ze+=u*Je,ce+=u*Ze,ve+=u*Me,Ne+=u*je,Pe+=u*Xe,Ue+=u*xt,Te+=u*nt,Oe+=u*Et,Le+=u*bt,he+=u*yt,Ee+=u*Bt,ae+=u*Lt,de+=u*Ot,Ae+=u*Ut,u=_[5],fe+=u*w,ze+=u*Fe,ce+=u*Je,ve+=u*Ze,Ne+=u*Me,Pe+=u*je,Ue+=u*Xe,Te+=u*xt,Oe+=u*nt,Le+=u*Et,he+=u*bt,Ee+=u*yt,ae+=u*Bt,de+=u*Lt,Ae+=u*Ot,oe+=u*Ut,u=_[6],ze+=u*w,ce+=u*Fe,ve+=u*Je,Ne+=u*Ze,Pe+=u*Me,Ue+=u*je,Te+=u*Xe,Oe+=u*xt,Le+=u*nt,he+=u*Et,Ee+=u*bt,ae+=u*yt,de+=u*Bt,Ae+=u*Lt,oe+=u*Ot,U+=u*Ut,u=_[7],ce+=u*w,ve+=u*Fe,Ne+=u*Je,Pe+=u*Ze,Ue+=u*Me,Te+=u*je,Oe+=u*Xe,Le+=u*xt,he+=u*nt,Ee+=u*Et,ae+=u*bt,de+=u*yt,Ae+=u*Bt,oe+=u*Lt,U+=u*Ot,P+=u*Ut,u=_[8],ve+=u*w,Ne+=u*Fe,Pe+=u*Je,Ue+=u*Ze,Te+=u*Me,Oe+=u*je,Le+=u*Xe,he+=u*xt,Ee+=u*nt,ae+=u*Et,de+=u*bt,Ae+=u*yt,oe+=u*Bt,U+=u*Lt,P+=u*Ot,V+=u*Ut,u=_[9],Ne+=u*w,Pe+=u*Fe,Ue+=u*Je,Te+=u*Ze,Oe+=u*Me,Le+=u*je,he+=u*Xe,Ee+=u*xt,ae+=u*nt,de+=u*Et,Ae+=u*bt,oe+=u*yt,U+=u*Bt,P+=u*Lt,V+=u*Ot,G+=u*Ut,u=_[10],Pe+=u*w,Ue+=u*Fe,Te+=u*Je,Oe+=u*Ze,Le+=u*Me,he+=u*je,Ee+=u*Xe,ae+=u*xt,de+=u*nt,Ae+=u*Et,oe+=u*bt,U+=u*yt,P+=u*Bt,V+=u*Lt,G+=u*Ot,j+=u*Ut,u=_[11],Ue+=u*w,Te+=u*Fe,Oe+=u*Je,Le+=u*Ze,he+=u*Me,Ee+=u*je,ae+=u*Xe,de+=u*xt,Ae+=u*nt,oe+=u*Et,U+=u*bt,P+=u*yt,V+=u*Bt,G+=u*Lt,j+=u*Ot,Z+=u*Ut,u=_[12],Te+=u*w,Oe+=u*Fe,Le+=u*Je,he+=u*Ze,Ee+=u*Me,ae+=u*je,de+=u*Xe,Ae+=u*xt,oe+=u*nt,U+=u*Et,P+=u*bt,V+=u*yt,G+=u*Bt,j+=u*Lt,Z+=u*Ot,Se+=u*Ut,u=_[13],Oe+=u*w,Le+=u*Fe,he+=u*Je,Ee+=u*Ze,ae+=u*Me,de+=u*je,Ae+=u*Xe,oe+=u*xt,U+=u*nt,P+=u*Et,V+=u*bt,G+=u*yt,j+=u*Bt,Z+=u*Lt,Se+=u*Ot,De+=u*Ut,u=_[14],Le+=u*w,he+=u*Fe,Ee+=u*Je,ae+=u*Ze,de+=u*Me,Ae+=u*je,oe+=u*Xe,U+=u*xt,P+=u*nt,V+=u*Et,G+=u*bt,j+=u*yt,Z+=u*Bt,Se+=u*Lt,De+=u*Ot,Qe+=u*Ut,u=_[15],he+=u*w,Ee+=u*Fe,ae+=u*Je,de+=u*Ze,Ae+=u*Me,oe+=u*je,U+=u*Xe,P+=u*xt,V+=u*nt,G+=u*Et,j+=u*bt,Z+=u*yt,Se+=u*Bt,De+=u*Lt,Qe+=u*Ot,He+=u*Ut,C+=38*Ee,v+=38*ae,Y+=38*de,re+=38*Ae,ue+=38*oe,fe+=38*U,ze+=38*P,ce+=38*V,ve+=38*G,Ne+=38*j,Pe+=38*Z,Ue+=38*Se,Te+=38*De,Oe+=38*Qe,Le+=38*He,E=1,u=C+E+65535,E=Math.floor(u/65536),C=u-E*65536,u=v+E+65535,E=Math.floor(u/65536),v=u-E*65536,u=Y+E+65535,E=Math.floor(u/65536),Y=u-E*65536,u=re+E+65535,E=Math.floor(u/65536),re=u-E*65536,u=ue+E+65535,E=Math.floor(u/65536),ue=u-E*65536,u=fe+E+65535,E=Math.floor(u/65536),fe=u-E*65536,u=ze+E+65535,E=Math.floor(u/65536),ze=u-E*65536,u=ce+E+65535,E=Math.floor(u/65536),ce=u-E*65536,u=ve+E+65535,E=Math.floor(u/65536),ve=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=Ue+E+65535,E=Math.floor(u/65536),Ue=u-E*65536,u=Te+E+65535,E=Math.floor(u/65536),Te=u-E*65536,u=Oe+E+65535,E=Math.floor(u/65536),Oe=u-E*65536,u=Le+E+65535,E=Math.floor(u/65536),Le=u-E*65536,u=he+E+65535,E=Math.floor(u/65536),he=u-E*65536,C+=E-1+37*(E-1),E=1,u=C+E+65535,E=Math.floor(u/65536),C=u-E*65536,u=v+E+65535,E=Math.floor(u/65536),v=u-E*65536,u=Y+E+65535,E=Math.floor(u/65536),Y=u-E*65536,u=re+E+65535,E=Math.floor(u/65536),re=u-E*65536,u=ue+E+65535,E=Math.floor(u/65536),ue=u-E*65536,u=fe+E+65535,E=Math.floor(u/65536),fe=u-E*65536,u=ze+E+65535,E=Math.floor(u/65536),ze=u-E*65536,u=ce+E+65535,E=Math.floor(u/65536),ce=u-E*65536,u=ve+E+65535,E=Math.floor(u/65536),ve=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=Ue+E+65535,E=Math.floor(u/65536),Ue=u-E*65536,u=Te+E+65535,E=Math.floor(u/65536),Te=u-E*65536,u=Oe+E+65535,E=Math.floor(u/65536),Oe=u-E*65536,u=Le+E+65535,E=Math.floor(u/65536),Le=u-E*65536,u=he+E+65535,E=Math.floor(u/65536),he=u-E*65536,C+=E-1+37*(E-1),d[0]=C,d[1]=v,d[2]=Y,d[3]=re,d[4]=ue,d[5]=fe,d[6]=ze,d[7]=ce,d[8]=ve,d[9]=Ne,d[10]=Pe,d[11]=Ue,d[12]=Te,d[13]=Oe,d[14]=Le,d[15]=he}function at(d,_){ge(d,_,_)}function Tt(d,_){var A=e(),u;for(u=0;u<16;u++)A[u]=_[u];for(u=253;u>=0;u--)at(A,A),u!==2&&u!==4&&ge(A,A,_);for(u=0;u<16;u++)d[u]=A[u]}function Un(d,_){var A=e(),u;for(u=0;u<16;u++)A[u]=_[u];for(u=250;u>=0;u--)at(A,A),u!==1&&ge(A,A,_);for(u=0;u<16;u++)d[u]=A[u]}function rn(d,_,A){var u=new Uint8Array(32),E=new Float64Array(80),C,v,Y=e(),re=e(),ue=e(),fe=e(),ze=e(),ce=e();for(v=0;v<31;v++)u[v]=_[v];for(u[31]=_[31]&127|64,u[0]&=248,z(E,A),v=0;v<16;v++)re[v]=E[v],fe[v]=Y[v]=ue[v]=0;for(Y[0]=fe[0]=1,v=254;v>=0;--v)C=u[v>>>3]>>>(v&7)&1,ie(Y,re,C),ie(ue,fe,C),le(ze,Y,ue),pe(Y,Y,ue),le(ue,re,fe),pe(re,re,fe),at(fe,ze),at(ce,Y),ge(Y,ue,Y),ge(ue,re,ze),le(ze,Y,ue),pe(Y,Y,ue),at(re,Y),pe(ue,fe,ce),ge(Y,ue,f),le(Y,Y,fe),ge(ue,ue,Y),ge(Y,fe,ce),ge(fe,re,E),at(re,ze),ie(Y,re,C),ie(ue,fe,C);for(v=0;v<16;v++)E[v+16]=Y[v],E[v+32]=ue[v],E[v+48]=re[v],E[v+64]=fe[v];var ve=E.subarray(32),Ne=E.subarray(16);return Tt(ve,ve),ge(Ne,Ne,ve),T(d,Ne),0}function nn(d,_){return rn(d,_,i)}function dr(d,_){return t(_,32),nn(d,_)}function sn(d,_,A){var u=new Uint8Array(32);return rn(u,A,_),N(d,n,u,K)}var Pn=ne,ki=ee;function Dn(d,_,A,u,E,C){var v=new Uint8Array(32);return sn(v,E,C),Pn(d,_,A,u,v)}function on(d,_,A,u,E,C){var v=new Uint8Array(32);return sn(v,E,C),ki(d,_,A,u,v)}var fn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function $(d,_,A,u){for(var E=new Int32Array(16),C=new Int32Array(16),v,Y,re,ue,fe,ze,ce,ve,Ne,Pe,Ue,Te,Oe,Le,he,Ee,ae,de,Ae,oe,U,P,V,G,j,Z,Se=d[0],De=d[1],Qe=d[2],He=d[3],w=d[4],Fe=d[5],Je=d[6],Ze=d[7],Me=_[0],je=_[1],Xe=_[2],xt=_[3],nt=_[4],Et=_[5],bt=_[6],yt=_[7],Bt=0;u>=128;){for(Ae=0;Ae<16;Ae++)oe=8*Ae+Bt,E[Ae]=A[oe+0]<<24|A[oe+1]<<16|A[oe+2]<<8|A[oe+3],C[Ae]=A[oe+4]<<24|A[oe+5]<<16|A[oe+6]<<8|A[oe+7];for(Ae=0;Ae<80;Ae++)if(v=Se,Y=De,re=Qe,ue=He,fe=w,ze=Fe,ce=Je,ve=Ze,Ne=Me,Pe=je,Ue=Xe,Te=xt,Oe=nt,Le=Et,he=bt,Ee=yt,U=Ze,P=yt,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=(w>>>14|nt<<32-14)^(w>>>18|nt<<32-18)^(nt>>>41-32|w<<32-(41-32)),P=(nt>>>14|w<<32-14)^(nt>>>18|w<<32-18)^(w>>>41-32|nt<<32-(41-32)),V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,U=w&Fe^~w&Je,P=nt&Et^~nt&bt,V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,U=fn[Ae*2],P=fn[Ae*2+1],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,U=E[Ae%16],P=C[Ae%16],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,ae=j&65535|Z<<16,de=V&65535|G<<16,U=ae,P=de,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=(Se>>>28|Me<<32-28)^(Me>>>34-32|Se<<32-(34-32))^(Me>>>39-32|Se<<32-(39-32)),P=(Me>>>28|Se<<32-28)^(Se>>>34-32|Me<<32-(34-32))^(Se>>>39-32|Me<<32-(39-32)),V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,U=Se&De^Se&Qe^De&Qe,P=Me&je^Me&Xe^je&Xe,V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,ve=j&65535|Z<<16,Ee=V&65535|G<<16,U=ue,P=Te,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=ae,P=de,V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,ue=j&65535|Z<<16,Te=V&65535|G<<16,De=v,Qe=Y,He=re,w=ue,Fe=fe,Je=ze,Ze=ce,Se=ve,je=Ne,Xe=Pe,xt=Ue,nt=Te,Et=Oe,bt=Le,yt=he,Me=Ee,Ae%16===15)for(oe=0;oe<16;oe++)U=E[oe],P=C[oe],V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=E[(oe+9)%16],P=C[(oe+9)%16],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,ae=E[(oe+1)%16],de=C[(oe+1)%16],U=(ae>>>1|de<<32-1)^(ae>>>8|de<<32-8)^ae>>>7,P=(de>>>1|ae<<32-1)^(de>>>8|ae<<32-8)^(de>>>7|ae<<32-7),V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,ae=E[(oe+14)%16],de=C[(oe+14)%16],U=(ae>>>19|de<<32-19)^(de>>>61-32|ae<<32-(61-32))^ae>>>6,P=(de>>>19|ae<<32-19)^(ae>>>61-32|de<<32-(61-32))^(de>>>6|ae<<32-6),V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,E[oe]=j&65535|Z<<16,C[oe]=V&65535|G<<16;U=Se,P=Me,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[0],P=_[0],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[0]=Se=j&65535|Z<<16,_[0]=Me=V&65535|G<<16,U=De,P=je,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[1],P=_[1],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[1]=De=j&65535|Z<<16,_[1]=je=V&65535|G<<16,U=Qe,P=Xe,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[2],P=_[2],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[2]=Qe=j&65535|Z<<16,_[2]=Xe=V&65535|G<<16,U=He,P=xt,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[3],P=_[3],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[3]=He=j&65535|Z<<16,_[3]=xt=V&65535|G<<16,U=w,P=nt,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[4],P=_[4],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[4]=w=j&65535|Z<<16,_[4]=nt=V&65535|G<<16,U=Fe,P=Et,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[5],P=_[5],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[5]=Fe=j&65535|Z<<16,_[5]=Et=V&65535|G<<16,U=Je,P=bt,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[6],P=_[6],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[6]=Je=j&65535|Z<<16,_[6]=bt=V&65535|G<<16,U=Ze,P=yt,V=P&65535,G=P>>>16,j=U&65535,Z=U>>>16,U=d[7],P=_[7],V+=P&65535,G+=P>>>16,j+=U&65535,Z+=U>>>16,G+=V>>>16,j+=G>>>16,Z+=j>>>16,d[7]=Ze=j&65535|Z<<16,_[7]=yt=V&65535|G<<16,Bt+=128,u-=128}return u}function se(d,_,A){var u=new Int32Array(8),E=new Int32Array(8),C=new Uint8Array(256),v,Y=A;for(u[0]=1779033703,u[1]=3144134277,u[2]=1013904242,u[3]=2773480762,u[4]=1359893119,u[5]=2600822924,u[6]=528734635,u[7]=1541459225,E[0]=4089235720,E[1]=2227873595,E[2]=4271175723,E[3]=1595750129,E[4]=2917565137,E[5]=725511199,E[6]=4215389547,E[7]=327033209,$(u,E,_,A),A%=128,v=0;v<A;v++)C[v]=_[Y-A+v];for(C[A]=128,A=256-128*(A<112?1:0),C[A-9]=0,p(C,A-8,Y/536870912|0,Y<<3),$(u,E,C,A),v=0;v<8;v++)p(d,8*v,u[v],E[v]);return 0}function be(d,_){var A=e(),u=e(),E=e(),C=e(),v=e(),Y=e(),re=e(),ue=e(),fe=e();pe(A,d[1],d[0]),pe(fe,_[1],_[0]),ge(A,A,fe),le(u,d[0],d[1]),le(fe,_[0],_[1]),ge(u,u,fe),ge(E,d[3],_[3]),ge(E,E,c),ge(C,d[2],_[2]),le(C,C,C),pe(v,u,A),pe(Y,C,E),le(re,C,E),le(ue,u,A),ge(d[0],v,Y),ge(d[1],ue,re),ge(d[2],re,Y),ge(d[3],v,ue)}function Re(d,_,A){var u;for(u=0;u<4;u++)ie(d[u],_[u],A)}function Ge(d,_){var A=e(),u=e(),E=e();Tt(E,_[2]),ge(A,_[0],E),ge(u,_[1],E),T(d,u),d[31]^=Q(A)<<7}function St(d,_,A){var u,E;for(J(d[0],s),J(d[1],o),J(d[2],o),J(d[3],s),E=255;E>=0;--E)u=A[E/8|0]>>(E&7)&1,Re(d,_,u),be(_,d),be(d,d),Re(d,_,u)}function fr(d,_){var A=[e(),e(),e(),e()];J(A[0],h),J(A[1],l),J(A[2],o),ge(A[3],h,l),St(d,A,_)}function Kt(d,_,A){var u=new Uint8Array(64),E=[e(),e(),e(),e()],C;for(A||t(_,32),se(u,_,32),u[0]&=248,u[31]&=127,u[31]|=64,fr(E,u),Ge(d,E),C=0;C<32;C++)_[C+32]=d[C];return 0}var an=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function rt(d,_){var A,u,E,C;for(u=63;u>=32;--u){for(A=0,E=u-32,C=u-12;E<C;++E)_[E]+=A-16*_[u]*an[E-(u-32)],A=_[E]+128>>8,_[E]-=A*256;_[E]+=A,_[u]=0}for(A=0,E=0;E<32;E++)_[E]+=A-(_[31]>>4)*an[E],A=_[E]>>8,_[E]&=255;for(E=0;E<32;E++)_[E]-=A*an[E];for(u=0;u<32;u++)_[u+1]+=_[u]>>8,d[u]=_[u]&255}function Ct(d){var _=new Float64Array(64),A;for(A=0;A<64;A++)_[A]=d[A];for(A=0;A<64;A++)d[A]=0;rt(d,_)}function mt(d,_,A,u){var E=new Uint8Array(64),C=new Uint8Array(64),v=new Uint8Array(64),Y,re,ue=new Float64Array(64),fe=[e(),e(),e(),e()];se(E,u,32),E[0]&=248,E[31]&=127,E[31]|=64;var ze=A+64;for(Y=0;Y<A;Y++)d[64+Y]=_[Y];for(Y=0;Y<32;Y++)d[32+Y]=E[32+Y];for(se(v,d.subarray(32),A+32),Ct(v),fr(fe,v),Ge(d,fe),Y=32;Y<64;Y++)d[Y]=u[Y];for(se(C,d,A+64),Ct(C),Y=0;Y<64;Y++)ue[Y]=0;for(Y=0;Y<32;Y++)ue[Y]=v[Y];for(Y=0;Y<32;Y++)for(re=0;re<32;re++)ue[Y+re]+=C[Y]*E[re];return rt(d.subarray(32),ue),ze}function _t(d,_){var A=e(),u=e(),E=e(),C=e(),v=e(),Y=e(),re=e();return J(d[2],o),z(d[1],_),at(E,d[1]),ge(C,E,a),pe(E,E,d[2]),le(C,d[2],C),at(v,C),at(Y,v),ge(re,Y,v),ge(A,re,E),ge(A,A,C),Un(A,A),ge(A,A,E),ge(A,A,C),ge(A,A,C),ge(d[0],A,C),at(u,d[0]),ge(u,u,C),M(u,E)&&ge(d[0],d[0],g),at(u,d[0]),ge(u,u,C),M(u,E)?-1:(Q(d[0])===_[31]>>7&&pe(d[0],s,d[0]),ge(d[3],d[0],d[1]),0)}function ot(d,_,A,u){var E,C,v=new Uint8Array(32),Y=new Uint8Array(64),re=[e(),e(),e(),e()],ue=[e(),e(),e(),e()];if(C=-1,A<64||_t(ue,u))return-1;for(E=0;E<A;E++)d[E]=_[E];for(E=0;E<32;E++)d[E+32]=u[E];if(se(Y,d,A),Ct(Y),St(re,ue,Y),fr(ue,_.subarray(32)),be(re,ue),Ge(v,re),A-=64,x(_,0,v,0)){for(E=0;E<A;E++)d[E]=0;return-1}for(E=0;E<A;E++)d[E]=_[E+64];return C=A,C}var jt=32,pt=24,Mr=32,cn=16,Hn=32,vi=32,Qn=32,Mn=32,$s=32,ma=pt,jl=Mr,Xl=cn,gr=64,Fr=32,un=64,Gs=32,Ys=64;r.lowlevel={crypto_core_hsalsa20:N,crypto_stream_xor:I,crypto_stream:S,crypto_stream_salsa20_xor:q,crypto_stream_salsa20:X,crypto_onetimeauth:F,crypto_onetimeauth_verify:H,crypto_verify_16:b,crypto_verify_32:x,crypto_secretbox:ne,crypto_secretbox_open:ee,crypto_scalarmult:rn,crypto_scalarmult_base:nn,crypto_box_beforenm:sn,crypto_box_afternm:Pn,crypto_box:Dn,crypto_box_open:on,crypto_box_keypair:dr,crypto_hash:se,crypto_sign:mt,crypto_sign_keypair:Kt,crypto_sign_open:ot,crypto_secretbox_KEYBYTES:jt,crypto_secretbox_NONCEBYTES:pt,crypto_secretbox_ZEROBYTES:Mr,crypto_secretbox_BOXZEROBYTES:cn,crypto_scalarmult_BYTES:Hn,crypto_scalarmult_SCALARBYTES:vi,crypto_box_PUBLICKEYBYTES:Qn,crypto_box_SECRETKEYBYTES:Mn,crypto_box_BEFORENMBYTES:$s,crypto_box_NONCEBYTES:ma,crypto_box_ZEROBYTES:jl,crypto_box_BOXZEROBYTES:Xl,crypto_sign_BYTES:gr,crypto_sign_PUBLICKEYBYTES:Fr,crypto_sign_SECRETKEYBYTES:un,crypto_sign_SEEDBYTES:Gs,crypto_hash_BYTES:Ys};function Ba(d,_){if(d.length!==jt)throw new Error("bad key size");if(_.length!==pt)throw new Error("bad nonce size")}function Vl(d,_){if(d.length!==Qn)throw new Error("bad public key size");if(_.length!==Mn)throw new Error("bad secret key size")}function $t(){var d,_;for(_=0;_<arguments.length;_++)if((d=Object.prototype.toString.call(arguments[_]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+d+", use Uint8Array")}function Ca(d){for(var _=0;_<d.length;_++)d[_]=0}r.util||(r.util={},r.util.decodeUTF8=r.util.encodeUTF8=r.util.encodeBase64=r.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}),r.randomBytes=function(d){var _=new Uint8Array(d);return t(_,d),_},r.secretbox=function(d,_,A){$t(d,_,A),Ba(A,_);for(var u=new Uint8Array(Mr+d.length),E=new Uint8Array(u.length),C=0;C<d.length;C++)u[C+Mr]=d[C];return ne(E,u,u.length,_,A),E.subarray(cn)},r.secretbox.open=function(d,_,A){$t(d,_,A),Ba(A,_);for(var u=new Uint8Array(cn+d.length),E=new Uint8Array(u.length),C=0;C<d.length;C++)u[C+cn]=d[C];return u.length<32||ee(E,u,u.length,_,A)!==0?!1:E.subarray(Mr)},r.secretbox.keyLength=jt,r.secretbox.nonceLength=pt,r.secretbox.overheadLength=cn,r.scalarMult=function(d,_){if($t(d,_),d.length!==vi)throw new Error("bad n size");if(_.length!==Hn)throw new Error("bad p size");var A=new Uint8Array(Hn);return rn(A,d,_),A},r.scalarMult.base=function(d){if($t(d),d.length!==vi)throw new Error("bad n size");var _=new Uint8Array(Hn);return nn(_,d),_},r.scalarMult.scalarLength=vi,r.scalarMult.groupElementLength=Hn,r.box=function(d,_,A,u){var E=r.box.before(A,u);return r.secretbox(d,_,E)},r.box.before=function(d,_){$t(d,_),Vl(d,_);var A=new Uint8Array($s);return sn(A,d,_),A},r.box.after=r.secretbox,r.box.open=function(d,_,A,u){var E=r.box.before(A,u);return r.secretbox.open(d,_,E)},r.box.open.after=r.secretbox.open,r.box.keyPair=function(){var d=new Uint8Array(Qn),_=new Uint8Array(Mn);return dr(d,_),{publicKey:d,secretKey:_}},r.box.keyPair.fromSecretKey=function(d){if($t(d),d.length!==Mn)throw new Error("bad secret key size");var _=new Uint8Array(Qn);return nn(_,d),{publicKey:_,secretKey:new Uint8Array(d)}},r.box.publicKeyLength=Qn,r.box.secretKeyLength=Mn,r.box.sharedKeyLength=$s,r.box.nonceLength=ma,r.box.overheadLength=r.secretbox.overheadLength,r.sign=function(d,_){if($t(d,_),_.length!==un)throw new Error("bad secret key size");var A=new Uint8Array(gr+d.length);return mt(A,d,d.length,_),A},r.sign.open=function(d,_){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");if($t(d,_),_.length!==Fr)throw new Error("bad public key size");var A=new Uint8Array(d.length),u=ot(A,d,d.length,_);if(u<0)return null;for(var E=new Uint8Array(u),C=0;C<E.length;C++)E[C]=A[C];return E},r.sign.detached=function(d,_){for(var A=r.sign(d,_),u=new Uint8Array(gr),E=0;E<u.length;E++)u[E]=A[E];return u},r.sign.detached.verify=function(d,_,A){if($t(d,_,A),_.length!==gr)throw new Error("bad signature size");if(A.length!==Fr)throw new Error("bad public key size");var u=new Uint8Array(gr+d.length),E=new Uint8Array(gr+d.length),C;for(C=0;C<gr;C++)u[C]=_[C];for(C=0;C<d.length;C++)u[C+gr]=d[C];return ot(E,u,u.length,A)>=0},r.sign.keyPair=function(){var d=new Uint8Array(Fr),_=new Uint8Array(un);return Kt(d,_),{publicKey:d,secretKey:_}},r.sign.keyPair.fromSecretKey=function(d){if($t(d),d.length!==un)throw new Error("bad secret key size");for(var _=new Uint8Array(Fr),A=0;A<_.length;A++)_[A]=d[32+A];return{publicKey:_,secretKey:new Uint8Array(d)}},r.sign.keyPair.fromSeed=function(d){if($t(d),d.length!==Gs)throw new Error("bad seed size");for(var _=new Uint8Array(Fr),A=new Uint8Array(un),u=0;u<32;u++)A[u]=d[u];return Kt(_,A,!0),{publicKey:_,secretKey:A}},r.sign.publicKeyLength=Fr,r.sign.secretKeyLength=un,r.sign.seedLength=Gs,r.sign.signatureLength=gr,r.hash=function(d){$t(d);var _=new Uint8Array(Ys);return se(_,d,d.length),_},r.hash.hashLength=Ys,r.verify=function(d,_){return $t(d,_),d.length===0||_.length===0||d.length!==_.length?!1:y(d,0,_,0,d.length)===0},r.setPRNG=function(d){t=d},function(){var d=typeof self<"u"?self.crypto||self.msCrypto:null;if(d&&d.getRandomValues){var _=65536;r.setPRNG(function(A,u){var E,C=new Uint8Array(u);for(E=0;E<u;E+=_)d.getRandomValues(C.subarray(E,E+Math.min(u-E,_)));for(E=0;E<u;E++)A[E]=C[E];Ca(C)})}else typeof require<"u"&&(d=require("crypto"),d&&d.randomBytes&&r.setPRNG(function(A,u){var E,C=d.randomBytes(u);for(E=0;E<u;E++)A[E]=C[E];Ca(C)}))}()})(typeof Qi<"u"&&Qi.exports?Qi.exports:self.nacl=self.nacl||{})});var to=_e((db,Fa)=>{"use strict";var Js=Ma().lowlevel.crypto_hash,Ar=0,Wr=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])],this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function Fi(r,e,t){return(r[0][e[t+3]]+r[1][e[t+2]]^r[2][e[t+1]])+r[3][e[t]]}Wr.prototype.encipher=function(r,e){e===void 0&&(e=new Uint8Array(r.buffer),r.byteOffset!==0&&(e=e.subarray(r.byteOffset))),r[0]^=this.P[0];for(var t=1;t<16;t+=2)r[1]^=Fi(this.S,e,0)^this.P[t],r[0]^=Fi(this.S,e,4)^this.P[t+1];var n=r[0];r[0]=r[1]^this.P[17],r[1]=n};Wr.prototype.decipher=function(r){var e=new Uint8Array(r.buffer);r.byteOffset!==0&&(e=e.subarray(r.byteOffset)),r[0]^=this.P[17];for(var t=16;t>0;t-=2)r[1]^=Fi(this.S,e,0)^this.P[t],r[0]^=Fi(this.S,e,4)^this.P[t-1];var n=r[0];r[0]=r[1]^this.P[0],r[1]=n};function qr(r,e){var t,n=0;for(t=0;t<4;t++,Ar++)Ar>=e&&(Ar=0),n=n<<8|r[Ar];return n}Wr.prototype.expand0state=function(r,e){var t=new Uint32Array(2),n,i,s=new Uint8Array(t.buffer);for(n=0,Ar=0;n<18;n++)this.P[n]^=qr(r,e);for(Ar=0,n=0;n<18;n+=2)this.encipher(t,s),this.P[n]=t[0],this.P[n+1]=t[1];for(n=0;n<4;n++)for(i=0;i<256;i+=2)this.encipher(t,s),this.S[n][i]=t[0],this.S[n][i+1]=t[1]};Wr.prototype.expandstate=function(r,e,t,n){var i=new Uint32Array(2),s,o;for(s=0,Ar=0;s<18;s++)this.P[s]^=qr(t,n);for(s=0,Ar=0;s<18;s+=2)i[0]^=qr(r,e),i[1]^=qr(r,e),this.encipher(i),this.P[s]=i[0],this.P[s+1]=i[1];for(s=0;s<4;s++)for(o=0;o<256;o+=2)i[0]^=qr(r,e),i[1]^=qr(r,e),this.encipher(i),this.S[s][o]=i[0],this.S[s][o+1]=i[1];Ar=0};Wr.prototype.enc=function(r,e){for(var t=0;t<e;t++)this.encipher(r.subarray(t*2))};Wr.prototype.dec=function(r,e){for(var t=0;t<e;t++)this.decipher(r.subarray(t*2))};var Mi=8,Zs=32;function eo(r,e,t){var n=new Wr,i=new Uint32Array(Mi),s,o=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);for(n.expandstate(e,64,r,64),s=0;s<64;s++)n.expand0state(e,64),n.expand0state(r,64);for(s=0;s<Mi;s++)i[s]=qr(o,o.byteLength);for(s=0;s<64;s++)n.enc(i,i.byteLength/8);for(s=0;s<Mi;s++)t[4*s+3]=i[s]>>>24,t[4*s+2]=i[s]>>>16,t[4*s+1]=i[s]>>>8,t[4*s+0]=i[s]}function ud(r,e,t,n,i,s,o){var f=new Uint8Array(64),a=new Uint8Array(64),c=new Uint8Array(Zs),h=new Uint8Array(Zs),l=new Uint8Array(n+4),g,p,y,b,x,m,L=s;if(o<1||e===0||n===0||s===0||s>c.byteLength*c.byteLength||n>1<<20)return-1;for(b=Math.floor((s+c.byteLength-1)/c.byteLength),y=Math.floor((s+b-1)/b),g=0;g<n;g++)l[g]=t[g];for(Js(f,r,e),m=1;s>0;m++){for(l[n+0]=m>>>24,l[n+1]=m>>>16,l[n+2]=m>>>8,l[n+3]=m,Js(a,l,n+4),eo(f,a,h),g=c.byteLength;g--;)c[g]=h[g];for(g=1;g<o;g++)for(Js(a,h,h.byteLength),eo(f,a,h),p=0;p<c.byteLength;p++)c[p]^=h[p];for(y=Math.min(y,s),g=0;g<y&&(x=g*b+(m-1),!(x>=L));g++)i[x]=c[g];s-=g}return 0}Fa.exports={BLOCKS:Mi,HASHSIZE:Zs,hash:eo,pbkdf:ud}});var Wa=_e((gb,qa)=>{"use strict";var hd=require("../node_modules/.pnpm/cpu-features@0.0.8/node_modules/cpu-features/build/Release/cpufeatures.node");qa.exports=hd.getCPUInfo});var pr=_e((Ab,Wi)=>{"use strict";var _r=require("crypto"),An;try{An=Wa()()}catch{}var{bindingAvailable:Ka,CIPHER_INFO:ld,MAC_INFO:dd}=Br(),$a=(()=>{if(typeof _r.sign=="function"&&typeof _r.verify=="function"){let r=`-----BEGIN PRIVATE KEY-----\r
MC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r
-----END PRIVATE KEY-----`,e=Buffer.from("a"),t,n;try{t=_r.sign(null,e,r),n=_r.verify(null,e,r,t)}catch{}return Buffer.isBuffer(t)&&t.length===64&&n===!0}return!1})(),Ga=typeof _r.diffieHellman=="function"&&typeof _r.generateKeyPairSync=="function"&&typeof _r.createPublicKey=="function",qi=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];Ga&&(qi.unshift("curve25519-sha256"),qi.unshift("curve25519-sha256@libssh.org"));var gd=qi.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]),ro=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];$a&&ro.unshift("ssh-ed25519");var Ad=ro.concat(["ssh-dss"]),Ya=(()=>{let r=_r.getCiphers();return e=>r.includes(ld[e].sslName)})(),mr=["aes128-gcm@openssh.com","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];An&&An.flags&&!An.flags.aes?Ka?mr.unshift("chacha20-poly1305@openssh.com"):mr.push("chacha20-poly1305@openssh.com"):Ka&&An&&An.arch==="x86"?mr.splice(4,0,"chacha20-poly1305@openssh.com"):mr.push("chacha20-poly1305@openssh.com");mr=mr.filter(Ya);var _d=mr.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","aes128-gcm","aes256-gcm","arcfour256","arcfour128","cast128-cbc","arcfour"].filter(Ya)),ja=(()=>{let r=_r.getHashes();return e=>r.includes(dd[e].sslName)})(),Xa=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"].filter(ja),pd=Xa.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"].filter(ja)),Va=["none","zlib@openssh.com","zlib"],Ed=Va.concat([]),gn={BAD_DHGEX:1,OLD_EXIT:2,DYN_RPORT_BUG:4,BUG_DHGEX_LARGE:8,IMPLY_RSA_SHA2_SIGALGS:16};Wi.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,EXT_INFO:7,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:void 0,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce((r,e)=>({...r,[e]:1}),{}),COMPAT:gn,COMPAT_CHECKS:[["Cisco-1.25",gn.BAD_DHGEX],[/^Cisco-1[.]/,gn.BUG_DHGEX_LARGE],[/^[0-9.]+$/,gn.OLD_EXIT],[/^OpenSSH_5[.][0-9]+/,gn.DYN_RPORT_BUG],[/^OpenSSH_7[.]4/,gn.IMPLY_RSA_SHA2_SIGALGS]],DEFAULT_KEX:qi,SUPPORTED_KEX:gd,DEFAULT_SERVER_HOST_KEY:ro,SUPPORTED_SERVER_HOST_KEY:Ad,DEFAULT_CIPHER:mr,SUPPORTED_CIPHER:_d,DEFAULT_MAC:Xa,SUPPORTED_MAC:pd,DEFAULT_COMPRESSION:Va,SUPPORTED_COMPRESSION:Ed,curve25519Supported:Ga,eddsaSupported:$a};Wi.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(Wi.exports.DISCONNECT_REASON)).reduce((r,[e,t])=>({...r,[t]:e}),{})});var rr=_e((_b,ec)=>{"use strict";var zt=qn().Ber,Ki,Za=Buffer[Symbol.species],bd=Object.getPrototypeOf(Uint8Array.prototype).fill;function za(r,e){return r[e++]*16777216+r[e++]*65536+r[e++]*256+r[e]}function Wn(r,e,t,n,i){i||(i=0),n>r.length&&(n=r.length);let s=n-t,o=e.length-i;return s>o&&(s=o),e.set(new Uint8Array(r.buffer,r.byteOffset+t,s),i),s}function Kn(r,e,t){return t===void 0&&(t=r.length),new Za(r.buffer,r.byteOffset+e,t-e)}function io(){let r=0,e,t={init:(n,i)=>{e=n,r=typeof i=="number"?i:0},pos:()=>r,length:()=>e?e.length:0,avail:()=>e&&r<e.length?e.length-r:0,clear:()=>{e=void 0},readUInt32BE:()=>{if(!(!e||r+3>=e.length))return e[r++]*16777216+e[r++]*65536+e[r++]*256+e[r++]},readUInt64BE:n=>{if(!(!e||r+7>=e.length))switch(n){case"always":return BigInt(`0x${e.hexSlice(r,r+=8)}`);case"maybe":if(e[r]>31)return BigInt(`0x${e.hexSlice(r,r+=8)}`);default:return e[r++]*72057594037927940+e[r++]*281474976710656+e[r++]*1099511627776+e[r++]*4294967296+e[r++]*16777216+e[r++]*65536+e[r++]*256+e[r++]}},skip:n=>{e&&n>0&&(r+=n)},skipString:()=>{let n=t.readUInt32BE();if(n!==void 0)return r+=n,r<=e.length?n:void 0},readByte:()=>{if(e&&r<e.length)return e[r++]},readBool:()=>{if(e&&r<e.length)return!!e[r++]},readList:()=>{let n=t.readString(!0);if(n!==void 0)return n?n.split(","):[]},readString:(n,i)=>{typeof n=="number"&&(i=n,n=void 0);let s=t.readUInt32BE();if(s!==void 0&&!(e.length-r<s||typeof i=="number"&&s>i))return n?Buffer.isBuffer(n)?Wn(e,n,r,r+=s):e.utf8Slice(r,r+=s):Kn(e,r,r+=s)},readRaw:n=>{if(e){if(typeof n!="number")return Kn(e,r,r+=e.length-r);if(e.length-r>=n)return Kn(e,r,r+=n)}}};return t}function Ja(r,e,t){let n=new Error(r);return typeof e=="boolean"?(t=e,n.level="protocol"):n.level=e||"protocol",n.fatal=!!t,n}function no(r,e,t){return r[t++]=e>>>24,r[t++]=e>>>16,r[t++]=e>>>8,r[t++]=e,t}var $i=io();ec.exports={bufferCopy:Wn,bufferSlice:Kn,FastBuffer:Za,bufferFill:(r,e,t,n)=>bd.call(r,e,t,n),makeError:Ja,doFatalError:(r,e,t,n)=>{let i;return Ki===void 0&&({DISCONNECT_REASON:Ki}=pr()),e instanceof Error?(i=e,typeof t!="number"?n=Ki.PROTOCOL_ERROR:n=t):i=Ja(e,t,!0),typeof n!="number"&&(n=Ki.PROTOCOL_ERROR),r.disconnect(n),r._destruct(),r._onError(i),1/0},readUInt32BE:za,writeUInt32BE:no,writeUInt32LE:(r,e,t)=>(r[t++]=e,r[t++]=e>>>8,r[t++]=e>>>16,r[t++]=e>>>24,t),makeBufferParser:io,bufferParser:io(),readString:(r,e,t,n)=>{typeof t=="number"&&(n=t,t=void 0),e===void 0&&(e=0);let i=r.length-e;if(e<0||e>=r.length||i<4)return;let s=za(r,e);if(i<4+s||typeof n=="number"&&s>n)return;e+=4;let o=e+s;return r._pos=o,t?Buffer.isBuffer(t)?Wn(r,t,e,o):r.utf8Slice(e,o):Kn(r,e,o)},sigSSHToASN1:(r,e)=>{switch(e){case"ssh-dss":{if(r.length>40)return r;let t=new zt.Writer;t.startSequence();let n=r.slice(0,20),i=r.slice(20);if(n[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,n.copy(s,1),n=s}else n[0]===0&&!(n[1]&128)&&(n=n.slice(1));if(i[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,i.copy(s,1),i=s}else i[0]===0&&!(i[1]&128)&&(i=i.slice(1));return t.writeBuffer(n,zt.Integer),t.writeBuffer(i,zt.Integer),t.endSequence(),t.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{$i.init(r,0);let t=$i.readString(),n=$i.readString();if($i.clear(),t===void 0||n===void 0)return;let i=new zt.Writer;return i.startSequence(),i.writeBuffer(t,zt.Integer),i.writeBuffer(n,zt.Integer),i.endSequence(),i.buffer}default:return r}},convertSignature:(r,e)=>{switch(e){case"ssh-dss":{if(r.length<=40)return r;let t=new zt.Reader(r);t.readSequence();let n=t.readString(zt.Integer,!0),i=t.readString(zt.Integer,!0),s=0,o=0;if(n.length<20){let a=Buffer.allocUnsafe(20);a.set(n,1),n=a,n[0]=0}if(i.length<20){let a=Buffer.allocUnsafe(20);a.set(i,1),i=a,i[0]=0}n.length>20&&n[0]===0&&(s=1),i.length>20&&i[0]===0&&(o=1);let f=Buffer.allocUnsafe(n.length-s+(i.length-o));return Wn(n,f,s,n.length,0),Wn(i,f,o,i.length,n.length-s),f}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(r[0]===0)return r;let t=new zt.Reader(r);t.readSequence();let n=t.readString(zt.Integer,!0),i=t.readString(zt.Integer,!0);if(n===null||i===null)return;let s=Buffer.allocUnsafe(4+n.length+4+i.length);return no(s,n.length,0),s.set(n,4),no(s,i.length,4+n.length),s.set(i,4+4+n.length),s}}return r},sendPacket:(r,e,t)=>!t&&r._kexinit!==void 0?(r._queue===void 0&&(r._queue=[]),r._queue.push(e),r._debug&&r._debug("Outbound: ... packet queued"),!1):(r._cipher.encrypt(e),!0)}});var tc=_e((Gi,oo)=>{var so=function(){var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(e){e=e||{};var t;t||(t=typeof e<"u"?e:{});var n,i;t.ready=new Promise(function($,se){n=$,i=se});var s={},o;for(o in t)t.hasOwnProperty(o)&&(s[o]=t[o]);var f=typeof window=="object",a=typeof importScripts=="function",c=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="",l,g,p,y,b;c?(h=a?require("path").dirname(h)+"/":__dirname+"/",l=function($,se){var be=dr($);return be?se?be:be.toString():(y||(y=require("fs")),b||(b=require("path")),$=b.normalize($),y.readFileSync($,se?null:"utf8"))},p=function($){return $=l($,!0),$.buffer||($=new Uint8Array($)),K($.buffer),$},g=function($,se,be){var Re=dr($);Re&&se(Re),y||(y=require("fs")),b||(b=require("path")),$=b.normalize($),y.readFile($,function(Ge,St){Ge?be(Ge):se(St.buffer)})},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),t.inspect=function(){return"[Emscripten Module object]"}):(f||a)&&(a?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.lastIndexOf("/")+1):h="",l=function($){try{var se=new XMLHttpRequest;return se.open("GET",$,!1),se.send(null),se.responseText}catch(Ge){if($=dr($)){se=[];for(var be=0;be<$.length;be++){var Re=$[be];255<Re&&(rn&&K(!1,"Character code "+Re+" ("+String.fromCharCode(Re)+")  at offset "+be+" not in 0x00-0xFF."),Re&=255),se.push(String.fromCharCode(Re))}return se.join("")}throw Ge}},a&&(p=function($){try{var se=new XMLHttpRequest;return se.open("GET",$,!1),se.responseType="arraybuffer",se.send(null),new Uint8Array(se.response)}catch(be){if($=dr($))return $;throw be}}),g=function($,se,be){var Re=new XMLHttpRequest;Re.open("GET",$,!0),Re.responseType="arraybuffer",Re.onload=function(){if(Re.status==200||Re.status==0&&Re.response)se(Re.response);else{var Ge=dr($);Ge?se(Ge.buffer):be()}},Re.onerror=be,Re.send(null)}),t.print||console.log.bind(console);var x=t.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(t[o]=s[o]);s=null;var m;t.wasmBinary&&(m=t.wasmBinary);var L=t.noExitRuntime||!0;typeof WebAssembly!="object"&&z("no native wasm support detected");var W,N=!1;function K($,se){$||z("Assertion failed: "+se)}function q($){var se=t["_"+$];return K(se,"Cannot call unknown function "+$+", make sure it is exported"),se}function X($,se,be,Re){var Ge={string:function(rt){var Ct=0;if(rt!=null&&rt!==0){var mt=(rt.length<<2)+1;Ct=Dn(mt);var _t=Ct,ot=F;if(0<mt){mt=_t+mt-1;for(var jt=0;jt<rt.length;++jt){var pt=rt.charCodeAt(jt);if(55296<=pt&&57343>=pt){var Mr=rt.charCodeAt(++jt);pt=65536+((pt&1023)<<10)|Mr&1023}if(127>=pt){if(_t>=mt)break;ot[_t++]=pt}else{if(2047>=pt){if(_t+1>=mt)break;ot[_t++]=192|pt>>6}else{if(65535>=pt){if(_t+2>=mt)break;ot[_t++]=224|pt>>12}else{if(_t+3>=mt)break;ot[_t++]=240|pt>>18,ot[_t++]=128|pt>>12&63}ot[_t++]=128|pt>>6&63}ot[_t++]=128|pt&63}}ot[_t]=0}}return Ct},array:function(rt){var Ct=Dn(rt.length);return O.set(rt,Ct),Ct}},St=q($),fr=[];if($=0,Re)for(var Kt=0;Kt<Re.length;Kt++){var an=Ge[be[Kt]];an?($===0&&($=Pn()),fr[Kt]=an(Re[Kt])):fr[Kt]=Re[Kt]}return be=St.apply(null,fr),be=function(rt){if(se==="string")if(rt){for(var Ct=F,mt=rt+NaN,_t=rt;Ct[_t]&&!(_t>=mt);)++_t;if(16<_t-rt&&Ct.subarray&&S)rt=S.decode(Ct.subarray(rt,_t));else{for(mt="";rt<_t;){var ot=Ct[rt++];if(ot&128){var jt=Ct[rt++]&63;if((ot&224)==192)mt+=String.fromCharCode((ot&31)<<6|jt);else{var pt=Ct[rt++]&63;ot=(ot&240)==224?(ot&15)<<12|jt<<6|pt:(ot&7)<<18|jt<<12|pt<<6|Ct[rt++]&63,65536>ot?mt+=String.fromCharCode(ot):(ot-=65536,mt+=String.fromCharCode(55296|ot>>10,56320|ot&1023))}}else mt+=String.fromCharCode(ot)}rt=mt}}else rt="";else rt=se==="boolean"?!!rt:rt;return rt}(be),$!==0&&ki($),be}var S=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,I,O,F;function H(){var $=W.buffer;I=$,t.HEAP8=O=new Int8Array($),t.HEAP16=new Int16Array($),t.HEAP32=new Int32Array($),t.HEAPU8=F=new Uint8Array($),t.HEAPU16=new Uint16Array($),t.HEAPU32=new Uint32Array($),t.HEAPF32=new Float32Array($),t.HEAPF64=new Float64Array($)}var ne,ee=[],J=[],te=[];function ie(){var $=t.preRun.shift();ee.unshift($)}var T=0,M=null,Q=null;t.preloadedImages={},t.preloadedAudios={};function z($){throw t.onAbort&&t.onAbort($),x($),N=!0,$=new WebAssembly.RuntimeError("abort("+$+"). Build with -s ASSERTIONS=1 for more info."),i($),$}var le="data:application/octet-stream;base64,",pe;if(pe="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==",!pe.startsWith(le)){var ge=pe;pe=t.locateFile?t.locateFile(ge,h):h+ge}function at(){var $=pe;try{if($==pe&&m)return new Uint8Array(m);var se=dr($);if(se)return se;if(p)return p($);throw"both async and sync fetching of the wasm failed"}catch(be){z(be)}}function Tt(){if(!m&&(f||a)){if(typeof fetch=="function"&&!pe.startsWith("file://"))return fetch(pe,{credentials:"same-origin"}).then(function($){if(!$.ok)throw"failed to load wasm binary file at '"+pe+"'";return $.arrayBuffer()}).catch(function(){return at()});if(g)return new Promise(function($,se){g(pe,function(be){$(new Uint8Array(be))},se)})}return Promise.resolve().then(function(){return at()})}function Un($){for(;0<$.length;){var se=$.shift();if(typeof se=="function")se(t);else{var be=se.m;typeof be=="number"?se.l===void 0?ne.get(be)():ne.get(be)(se.l):be(se.l===void 0?null:se.l)}}}var rn=!1,nn=typeof atob=="function"?atob:function($){var se="",be=0;$=$.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($.charAt(be++)),Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($.charAt(be++)),St="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($.charAt(be++)),fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($.charAt(be++));Re=Re<<2|Ge>>4,Ge=(Ge&15)<<4|St>>2;var Kt=(St&3)<<6|fr;se+=String.fromCharCode(Re),St!==64&&(se+=String.fromCharCode(Ge)),fr!==64&&(se+=String.fromCharCode(Kt))}while(be<$.length);return se};function dr($){if($.startsWith(le)){if($=$.slice(le.length),typeof c=="boolean"&&c){var se=Buffer.from($,"base64");se=new Uint8Array(se.buffer,se.byteOffset,se.byteLength)}else try{var be=nn($),Re=new Uint8Array(be.length);for($=0;$<be.length;++$)Re[$]=be.charCodeAt($);se=Re}catch{throw Error("Converting base64 string to bytes failed.")}return se}}var sn={a:function($){var se=F.length;if($>>>=0,2147483648<$)return!1;for(var be=1;4>=be;be*=2){var Re=se*(1+.2/be);Re=Math.min(Re,$+100663296),Re=Math.max($,Re),0<Re%65536&&(Re+=65536-Re%65536);e:{try{W.grow(Math.min(2147483648,Re)-I.byteLength+65535>>>16),H();var Ge=1;break e}catch{}Ge=void 0}if(Ge)return!0}return!1}};(function(){function $(Ge){t.asm=Ge.exports,W=t.asm.b,H(),ne=t.asm.j,J.unshift(t.asm.c),T--,t.monitorRunDependencies&&t.monitorRunDependencies(T),T==0&&(M!==null&&(clearInterval(M),M=null),Q&&(Ge=Q,Q=null,Ge()))}function se(Ge){$(Ge.instance)}function be(Ge){return Tt().then(function(St){return WebAssembly.instantiate(St,Re)}).then(Ge,function(St){x("failed to asynchronously prepare wasm: "+St),z(St)})}var Re={a:sn};if(T++,t.monitorRunDependencies&&t.monitorRunDependencies(T),t.instantiateWasm)try{return t.instantiateWasm(Re,$)}catch(Ge){return x("Module.instantiateWasm callback failed with error: "+Ge),!1}return function(){return m||typeof WebAssembly.instantiateStreaming!="function"||pe.startsWith(le)||pe.startsWith("file://")||typeof fetch!="function"?be(se):fetch(pe,{credentials:"same-origin"}).then(function(Ge){return WebAssembly.instantiateStreaming(Ge,Re).then(se,function(St){return x("wasm streaming compile failed: "+St),x("falling back to ArrayBuffer instantiation"),be(se)})})}().catch(i),{}})(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.c).apply(null,arguments)},t._poly1305_auth=function(){return(t._poly1305_auth=t.asm.d).apply(null,arguments)};var Pn=t.stackSave=function(){return(Pn=t.stackSave=t.asm.e).apply(null,arguments)},ki=t.stackRestore=function(){return(ki=t.stackRestore=t.asm.f).apply(null,arguments)},Dn=t.stackAlloc=function(){return(Dn=t.stackAlloc=t.asm.g).apply(null,arguments)};t._malloc=function(){return(t._malloc=t.asm.h).apply(null,arguments)},t._free=function(){return(t._free=t.asm.i).apply(null,arguments)},t.cwrap=function($,se,be,Re){be=be||[];var Ge=be.every(function(St){return St==="number"});return se!=="string"&&Ge&&!Re?q($):function(){return X($,se,be,arguments)}};var on;Q=function $(){on||fn(),on||(Q=$)};function fn(){function $(){if(!on&&(on=!0,t.calledRun=!0,!N)){if(Un(J),n(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;){var se=t.postRun.shift();te.unshift(se)}Un(te)}}if(!(0<T)){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)ie();Un(ee),0<T||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),$()},1)):$())}}if(t.run=fn,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return fn(),e.ready}}();typeof Gi=="object"&&typeof oo=="object"?oo.exports=so:typeof define=="function"&&define.amd?define([],function(){return so}):typeof Gi=="object"&&(Gi.createPoly1305=so)});var Br=_e((pb,oc)=>{"use strict";var{createCipheriv:pn,createDecipheriv:Yi,createHmac:fo,randomFillSync:Kr,timingSafeEqual:ao}=require("crypto"),{readUInt32BE:Gn,writeUInt32BE:Gt}=rr(),Cr=Buffer[Symbol.species],rc=2**32-1,nc=Buffer.alloc(0),_n=Buffer.alloc(4),ji=new Map,$r=35e3,co,mo,Bo,Co,Ro,ko,vo;try{co=require("./crypto/build/Release/sshcrypto.node"),{AESGCMCipher:mo,ChaChaPolyCipher:Bo,GenericCipher:Co,AESGCMDecipher:Ro,ChaChaPolyDecipher:ko,GenericDecipher:vo}=co}catch{}var vt=1,yd=(()=>{function r(e,t,n,i,s,o,f){return{sslName:e,blockLen:t,keyLen:n,ivLen:i!==0||f&vt?i:t,authLen:s,discardLen:o,stream:!!(f&vt)}}return{"chacha20-poly1305@openssh.com":r("chacha20",8,64,0,16,0,vt),"aes128-gcm":r("aes-128-gcm",16,16,12,16,0,vt),"aes256-gcm":r("aes-256-gcm",16,32,12,16,0,vt),"aes128-gcm@openssh.com":r("aes-128-gcm",16,16,12,16,0,vt),"aes256-gcm@openssh.com":r("aes-256-gcm",16,32,12,16,0,vt),"aes128-cbc":r("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":r("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":r("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":r("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":r("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":r("bf-cbc",8,16,0,0,0,0),"idea-cbc":r("idea-cbc",8,16,0,0,0,0),"cast128-cbc":r("cast-cbc",8,16,0,0,0,0),"aes128-ctr":r("aes-128-ctr",16,16,16,0,0,vt),"aes192-ctr":r("aes-192-ctr",16,24,16,0,0,vt),"aes256-ctr":r("aes-256-ctr",16,32,16,0,0,vt),"3des-ctr":r("des-ede3",8,24,8,0,0,vt),"blowfish-ctr":r("bf-ecb",8,16,8,0,0,vt),"cast128-ctr":r("cast5-ecb",8,16,8,0,0,vt),arcfour:r("rc4",8,16,0,0,1536,vt),arcfour128:r("rc4",8,16,0,0,1536,vt),arcfour256:r("rc4",8,32,0,0,1536,vt),arcfour512:r("rc4",8,64,0,0,1536,vt)}})(),wd=(()=>{function r(e,t,n,i){return{sslName:e,len:t,actualLen:n,isETM:i}}return{"hmac-md5":r("md5",16,16,!1),"hmac-md5-96":r("md5",16,12,!1),"hmac-ripemd160":r("ripemd160",20,20,!1),"hmac-sha1":r("sha1",20,20,!1),"hmac-sha1-etm@openssh.com":r("sha1",20,20,!0),"hmac-sha1-96":r("sha1",20,12,!1),"hmac-sha2-256":r("sha256",32,32,!1),"hmac-sha2-256-etm@openssh.com":r("sha256",32,32,!0),"hmac-sha2-256-96":r("sha256",32,12,!1),"hmac-sha2-512":r("sha512",64,64,!1),"hmac-sha2-512-etm@openssh.com":r("sha512",64,64,!0),"hmac-sha2-512-96":r("sha512",64,12,!1)}})(),uo=class{constructor(e,t){this.outSeqno=e,this._onWrite=t,this._dead=!1}free(){this._dead=!0}allocPacket(e){let t=5+e,n=8-(t&8-1);n<4&&(n+=8),t+=n;let i=Buffer.allocUnsafe(t);return Gt(i,t-4,0),i[4]=n,Kr(i,5+e,n),i}encrypt(e){this._dead||(this._onWrite(e),this.outSeqno=this.outSeqno+1>>>0)}},ic=Buffer.alloc(32),Mt=Buffer.alloc(16),$n,Yn,No,ho=class{constructor(e){let t=e.outbound;this.outSeqno=t.seqno,this._onWrite=t.onWrite,this._encKeyMain=t.cipherKey.slice(0,32),this._encKeyPktLen=t.cipherKey.slice(32),this._dead=!1}free(){this._dead=!0}allocPacket(e){let t=5+e,n=8-(t-4&8-1);n<4&&(n+=8),t+=n;let i=Buffer.allocUnsafe(t);return Gt(i,t-4,0),i[4]=n,Kr(i,5+e,n),i}encrypt(e){if(this._dead)return;Mt[0]=0,Gt(Mt,this.outSeqno,12);let t=pn("chacha20",this._encKeyMain,Mt).update(ic),n=pn("chacha20",this._encKeyPktLen,Mt).update(e.slice(0,4));this._onWrite(n),Mt[0]=1;let i=pn("chacha20",this._encKeyMain,Mt).update(e.slice(4));this._onWrite(i),No(Yn,n,n.length,i,i.length,t);let s=Buffer.allocUnsafe(16);s.set(new Uint8Array($n.HEAPU8.buffer,Yn,16),0),this._onWrite(s),this.outSeqno=this.outSeqno+1>>>0}},lo=class{constructor(e){let t=e.outbound;this.outSeqno=t.seqno,this._onWrite=t.onWrite,this._instance=new Bo(t.cipherKey),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(e){let t=5+e,n=8-(t-4&8-1);n<4&&(n+=8),t+=n;let i=Buffer.allocUnsafe(t+16);return Gt(i,t-4,0),i[4]=n,Kr(i,5+e,n),i}encrypt(e){this._dead||(this._instance.encrypt(e,this.outSeqno),this._onWrite(e),this.outSeqno=this.outSeqno+1>>>0)}},go=class{constructor(e){let t=e.outbound;this.outSeqno=t.seqno,this._onWrite=t.onWrite,this._encSSLName=t.cipherInfo.sslName,this._encKey=t.cipherKey,this._encIV=t.cipherIV,this._dead=!1}free(){this._dead=!0}allocPacket(e){let t=5+e,n=16-(t-4&16-1);n<4&&(n+=16),t+=n;let i=Buffer.allocUnsafe(t);return Gt(i,t-4,0),i[4]=n,Kr(i,5+e,n),i}encrypt(e){if(this._dead)return;let t=pn(this._encSSLName,this._encKey,this._encIV);t.setAutoPadding(!1);let n=e.slice(0,4);t.setAAD(n),this._onWrite(n);let i=t.update(e.slice(4));this._onWrite(i);let s=t.final();s.length&&this._onWrite(s);let o=t.getAuthTag();this._onWrite(o),sc(this._encIV),this.outSeqno=this.outSeqno+1>>>0}},Ao=class{constructor(e){let t=e.outbound;this.outSeqno=t.seqno,this._onWrite=t.onWrite,this._instance=new mo(t.cipherInfo.sslName,t.cipherKey,t.cipherIV),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(e){let t=5+e,n=16-(t-4&16-1);n<4&&(n+=16),t+=n;let i=Buffer.allocUnsafe(t+16);return Gt(i,t-4,0),i[4]=n,Kr(i,5+e,n),i}encrypt(e){this._dead||(this._instance.encrypt(e),this._onWrite(e),this.outSeqno=this.outSeqno+1>>>0)}},_o=class{constructor(e){let t=e.outbound;this.outSeqno=t.seqno,this._onWrite=t.onWrite,this._encBlockLen=t.cipherInfo.blockLen,this._cipherInstance=pn(t.cipherInfo.sslName,t.cipherKey,t.cipherIV),this._macSSLName=t.macInfo.sslName,this._macKey=t.macKey,this._macActualLen=t.macInfo.actualLen,this._macETM=t.macInfo.isETM,this._aadLen=this._macETM?4:0,this._dead=!1;let n=t.cipherInfo.discardLen;if(n){let i=ji.get(n);i===void 0&&(i=Buffer.alloc(n),ji.set(n,i)),this._cipherInstance.update(i)}}free(){this._dead=!0}allocPacket(e){let t=this._encBlockLen,n=4+1+e,i=t-(n-this._aadLen&t-1);i<4&&(i+=t),n+=i;let s=Buffer.allocUnsafe(n);return Gt(s,n-4,0),s[4]=i,Kr(s,5+e,i),s}encrypt(e){if(this._dead)return;let t;if(this._macETM){let i=new Uint8Array(e.buffer,e.byteOffset,4),s=this._cipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+4,e.length-4));this._onWrite(i),this._onWrite(s),t=fo(this._macSSLName,this._macKey),Gt(_n,this.outSeqno,0),t.update(_n),t.update(i),t.update(s)}else{let i=this._cipherInstance.update(e);this._onWrite(i),t=fo(this._macSSLName,this._macKey),Gt(_n,this.outSeqno,0),t.update(_n),t.update(e)}let n=t.digest();n.length>this._macActualLen&&(n=n.slice(0,this._macActualLen)),this._onWrite(n),this.outSeqno=this.outSeqno+1>>>0}},po=class{constructor(e){let t=e.outbound;this.outSeqno=t.seqno,this._onWrite=t.onWrite,this._encBlockLen=t.cipherInfo.blockLen,this._macLen=t.macInfo.len,this._macActualLen=t.macInfo.actualLen,this._aadLen=t.macInfo.isETM?4:0,this._instance=new Co(t.cipherInfo.sslName,t.cipherKey,t.cipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(e){let t=this._encBlockLen,n=4+1+e,i=t-(n-this._aadLen&t-1);i<4&&(i+=t),n+=i;let s=Buffer.allocUnsafe(n+this._macLen);return Gt(s,n-4,0),s[4]=i,Kr(s,5+e,i),s}encrypt(e){this._dead||(this._instance.encrypt(e,this.outSeqno),this._macActualLen<this._macLen&&(e=new Cr(e.buffer,e.byteOffset,e.length-(this._macLen-this._macActualLen))),this._onWrite(e),this.outSeqno=this.outSeqno+1>>>0)}},Eo=class{constructor(e,t){this.inSeqno=e,this._onPayload=t,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0}free(){}decrypt(e,t,n){for(;t<n;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,n-t);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len>$r||this._len<8||4+this._len&7)throw new Error("Bad packet length");if(t>=n)return}if(this._packetPos<this._len){let s=Math.min(this._len-this._packetPos,n-t),o;if(t!==0||s!==n?o=new Uint8Array(e.buffer,e.byteOffset+t,s):o=e,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),t+=s,this._packetPos+=s,this._packetPos<this._len)return}let i=this._packet?new Cr(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):nc;this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?t:s}}}},bo=class{constructor(e){let t=e.inbound;this.inSeqno=t.seqno,this._onPayload=t.onPayload,this._decKeyMain=t.decipherKey.slice(0,32),this._decKeyPktLen=t.decipherKey.slice(32),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._calcMac=Buffer.allocUnsafe(16),this._macPos=0}free(){}decrypt(e,t,n){for(;t<n;){if(this._lenPos<4){let f=Math.min(4-this._lenPos,n-t);for(;f--;)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;Mt[0]=0,Gt(Mt,this.inSeqno,12);let a=Yi("chacha20",this._decKeyPktLen,Mt).update(this._lenBuf);if(this._len=Gn(a,0),this._len>$r||this._len<8||this._len&7)throw new Error("Bad packet length")}if(this._pktLen<this._len){if(t>=n)return;let f=Math.min(this._len-this._pktLen,n-t),a;if(t!==0||f!==n?a=new Uint8Array(e.buffer,e.byteOffset+t,f):a=e,f===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._pktLen)),t+=f,this._pktLen+=f,this._pktLen<this._len||t>=n)return}{let f=Math.min(16-this._macPos,n-t);if(t!==0||f!==n?this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,f),this._macPos):this._mac.set(e,this._macPos),t+=f,this._macPos+=f,this._macPos<16)return}Mt[0]=0,Gt(Mt,this.inSeqno,12);let i=pn("chacha20",this._decKeyMain,Mt).update(ic);if(No(Yn,this._lenBuf,4,this._packet,this._packet.length,i),this._calcMac.set(new Uint8Array($n.HEAPU8.buffer,Yn,16),0),!ao(this._calcMac,this._mac))throw new Error("Invalid MAC");Mt[0]=1;let s=Yi("chacha20",this._decKeyMain,Mt).update(this._packet),o=new Cr(s.buffer,s.byteOffset+1,s.length-s[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let f=this._onPayload(o);if(f!==void 0)return f===!1?t:f}}}},yo=class{constructor(e){let t=e.inbound;this.inSeqno=t.seqno,this._onPayload=t.onPayload,this._instance=new ko(t.decipherKey),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._macPos=0}free(){this._instance.free()}decrypt(e,t,n){for(;t<n;){if(this._lenPos<4){let s=Math.min(4-this._lenPos,n-t);for(;s--;)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;if(this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno),this._len>$r||this._len<8||this._len&7)throw new Error("Bad packet length");if(t>=n)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,n-t),o;if(t!==0||s!==n?o=new Uint8Array(e.buffer,e.byteOffset+t,s):o=e,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),t+=s,this._pktLen+=s,this._pktLen<this._len||t>=n)return}{let s=Math.min(16-this._macPos,n-t);if(t!==0||s!==n?this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,s),this._macPos):this._mac.set(e,this._macPos),t+=s,this._macPos+=s,this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);let i=new Cr(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?t:s}}}},wo=class{constructor(e){let t=e.inbound;this.inSeqno=t.seqno,this._onPayload=t.onPayload,this._decipherInstance=null,this._decipherSSLName=t.decipherInfo.sslName,this._decipherKey=t.decipherKey,this._decipherIV=t.decipherIV,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(e,t,n){for(;t<n;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,n-t);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>$r||this._len<16||this._len&15)throw new Error("Bad packet length");this._decipherInstance=Yi(this._decipherSSLName,this._decipherKey,this._decipherIV),this._decipherInstance.setAutoPadding(!1),this._decipherInstance.setAAD(xd(this._len))}if(this._pktLen<this._len){if(t>=n)return;let s=Math.min(this._len-this._pktLen,n-t),o;if(t!==0||s!==n?o=this._decipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+t,s)):o=this._decipherInstance.update(e),o.length&&(s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),this._packetPos+=o.length),t+=s,this._pktLen+=s,this._pktLen<this._len||t>=n)return}{let s=Math.min(16-this._tagPos,n-t);if(t!==0||s!==n?this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,s),this._tagPos):this._tag.set(e,this._tagPos),t+=s,this._tagPos+=s,this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);let s=this._decipherInstance.final();s.length&&(this._packet?this._packet.set(s,this._packetPos):this._packet=s)}let i=this._packet?new Cr(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):nc;this.inSeqno=this.inSeqno+1>>>0,sc(this._decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?t:s}}}},xo=class{constructor(e){let t=e.inbound;this.inSeqno=t.seqno,this._onPayload=t.onPayload,this._instance=new Ro(t.decipherInfo.sslName,t.decipherKey,t.decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(e,t,n){for(;t<n;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,n-t);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>$r||this._len<16||this._len&15)throw new Error(`Bad packet length: ${this._len}`)}if(this._pktLen<this._len){if(t>=n)return;let s=Math.min(this._len-this._pktLen,n-t),o;if(t!==0||s!==n?o=new Uint8Array(e.buffer,e.byteOffset+t,s):o=e,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),t+=s,this._pktLen+=s,this._pktLen<this._len||t>=n)return}{let s=Math.min(16-this._tagPos,n-t);if(t!==0||s!==n?this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,s),this._tagPos):this._tag.set(e,this._tagPos),t+=s,this._tagPos+=s,this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);let i=new Cr(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?t:s}}}},So=class{constructor(e){let t=e.inbound;this.inSeqno=t.seqno,this._onPayload=t.onPayload,this._decipherInstance=Yi(t.decipherInfo.sslName,t.decipherKey,t.decipherIV),this._decipherInstance.setAutoPadding(!1),this._block=Buffer.allocUnsafe(t.macInfo.isETM?4:t.decipherInfo.blockLen),this._blockSize=t.decipherInfo.blockLen,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._mac=Buffer.allocUnsafe(t.macInfo.actualLen),this._macPos=0,this._macSSLName=t.macInfo.sslName,this._macKey=t.macKey,this._macActualLen=t.macInfo.actualLen,this._macETM=t.macInfo.isETM,this._macInstance=null;let n=t.decipherInfo.discardLen;if(n){let i=ji.get(n);i===void 0&&(i=Buffer.alloc(n),ji.set(n,i)),this._decipherInstance.update(i)}}free(){}decrypt(e,t,n){for(;t<n;){if(this._blockPos<this._block.length){let o=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||o!==n||o<e.length?this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,o),this._blockPos):this._block.set(e,this._blockPos),t+=o,this._blockPos+=o,this._blockPos<this._block.length)return;let f,a;if(this._macETM?this._len=a=Gn(this._block,0):(f=this._decipherInstance.update(this._block),this._len=Gn(f,0),a=4+this._len-this._blockSize),this._len>$r||this._len<5||a&this._blockSize-1)throw new Error("Bad packet length");if(this._macInstance=fo(this._macSSLName,this._macKey),Gt(_n,this.inSeqno,0),this._macInstance.update(_n),this._macETM?this._macInstance.update(this._block):(this._macInstance.update(new Uint8Array(f.buffer,f.byteOffset,4)),this._pktLen=f.length-4,this._packetPos=this._pktLen,this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(f.buffer,f.byteOffset+4,this._packetPos),0)),t>=n)return}if(this._pktLen<this._len){let o=Math.min(this._len-this._pktLen,n-t),f;t!==0||o!==n?f=new Uint8Array(e.buffer,e.byteOffset+t,o):f=e,this._macETM&&this._macInstance.update(f);let a=this._decipherInstance.update(f);if(a.length&&(o===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._packetPos)),this._packetPos+=a.length),t+=o,this._pktLen+=o,this._pktLen<this._len||t>=n)return}{let o=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||o!==n?this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,o),this._macPos):this._mac.set(e,this._macPos),t+=o,this._macPos+=o,this._macPos<this._macActualLen)return}this._macETM||this._macInstance.update(this._packet);let i=this._macInstance.digest();if(this._macActualLen<i.length&&(i=new Uint8Array(i.buffer,i.byteOffset,this._macActualLen)),!Sd(i,this._mac))throw new Error("Invalid MAC");let s=new Cr(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._macPos=0,this._macInstance=null;{let o=this._onPayload(s);if(o!==void 0)return o===!1?t:o}}}},Io=class{constructor(e){let t=e.inbound;this.inSeqno=t.seqno,this._onPayload=t.onPayload,this._instance=new vo(t.decipherInfo.sslName,t.decipherKey,t.decipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM,t.macInfo.actualLen),this._block=Buffer.allocUnsafe(t.macInfo.isETM||t.decipherInfo.stream?4:t.decipherInfo.blockLen),this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(t.macInfo.actualLen),this._macPos=0,this._macActualLen=t.macInfo.actualLen,this._macETM=t.macInfo.isETM}free(){this._instance.free()}decrypt(e,t,n){for(;t<n;){if(this._blockPos<this._block.length){let s=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||s!==n||s<e.length?this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,s),this._blockPos):this._block.set(e,this._blockPos),t+=s,this._blockPos+=s,this._blockPos<this._block.length)return;let o;if(this._macETM?this._len=o=Gn(this._block,0):(this._instance.decryptBlock(this._block),this._len=Gn(this._block,0),o=4+this._len-this._block.length),this._len>$r||this._len<5||o&this._block.length-1)throw new Error("Bad packet length");if(this._macETM||(this._pktLen=this._block.length-4,this._pktLen&&(this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0))),t>=n)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,n-t),o;if(t!==0||s!==n?o=new Uint8Array(e.buffer,e.byteOffset+t,s):o=e,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),t+=s,this._pktLen+=s,this._pktLen<this._len||t>=n)return}{let s=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||s!==n?this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,s),this._macPos):this._mac.set(e,this._macPos),t+=s,this._macPos+=s,this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);let i=new Cr(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._macPos=0,this._macInstance=null;{let s=this._onPayload(i);if(s!==void 0)return s===!1?t:s}}}};function sc(r){++r[11]>>>8&&++r[10]>>>8&&++r[9]>>>8&&++r[8]>>>8&&++r[7]>>>8&&++r[6]>>>8&&++r[5]>>>8&&++r[4]>>>8}var xd=(()=>{let r=Buffer.alloc(4);return e=>(r[0]=e>>>24,r[1]=e>>>16,r[2]=e>>>8,r[3]=e,r)})();function Sd(r,e){return r.length!==e.length?(ao(r,r),!1):ao(r,e)}function Id(r){if(typeof r!="object"||r===null)throw new Error("Invalid config");if(typeof r.outbound!="object"||r.outbound===null)throw new Error("Invalid outbound");let e=r.outbound;if(typeof e.onWrite!="function")throw new Error("Invalid outbound.onWrite");if(typeof e.cipherInfo!="object"||e.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(e.cipherKey)||e.cipherKey.length!==e.cipherInfo.keyLen)throw new Error("Invalid outbound.cipherKey");if(e.cipherInfo.ivLen&&(!Buffer.isBuffer(e.cipherIV)||e.cipherIV.length!==e.cipherInfo.ivLen))throw new Error("Invalid outbound.cipherIV");if(typeof e.seqno!="number"||e.seqno<0||e.seqno>rc)throw new Error("Invalid outbound.seqno");let t=!!e.forceNative;switch(e.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return mo&&!t?new Ao(r):new go(r);case"chacha20":return Bo&&!t?new lo(r):new ho(r);default:{if(typeof e.macInfo!="object"||e.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(e.macKey)||e.macKey.length!==e.macInfo.len)throw new Error("Invalid outbound.macKey");return Co&&!t?new po(r):new _o(r)}}}function md(r){if(typeof r!="object"||r===null)throw new Error("Invalid config");if(typeof r.inbound!="object"||r.inbound===null)throw new Error("Invalid inbound");let e=r.inbound;if(typeof e.onPayload!="function")throw new Error("Invalid inbound.onPayload");if(typeof e.decipherInfo!="object"||e.decipherInfo===null)throw new Error("Invalid inbound.decipherInfo");if(!Buffer.isBuffer(e.decipherKey)||e.decipherKey.length!==e.decipherInfo.keyLen)throw new Error("Invalid inbound.decipherKey");if(e.decipherInfo.ivLen&&(!Buffer.isBuffer(e.decipherIV)||e.decipherIV.length!==e.decipherInfo.ivLen))throw new Error("Invalid inbound.decipherIV");if(typeof e.seqno!="number"||e.seqno<0||e.seqno>rc)throw new Error("Invalid inbound.seqno");let t=!!e.forceNative;switch(e.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return Ro&&!t?new xo(r):new wo(r);case"chacha20":return ko&&!t?new yo(r):new bo(r);default:{if(typeof e.macInfo!="object"||e.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(e.macKey)||e.macKey.length!==e.macInfo.len)throw new Error("Invalid inbound.macKey");return vo&&!t?new Io(r):new So(r)}}}oc.exports={CIPHER_INFO:yd,MAC_INFO:wd,bindingAvailable:!!co,init:(()=>new Promise(async(r,e)=>{try{$n=await tc()(),Yn=$n._malloc(16),No=$n.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(t){return e(t)}r()}))(),NullCipher:uo,createCipher:Id,NullDecipher:Eo,createDecipher:md}});var kr=_e((Eb,_c)=>{"use strict";var{createDecipheriv:Lo,createECDH:Bd,createHash:Xn,createHmac:Cd,createSign:Rd,createVerify:kd,getCiphers:vd,sign:fc,verify:ac}=require("crypto"),Nd=vd(),{Ber:Be}=qn(),Td=to().pbkdf,{CIPHER_INFO:Vn}=Br(),{eddsaSupported:Oo,SUPPORTED_CIPHER:Ld}=pr(),{bufferSlice:Gr,makeBufferParser:Od,readString:Ie,readUInt32BE:jn,writeUInt32BE:Rt}=rr(),Er=Symbol("Hash Algorithm"),nr=Symbol("Private key PEM"),ar=Symbol("Public key PEM"),Rr=Symbol("Public key SSH"),En=Symbol("Decrypted Key"),To=Object.create(null);{let r=Object.keys(Vn);for(let e=0;e<r.length;++e){let t=Vn[r[e]].sslName;!t||To[t]||(To[t]=Vn[r[e]])}}var Xi=Od();function ir(r,e){e=e.base64Slice(0,e.length);let t=e.replace(/.{64}/g,`$&
`);return e.length&63&&(t+=`
`),`-----BEGIN ${r} KEY-----
${t}-----END ${r} KEY-----`}function zn(r,e){let t=Buffer.allocUnsafe(r.length+e.length);return t.set(r,0),t.set(e,r.length),t}function Uo(r,e){let t=r.length,n=r._pos||0;for(let i=0;i<e;++i){let s=t-n;if(n>=t||s<4)return!1;let o=jn(r,n);if(s<4+o)return!1;n+=4+o}return r._pos=n,!0}function Jn(r,e){let t=new Be.Writer;return t.startSequence(),t.startSequence(),t.writeOID("1.2.840.113549.1.1.1"),t.writeNull(),t.endSequence(),t.startSequence(Be.BitString),t.writeByte(0),t.startSequence(),t.writeBuffer(r,Be.Integer),t.writeBuffer(e,Be.Integer),t.endSequence(),t.endSequence(),t.endSequence(),ir("PUBLIC",t.buffer)}function Zn(r,e){let t=Buffer.allocUnsafe(15+e.length+4+r.length);Rt(t,7,0),t.utf8Write("ssh-rsa",4,7);let n=4+7;return Rt(t,e.length,n),t.set(e,n+=4),Rt(t,r.length,n+=e.length),t.set(r,n+4),t}var cc=(()=>{function r(n,i,s,o,f,a,c,h){let l=new Be.Writer;return l.startSequence(),l.writeInt(0,Be.Integer),l.writeBuffer(n,Be.Integer),l.writeBuffer(i,Be.Integer),l.writeBuffer(s,Be.Integer),l.writeBuffer(o,Be.Integer),l.writeBuffer(f,Be.Integer),l.writeBuffer(a,Be.Integer),l.writeBuffer(c,Be.Integer),l.writeBuffer(h,Be.Integer),l.endSequence(),l.buffer}function e(n){return BigInt(`0x${n.hexSlice(0,n.length)}`)}function t(n){let i=n.toString(16);if(i.length&1)i=`0${i}`;else{let s=i.charCodeAt(0);(s===56||s===57||s>=97&&s<=102)&&(i=`00${i}`)}return Buffer.from(i,"hex")}return function(i,s,o,f,a,c){let h=e(o),l=t(h%(e(a)-1n)),g=t(h%(e(c)-1n));return ir("RSA PRIVATE",r(i,s,o,a,c,l,g,f))}})();function ei(r,e,t,n){let i=new Be.Writer;return i.startSequence(),i.startSequence(),i.writeOID("1.2.840.10040.4.1"),i.startSequence(),i.writeBuffer(r,Be.Integer),i.writeBuffer(e,Be.Integer),i.writeBuffer(t,Be.Integer),i.endSequence(),i.endSequence(),i.startSequence(Be.BitString),i.writeByte(0),i.writeBuffer(n,Be.Integer),i.endSequence(),i.endSequence(),ir("PUBLIC",i.buffer)}function ti(r,e,t,n){let i=Buffer.allocUnsafe(15+r.length+4+e.length+4+t.length+4+n.length);Rt(i,7,0),i.utf8Write("ssh-dss",4,7);let s=4+7;return Rt(i,r.length,s),i.set(r,s+=4),Rt(i,e.length,s+=r.length),i.set(e,s+=4),Rt(i,t.length,s+=e.length),i.set(t,s+=4),Rt(i,n.length,s+=t.length),i.set(n,s+4),i}function uc(r,e,t,n,i){let s=new Be.Writer;return s.startSequence(),s.writeInt(0,Be.Integer),s.writeBuffer(r,Be.Integer),s.writeBuffer(e,Be.Integer),s.writeBuffer(t,Be.Integer),s.writeBuffer(n,Be.Integer),s.writeBuffer(i,Be.Integer),s.endSequence(),ir("DSA PRIVATE",s.buffer)}function hc(r){let e=new Be.Writer;return e.startSequence(),e.startSequence(),e.writeOID("1.3.101.112"),e.endSequence(),e.startSequence(Be.BitString),e.writeByte(0),e._ensure(r.length),e._buf.set(r,e._offset),e._offset+=r.length,e.endSequence(),e.endSequence(),ir("PUBLIC",e.buffer)}function lc(r){let e=Buffer.allocUnsafe(19+r.length);return Rt(e,11,0),e.utf8Write("ssh-ed25519",4,11),Rt(e,r.length,15),e.set(r,19),e}function Ud(r){let e=new Be.Writer;return e.startSequence(),e.writeInt(0,Be.Integer),e.startSequence(),e.writeOID("1.3.101.112"),e.endSequence(),e.startSequence(Be.OctetString),e.writeBuffer(r,Be.OctetString),e.endSequence(),e.endSequence(),ir("PRIVATE",e.buffer)}function Po(r,e){let t=new Be.Writer;return t.startSequence(),t.startSequence(),t.writeOID("1.2.840.10045.2.1"),t.writeOID(r),t.endSequence(),t.startSequence(Be.BitString),t.writeByte(0),t._ensure(e.length),t._buf.set(e,t._offset),t._offset+=e.length,t.endSequence(),t.endSequence(),ir("PUBLIC",t.buffer)}function Do(r,e){let t;switch(r){case"1.2.840.10045.3.1.7":t="nistp256";break;case"1.3.132.0.34":t="nistp384";break;case"1.3.132.0.35":t="nistp521";break;default:return}let n=Buffer.allocUnsafe(4+19+4+8+4+e.length);return Rt(n,19,0),n.utf8Write(`ecdsa-sha2-${t}`,4,19),Rt(n,8,23),n.utf8Write(t,27,8),Rt(n,e.length,35),n.set(e,39),n}function Pd(r,e,t){let n=new Be.Writer;return n.startSequence(),n.writeInt(1,Be.Integer),n.writeBuffer(t,Be.OctetString),n.startSequence(160),n.writeOID(r),n.endSequence(),n.startSequence(161),n.startSequence(Be.BitString),n.writeByte(0),n._ensure(e.length),n._buf.set(e,n._offset),n._offset+=e.length,n.endSequence(),n.endSequence(),n.endSequence(),ir("EC PRIVATE",n.buffer)}function Dd(r,e){let t=Bd(r);return t.setPrivateKey(e),t.getPublicKey()}var ri={sign:(()=>typeof fc=="function"?function(e,t){let n=this[nr];if(n===null)return new Error("No private key available");(!t||typeof t!="string")&&(t=this[Er]);try{return fc(t,e,n)}catch(i){return i}}:function(e,t){let n=this[nr];if(n===null)return new Error("No private key available");(!t||typeof t!="string")&&(t=this[Er]);let i=Rd(t);i.update(e);try{return i.sign(n)}catch(s){return s}})(),verify:(()=>typeof ac=="function"?function(e,t,n){let i=this[ar];if(i===null)return new Error("No public key available");(!n||typeof n!="string")&&(n=this[Er]);try{return ac(n,e,i,t)}catch(s){return s}}:function(e,t,n){let i=this[ar];if(i===null)return new Error("No public key available");(!n||typeof n!="string")&&(n=this[Er]);let s=kd(n);s.update(e);try{return s.verify(i,t)}catch(o){return o}})(),isPrivateKey:function(){return this[nr]!==null},getPrivatePEM:function(){return this[nr]},getPublicPEM:function(){return this[ar]},getPublicSSH:function(){return this[Rr]},equals:function(e){let t=Ac(e);return t instanceof Error?!1:this.type===t.type&&this[nr]===t[nr]&&this[ar]===t[ar]&&this[Rr]===t[Rr]}};function Vi(r,e,t,n,i,s,o){this.type=r,this.comment=e,this[nr]=t,this[ar]=n,this[Rr]=i,this[Er]=s,this[En]=o}Vi.prototype=ri;{let e=function(t,n,i){let s=[];if(t.length<8)return new Error("Malformed OpenSSH private key");let o=jn(t,0),f=jn(t,4);if(o!==f)return i?new Error("OpenSSH key integrity check failed -- bad passphrase?"):new Error("OpenSSH key integrity check failed");t._pos=8;let a,c;for(a=0;a<n;++a){let l,g,p,y,b=Ie(t,t._pos,!0);if(b===void 0)return new Error("Malformed OpenSSH private key");switch(b){case"ssh-rsa":{let m=Ie(t,t._pos);if(m===void 0)return new Error("Malformed OpenSSH private key");let L=Ie(t,t._pos);if(L===void 0)return new Error("Malformed OpenSSH private key");let W=Ie(t,t._pos);if(W===void 0)return new Error("Malformed OpenSSH private key");let N=Ie(t,t._pos);if(N===void 0)return new Error("Malformed OpenSSH private key");let K=Ie(t,t._pos);if(K===void 0)return new Error("Malformed OpenSSH private key");let q=Ie(t,t._pos);if(q===void 0)return new Error("Malformed OpenSSH private key");p=Jn(m,L),y=Zn(m,L),g=cc(m,L,W,N,K,q),l="sha1";break}case"ssh-dss":{let m=Ie(t,t._pos);if(m===void 0)return new Error("Malformed OpenSSH private key");let L=Ie(t,t._pos);if(L===void 0)return new Error("Malformed OpenSSH private key");let W=Ie(t,t._pos);if(W===void 0)return new Error("Malformed OpenSSH private key");let N=Ie(t,t._pos);if(N===void 0)return new Error("Malformed OpenSSH private key");let K=Ie(t,t._pos);if(K===void 0)return new Error("Malformed OpenSSH private key");p=ei(m,L,W,N),y=ti(m,L,W,N),g=uc(m,L,W,N,K),l="sha1";break}case"ssh-ed25519":{if(!Oo)return new Error(`Unsupported OpenSSH private key type: ${b}`);let m=Ie(t,t._pos);if(m===void 0||m.length!==32)return new Error("Malformed OpenSSH private key");let L=Ie(t,t._pos);if(L===void 0||L.length!==64)return new Error("Malformed OpenSSH private key");p=hc(m),y=lc(m),g=Ud(Gr(L,0,32)),l=null;break}case"ecdsa-sha2-nistp256":l="sha256",c="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":l===void 0&&(l="sha384",c="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(l===void 0&&(l="sha512",c="1.3.132.0.35"),!Uo(t,1))return new Error("Malformed OpenSSH private key");let m=Ie(t,t._pos);if(m===void 0)return new Error("Malformed OpenSSH private key");let L=Ie(t,t._pos);if(L===void 0)return new Error("Malformed OpenSSH private key");p=Po(c,m),y=Do(c,m),g=Pd(c,m,L);break}default:return new Error(`Unsupported OpenSSH private key type: ${b}`)}let x=Ie(t,t._pos,!0);if(x===void 0)return new Error("Malformed OpenSSH private key");s.push(new Vi(b,x,g,p,y,l,i))}let h=0;for(a=t._pos;a<t.length;++a)if(t[a]!==++h%255)return new Error("Malformed OpenSSH private key");return s},r=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;Vi.parse=(t,n)=>{let i=r.exec(t);if(i===null)return null;let s,o=Buffer.from(i[1],"base64");if(o.length<31)return new Error("Malformed OpenSSH private key");let f=o.utf8Slice(0,15);if(f!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${f}`);let a=Ie(o,15,!0);if(a===void 0)return new Error("Malformed OpenSSH private key");if(a!=="none"&&Ld.indexOf(a)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${a}`);let c=Ie(o,o._pos,!0);if(c===void 0)return new Error("Malformed OpenSSH private key");if(c!=="none"){if(a==="none")return new Error("Malformed OpenSSH private key");if(c!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${c}`);if(!n)return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}else if(a!=="none")return new Error("Malformed OpenSSH private key");let h,l,g;a!=="none"&&(h=Vn[a]);let p=Ie(o,o._pos);if(p===void 0)return new Error("Malformed OpenSSH private key");if(p.length)switch(c){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":{let b=Ie(p,0);if(b===void 0||p._pos+4>p.length)return new Error("Malformed OpenSSH private key");let x=jn(p,p._pos),m=Buffer.allocUnsafe(h.keyLen+h.ivLen);if(Td(n,n.length,b,b.length,m,m.length,x)!==0)return new Error("Failed to generate information to decrypt key");l=Gr(m,0,h.keyLen),g=Gr(m,h.keyLen,m.length);break}}else if(c!=="none")return new Error("Malformed OpenSSH private key");if(o._pos+3>=o.length)return new Error("Malformed OpenSSH private key");let y=jn(o,o._pos);if(o._pos+=4,y>0){for(let x=0;x<y;++x){let m=Ie(o,o._pos);if(m===void 0)return new Error("Malformed OpenSSH private key");if(Ie(m,0,!0)===void 0)return new Error("Malformed OpenSSH private key")}let b=Ie(o,o._pos);if(b===void 0)return new Error("Malformed OpenSSH private key");if(l!==void 0){if(b.length<h.blockLen||b.length%h.blockLen!==0)return new Error("Malformed OpenSSH private key");try{let x={authTagLength:h.authLen},m=Lo(h.sslName,l,g,x);if(m.setAutoPadding(!1),h.authLen>0){if(o.length-o._pos<h.authLen)return new Error("Malformed OpenSSH private key");m.setAuthTag(Gr(o,o._pos,o._pos+=h.authLen))}b=zn(m.update(b),m.final())}catch(x){return x}}if(o._pos!==o.length)return new Error("Malformed OpenSSH private key");s=e(b,y,l!==void 0)}else s=[];return s instanceof Error?s:s[0]}}function zi(r,e,t,n,i,s,o){this.type=r,this.comment=e,this[nr]=t,this[ar]=n,this[Rr]=i,this[Er]=s,this[En]=o}zi.prototype=ri;{let r=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;zi.parse=(e,t)=>{let n=r.exec(e);if(n===null)return null;let i=Buffer.from(n[3],"base64"),s=n[2],o=!1;if(s!==void 0){s=s.split(/\r\n|\n/g);for(let y=0;y<s.length;++y){let b=s[y],x=b.indexOf(":");if(b.slice(0,x)==="DEK-Info"){let m=b.slice(x+2);if(x=m.indexOf(","),x===-1)continue;let L=m.slice(0,x).toLowerCase();if(Nd.indexOf(L)===-1)return new Error(`Cipher (${L}) not supported for encrypted OpenSSH private key`);let W=To[L];if(!W)return new Error(`Cipher (${L}) not supported for encrypted OpenSSH private key`);let N=Buffer.from(m.slice(x+1),"hex");if(N.length!==W.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!t)return new Error("Encrypted OpenSSH private key detected, but no passphrase given");let K=Gr(N,0,8),q=Xn("md5").update(t).update(K).digest();for(;q.length<W.keyLen;)q=zn(q,Xn("md5").update(q).update(t).update(K).digest());q.length>W.keyLen&&(q=Gr(q,0,W.keyLen));try{let X=Lo(L,q,N);X.setAutoPadding(!1),i=zn(X.update(i),X.final()),o=!0}catch(X){return X}}}}let f,a,c,h,l,g,p="Malformed OpenSSH private key";switch(o&&(p+=". Bad passphrase?"),n[1]){case"RSA":f="ssh-rsa",a=ir("RSA PRIVATE",i);try{g=new Be.Reader(i),g.readSequence(),g.readInt();let y=g.readString(Be.Integer,!0);if(y===null)return new Error(p);let b=g.readString(Be.Integer,!0);if(b===null)return new Error(p);c=Jn(y,b),h=Zn(y,b)}catch{return new Error(p)}l="sha1";break;case"DSA":f="ssh-dss",a=ir("DSA PRIVATE",i);try{g=new Be.Reader(i),g.readSequence(),g.readInt();let y=g.readString(Be.Integer,!0);if(y===null)return new Error(p);let b=g.readString(Be.Integer,!0);if(b===null)return new Error(p);let x=g.readString(Be.Integer,!0);if(x===null)return new Error(p);let m=g.readString(Be.Integer,!0);if(m===null)return new Error(p);c=ei(y,b,x,m),h=ti(y,b,x,m)}catch{return new Error(p)}l="sha1";break;case"EC":{let y,b,x;try{g=new Be.Reader(i),g.readSequence(),g.readInt(),b=g.readString(Be.OctetString,!0),g.readByte();let L=g.readLength();if(L!==null){if(g._offset=L,x=g.readOID(),x===null)return new Error(p);switch(x){case"1.2.840.10045.3.1.7":y="prime256v1",f="ecdsa-sha2-nistp256",l="sha256";break;case"1.3.132.0.34":y="secp384r1",f="ecdsa-sha2-nistp384",l="sha384";break;case"1.3.132.0.35":y="secp521r1",f="ecdsa-sha2-nistp521",l="sha512";break;default:return new Error(`Unsupported private key EC OID: ${x}`)}}else return new Error(p)}catch{return new Error(p)}a=ir("EC PRIVATE",i);let m=Dd(y,b);c=Po(x,m),h=Do(x,m);break}}return new zi(f,"",a,c,h,l,o)}}function Ji(r,e,t,n,i,s,o){this.type=r,this.comment=e,this[nr]=t,this[ar]=n,this[Rr]=i,this[Er]=s,this[En]=o}Ji.prototype=ri;{let r=Buffer.alloc(0),e=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t=Buffer.from([0,0,0,0]),n=Buffer.from([0,0,0,1]),i=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;Ji.parse=(s,o)=>{let f=i.exec(s);if(f===null)return null;let a=f[2],c=a!=="none";if(c&&!o)return new Error("Encrypted PPK private key detected, but no passphrase given");let h=Buffer.from(f[5],"base64");if(c){let O=Vn[a],F=zn(Xn("sha1").update(t).update(o).digest(),Xn("sha1").update(n).update(o).digest());F.length>O.keyLen&&(F=Gr(F,0,O.keyLen));try{let H=Lo(O.sslName,F,e);H.setAutoPadding(!1),h=zn(H.update(h),H.final())}catch(H){return H}}let l=f[1],g=f[3],p=Buffer.from(f[4],"base64"),y=f[6],b=l.length,x=a.length,m=Buffer.byteLength(g),L=p.length,W=h.length,N=Buffer.allocUnsafe(4+b+4+x+4+m+4+L+4+W),K=0;if(Rt(N,b,K),N.utf8Write(l,K+=4,b),Rt(N,x,K+=b),N.utf8Write(a,K+=4,x),Rt(N,m,K+=x),N.utf8Write(g,K+=4,m),Rt(N,L,K+=m),N.set(p,K+=4),Rt(N,W,K+=L),N.set(h,K+4),o||(o=r),Cd("sha1",Xn("sha1").update("putty-private-key-file-mac-key").update(o).digest()).update(N).digest("hex")!==y)return c?new Error("PPK private key integrity check failed -- bad passphrase?"):new Error("PPK private key integrity check failed");let X,S,I;switch(p._pos=0,Uo(p,1),l){case"ssh-rsa":{let O=Ie(p,p._pos);if(O===void 0)return new Error("Malformed PPK public key");let F=Ie(p,p._pos);if(F===void 0)return new Error("Malformed PPK public key");let H=Ie(h,0);if(H===void 0)return new Error("Malformed PPK private key");let ne=Ie(h,h._pos);if(ne===void 0)return new Error("Malformed PPK private key");let ee=Ie(h,h._pos);if(ee===void 0)return new Error("Malformed PPK private key");let J=Ie(h,h._pos);if(J===void 0)return new Error("Malformed PPK private key");X=Jn(F,O),S=Zn(F,O),I=cc(F,O,H,J,ne,ee);break}case"ssh-dss":{let O=Ie(p,p._pos);if(O===void 0)return new Error("Malformed PPK public key");let F=Ie(p,p._pos);if(F===void 0)return new Error("Malformed PPK public key");let H=Ie(p,p._pos);if(H===void 0)return new Error("Malformed PPK public key");let ne=Ie(p,p._pos);if(ne===void 0)return new Error("Malformed PPK public key");let ee=Ie(h,0);if(ee===void 0)return new Error("Malformed PPK private key");X=ei(O,F,H,ne),S=ti(O,F,H,ne),I=uc(O,F,H,ne,ee);break}}return new Ji(l,g,I,X,S,"sha1",c)}}function es(r,e,t,n,i){this.type=r,this.comment=e,this[nr]=null,this[ar]=t,this[Rr]=n,this[Er]=i,this[En]=!1}es.prototype=ri;{let r;Oo?r=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/:r=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/,es.parse=e=>{let t=r.exec(e);if(t===null)return null;let n=t[1],i=t[2],s=Buffer.from(t[3],"base64"),o=t[4]||"",f=Ie(s,s._pos,!0);return f===void 0||f.indexOf(i)!==0?new Error("Malformed OpenSSH public key"):Ho(s,i,o,n)}}function Zi(r,e,t,n,i){this.type=r,this.comment=e,this[nr]=null,this[ar]=t,this[Rr]=n,this[Er]=i,this[En]=!1}Zi.prototype=ri;{let r=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/,e=/^[A-Z0-9a-z/+=\r\n]+$/,t=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm,n=/\\\r?\n/g;Zi.parse=i=>{let s=r.exec(i);if(s===null)return null;let o=s[1],f=0,a="";for(;s=t.exec(o);){let p=s[1],y=s[2].replace(n,"");if(y.length>1024)return t.lastIndex=0,new Error("Malformed RFC4716 public key");f=t.lastIndex,p.toLowerCase()==="comment"&&(a=y,a.length>1&&a.charCodeAt(0)===34&&a.charCodeAt(a.length-1)===34&&(a=a.slice(1,-1)))}let c=o.slice(f);if(!e.test(c))return new Error("Malformed RFC4716 public key");c=Buffer.from(c,"base64");let h=Ie(c,0,!0);if(h===void 0)return new Error("Malformed RFC4716 public key");let l=null,g=null;switch(h){case"ssh-rsa":{let p=Ie(c,c._pos);if(p===void 0)return new Error("Malformed RFC4716 public key");let y=Ie(c,c._pos);if(y===void 0)return new Error("Malformed RFC4716 public key");l=Jn(y,p),g=Zn(y,p);break}case"ssh-dss":{let p=Ie(c,c._pos);if(p===void 0)return new Error("Malformed RFC4716 public key");let y=Ie(c,c._pos);if(y===void 0)return new Error("Malformed RFC4716 public key");let b=Ie(c,c._pos);if(b===void 0)return new Error("Malformed RFC4716 public key");let x=Ie(c,c._pos);if(x===void 0)return new Error("Malformed RFC4716 public key");l=ei(p,y,b,x),g=ti(p,y,b,x);break}default:return new Error("Malformed RFC4716 public key")}return new Zi(h,a,l,g,"sha1")}}function Ho(r,e,t,n){if(!dc(e))return new Error(`Unsupported OpenSSH public key type: ${e}`);let i,s,o=null,f=null;switch(e){case"ssh-rsa":{let a=Ie(r,r._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let c=Ie(r,r._pos);if(c===void 0)return new Error("Malformed OpenSSH public key");o=Jn(c,a),f=Zn(c,a),i="sha1";break}case"ssh-dss":{let a=Ie(r,r._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let c=Ie(r,r._pos);if(c===void 0)return new Error("Malformed OpenSSH public key");let h=Ie(r,r._pos);if(h===void 0)return new Error("Malformed OpenSSH public key");let l=Ie(r,r._pos);if(l===void 0)return new Error("Malformed OpenSSH public key");o=ei(a,c,h,l),f=ti(a,c,h,l),i="sha1";break}case"ssh-ed25519":{let a=Ie(r,r._pos||0);if(a===void 0||a.length!==32)return new Error("Malformed OpenSSH public key");o=hc(a),f=lc(a),i=null;break}case"ecdsa-sha2-nistp256":i="sha256",s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":i===void 0&&(i="sha384",s="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(i===void 0&&(i="sha512",s="1.3.132.0.35"),!Uo(r,1))return new Error("Malformed OpenSSH public key");let a=Ie(r,r._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");o=Po(s,a),f=Do(s,a);break}default:return new Error(`Unsupported OpenSSH public key type: ${e}`)}return new es(n,t,o,f,i)}function dc(r){switch(r){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return!0;case"ssh-ed25519":if(Oo)return!0;default:return!1}}function gc(r){return r?typeof r[En]=="boolean":!1}function Ac(r,e){if(gc(r))return r;let t;if(Buffer.isBuffer(r))t=r,r=r.utf8Slice(0,r.length).trim();else if(typeof r=="string")r=r.trim();else return new Error("Key data must be a Buffer or string");if(e!=null){if(typeof e=="string")e=Buffer.from(e);else if(!Buffer.isBuffer(e))return new Error("Passphrase must be a string or Buffer when supplied")}let n;if((n=Vi.parse(r,e))!==null||(n=zi.parse(r,e))!==null||(n=Ji.parse(r,e))!==null||(n=es.parse(r))!==null||(n=Zi.parse(r))!==null)return n;if(t){Xi.init(t,0);let i=Xi.readString(!0);i!==void 0&&(r=Xi.readRaw(),r!==void 0&&(n=Ho(r,i,"",i),n instanceof Error&&(n=null))),Xi.clear()}return n||new Error("Unsupported key format")}_c.exports={isParsedKey:gc,isSupportedKeyType:dc,parseDERKey:(r,e)=>Ho(r,e,"",e),parseKey:Ac}});var Ko=_e((xb,Bc)=>{"use strict";var{Socket:yc}=require("net"),{Duplex:wc}=require("stream"),{resolve:Hd}=require("path"),{readFile:pc}=require("fs"),{execFile:Qd,spawn:Md}=require("child_process"),{isParsedKey:Ec,parseKey:ni}=kr(),{makeBufferParser:Fd,readUInt32BE:Wo,writeUInt32BE:Ft,writeUInt32LE:bc}=rr();function ii(r){let e=!1;return(...t)=>{e||(e=!0,r(...t))}}function qd(r,e){let t=Buffer.allocUnsafe(r.length+e.length);return r.copy(t,0),e.copy(t,r.length),t}function Mo(){}var Wd=Buffer.alloc(0),dt=Fd(),si=class{getIdentities(e){e(new Error("Missing getIdentities() implementation"))}sign(e,t,n,i){typeof n=="function"&&(i=n),i(new Error("Missing sign() implementation"))}},yn=class extends si{constructor(e){super(),this.socketPath=e}getStream(e){e=ii(e);let t=new yc;t.on("connect",()=>{e(null,t)}),t.on("close",n).on("end",n).on("error",n),t.connect(this.socketPath);function n(){try{t.destroy()}catch{}e(new Error("Failed to connect to agent"))}}getIdentities(e){e=ii(e),this.getStream((t,n)=>{function i(o){if(n)try{n.destroy()}catch{}o||(o=new Error("Failed to retrieve identities from agent")),e(o)}if(t)return i(t);let s=new Fo(!0);s.on("error",i),s.pipe(n).pipe(s),n.on("close",i).on("end",i).on("error",i),s.getIdentities((o,f)=>{if(o)return i(o);try{n.destroy()}catch{}e(null,f)})})}sign(e,t,n,i){typeof n=="function"?(i=n,n=void 0):(typeof n!="object"||n===null)&&(n=void 0),i=ii(i),this.getStream((s,o)=>{function f(c){if(o)try{o.destroy()}catch{}c||(c=new Error("Failed to sign data with agent")),i(c)}if(s)return f(s);let a=new Fo(!0);a.on("error",f),a.pipe(o).pipe(a),o.on("close",f).on("end",f).on("error",f),a.sign(e,t,n,(c,h)=>{if(c)return f(c);try{o.destroy()}catch{}i(null,h)})})}},xc=(()=>{let o=Hd(__dirname,"..","util/pagent.exe"),f={10:new Error("Invalid pagent.exe arguments"),11:new Error("Pageant is not running"),12:new Error("pagent.exe could not create an mmap"),13:new Error("pagent.exe could not set mode for stdin"),14:new Error("pagent.exe could not set mode for stdout"),15:new Error("pagent.exe did not get expected input payload")};function a(h){h.buffer=null,h.proc&&(h.proc.kill(),h.proc=void 0)}class c extends wc{constructor(){super(),this.proc=void 0,this.buffer=null}_read(l){}_write(l,g,p){if(this.buffer===null)this.buffer=l;else{let m=Buffer.allocUnsafe(this.buffer.length+l.length);this.buffer.copy(m,0),l.copy(m,this.buffer.length),this.buffer=m}if(this.buffer.length<4)return p();let y=Wo(this.buffer,0);if(this.buffer.length-4<y)return p();if(l=this.buffer.slice(0,4+y),this.buffer.length>4+y)return p(new Error("Unexpected multiple agent requests"));this.buffer=null;let b,x=this.proc=Md(o,[l.length]);x.stdout.on("data",m=>{this.push(m)}),x.on("error",m=>{b=m,p(b)}),x.on("close",m=>{if(this.proc=void 0,!b){if(b=f[m])return p(b);p()}}),x.stdin.end(l)}_final(l){a(this),l()}_destroy(l,g){a(this),g()}}return class extends yn{getStream(l){l(null,new c)}}})(),Sc=(()=>{let r=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class extends yn{getStream(t){t=ii(t);let n=this.socketPath,i=!1;pc(n,function s(o,f){if(o){if(i)return t(new Error("Invalid cygwin unix socket path"));Qd("cygpath",["-w",n],(q,X,S)=>{if(q||X.length===0)return t(new Error("Invalid cygwin unix socket path"));i=!0,n=X.toString().replace(/[\r\n]/g,""),pc(n,s)});return}let a=r.exec(f.toString("ascii"));if(!a)return t(new Error("Malformed cygwin unix socket file"));let c,h=0,l=!1,g=[],p,y=Buffer.alloc(12),b=parseInt(a[1],10),x=a[2].replace(/-/g,""),m=Buffer.allocUnsafe(16);for(let q=0,X=0;X<32;++q,X+=2)m[q]=parseInt(x.substring(X,X+2),16);for(let q=0;q<16;q+=4)bc(m,Wo(m,q),q);K();function L(){h=0,c="secret",p.write(m)}function W(q){if(h+=q.length,c==="secret"){h===16&&(h=0,c="creds",p.write(y));return}if(c==="creds"&&(l||g.push(q),h===12)){if(p.removeListener("connect",L),p.removeListener("data",W),p.removeListener("error",N),p.removeListener("end",N),p.removeListener("close",N),l)return t(null,p);l=!0,y=Buffer.concat(g),bc(y,process.pid,0),p.on("error",()=>{}),p.destroy(),K()}}function N(){t(new Error("Problem negotiating cygwin unix socket security"))}function K(){p=new yc,p.on("connect",L),p.on("data",W),p.on("error",N),p.on("end",N),p.on("close",N),p.connect(b)}})}}})(),Kd=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function Ic(r){return process.platform==="win32"&&!Kd.test(r)?r==="pageant"?new xc:new Sc(r):new yn(r)}var Fo=(()=>{function c(S){let I;for(;S[L].length;){let O=S[L][0][l];if(O===void 0)break;S[L].shift(),I=S.push(O)}return I}let h=Symbol("Inbound Request Type"),l=Symbol("Inbound Request Response"),g=Symbol("Inbound Request Context");class p{constructor(I,O){this[h]=I,this[l]=void 0,this[g]=O}hasResponded(){return this[l]!==void 0}getType(){return this[h]}getContext(){return this[g]}}function y(S,I,O){return I[l]=O,c(S)}function b(S){if(S[N]=null,S[W]===0){let I=S[L];if(I&&I.length){S[L]=[];for(let O of I)O.cb(new Error("No reply from server"))}}try{S.end()}catch{}setImmediate(()=>{S[X]||S.emit("end"),S[q]||S.emit("close")})}function x(){this[q]=!0}function m(){this[X]=!0}let L=Symbol("Requests"),W=Symbol("Agent Protocol Role"),N=Symbol("Agent Protocol Buffer"),K=Symbol("Agent Protocol Current Message Length"),q=Symbol("Agent Protocol Closed"),X=Symbol("Agent Protocol Ended");return class extends wc{constructor(I){super({autoDestroy:!0,emitClose:!1}),this[W]=I?0:1,this[L]=[],this[N]=null,this[K]=-1,this.once("end",m),this.once("close",x)}_read(I){}_write(I,O,F){this[N]===null?this[N]=I:this[N]=qd(this[N],I);let H=this[N],ne=H.length,ee=0;for(;ee<ne&&!(ne<5||(this[K]===-1&&(this[K]=Wo(H,ee)),ne<4+this[K]));){let J=H[ee+=4];if(++ee,this[W]===0){if(this[L].length===0)return F(new Error("Received unexpected message from server"));let te=this[L].shift();switch(J){case 5:te.cb(new Error("Agent responded with failure"));break;case 12:{if(te.type!==11)return F(new Error("Agent responded with wrong message type"));dt.init(H,ee);let ie=dt.readUInt32BE();if(ie===void 0)return dt.clear(),F(new Error("Malformed agent response"));let T=[];for(let M=0;M<ie;++M){let Q=dt.readString();if(Q===void 0)return dt.clear(),F(new Error("Malformed agent response"));let z=dt.readString(!0);if(z===void 0)return dt.clear(),F(new Error("Malformed agent response"));Q=ni(Q),!(Q instanceof Error)&&(Q.comment=Q.comment||z,T.push(Q))}ee=dt.pos(),dt.clear(),te.cb(null,T);break}case 14:{if(te.type!==13)return F(new Error("Agent responded with wrong message type"));dt.init(H,ee);let ie=dt.readString();if(ee=dt.pos(),dt.clear(),ie===void 0)return F(new Error("Malformed agent response"));if(dt.init(ie,0),dt.readString(!0),ie=dt.readString(),dt.clear(),ie===void 0)return F(new Error("Malformed OpenSSH signature format"));te.cb(null,ie);break}default:return F(new Error("Agent responded with unsupported message type"))}}else switch(J){case 11:{let te=new p(J);this[L].push(te),this.emit("identities",te);break}case 13:{dt.init(H,ee);let te=dt.readString(),ie=dt.readString(),T=dt.readUInt32BE();if(ee=dt.pos(),dt.clear(),T===void 0){let le=new p(J);return this[L].push(le),this.failureReply(le)}if(te=ni(te),te instanceof Error){let le=new p(J);return this[L].push(le),this.failureReply(le)}let M={hash:void 0},Q;te.type==="ssh-rsa"&&(T&2?(Q="rsa-sha2-256",M.hash="sha256"):T&4&&(Q="rsa-sha2-512",M.hash="sha512")),Q===void 0&&(Q=te.type);let z=new p(J,Q);this[L].push(z),this.emit("sign",z,te,ie,M);break}default:{let te=new p(J);this[L].push(te),this.failureReply(te)}}if(this[K]=-1,ee===ne){this[N]=null;break}else this[N]=H=H.slice(ee),ne=H.length,ee=0}F()}_destroy(I,O){b(this),O()}_final(I){b(this),I()}sign(I,O,F,H){if(this[W]!==0)throw new Error("Client-only method called with server role");typeof F=="function"?(H=F,F=void 0):(typeof F!="object"||F===null)&&(F=void 0);let ne=0;if(I=ni(I),I instanceof Error)throw new Error("Invalid public key argument");if(I.type==="ssh-rsa"&&F)switch(F.hash){case"sha256":ne=2;break;case"sha512":ne=4;break}I=I.getPublicSSH();let ee=13,J=I.length,te=O.length,ie=0,T=Buffer.allocUnsafe(4+1+4+J+4+te+4);return Ft(T,T.length-4,ie),T[ie+=4]=ee,Ft(T,J,++ie),I.copy(T,ie+=4),Ft(T,te,ie+=J),O.copy(T,ie+=4),Ft(T,ne,ie+=te),typeof H!="function"&&(H=Mo),this[L].push({type:ee,cb:H}),this.push(T)}getIdentities(I){if(this[W]!==0)throw new Error("Client-only method called with server role");let O=11,F=0,H=Buffer.allocUnsafe(4+1);return Ft(H,H.length-4,F),H[F+=4]=O,typeof I!="function"&&(I=Mo),this[L].push({type:O,cb:I}),this.push(H)}failureReply(I){if(this[W]!==1)throw new Error("Server-only method called with client role");if(!(I instanceof p))throw new Error("Wrong request argument");if(I.hasResponded())return!0;let O=0,F=Buffer.allocUnsafe(4+1);return Ft(F,F.length-4,O),F[O+=4]=5,y(this,I,F)}getIdentitiesReply(I,O){if(this[W]!==1)throw new Error("Server-only method called with client role");if(!(I instanceof p))throw new Error("Wrong request argument");if(I.hasResponded())return!0;if(I.getType()!==11)throw new Error("Invalid response to request");if(!Array.isArray(O))throw new Error("Keys argument must be an array");let F=4,H=[];for(let J=0;J<O.length;++J){let te=O[J];if(typeof te!="object"||te===null)throw new Error(`Invalid key entry: ${te}`);let ie,T;if(Ec(te))ie=te;else if(Ec(te.pubKey))ie=te.pubKey;else if(typeof te.pubKey!="object"||te.pubKey===null||({pubKey:ie,comment:T}=te.pubKey,ie=ni(ie),ie instanceof Error))continue;T=ie.comment||T,ie=ie.getPublicSSH(),F+=4+ie.length,T&&typeof T=="string"?T=Buffer.from(T):Buffer.isBuffer(T)||(T=Wd),F+=4+T.length,H.push({pubKey:ie,comment:T})}let ne=0,ee=Buffer.allocUnsafe(4+1+F);Ft(ee,ee.length-4,ne),ee[ne+=4]=12,Ft(ee,H.length,++ne),ne+=4;for(let J=0;J<H.length;++J){let{pubKey:te,comment:ie}=H[J];Ft(ee,te.length,ne),te.copy(ee,ne+=4),Ft(ee,ie.length,ne+=te.length),ne+=4,ie.length&&(ie.copy(ee,ne),ne+=ie.length)}return y(this,I,ee)}signReply(I,O){if(this[W]!==1)throw new Error("Server-only method called with client role");if(!(I instanceof p))throw new Error("Wrong request argument");if(I.hasResponded())return!0;if(I.getType()!==13)throw new Error("Invalid response to request");if(!Buffer.isBuffer(O))throw new Error("Signature argument must be a Buffer");if(O.length===0)throw new Error("Signature argument must be non-empty");let F=0,H=I.getContext(),ne=Buffer.byteLength(H),ee=Buffer.allocUnsafe(4+1+4+4+ne+4+O.length);return Ft(ee,ee.length-4,F),ee[F+=4]=14,Ft(ee,4+ne+4+O.length,++F),Ft(ee,ne,F+=4),ee.utf8Write(H,F+=4,ne),Ft(ee,O.length,F+=ne),O.copy(ee,F+=4),y(this,I,ee)}}})(),Qo=Symbol("Agent"),sr=Symbol("Agent Keys"),br=Symbol("Agent Keys Index"),bn=Symbol("Agent Init Callbacks"),qo=class{constructor(e){if(typeof e=="string")e=Ic(e);else if(!mc(e))throw new Error("Invalid agent argument");this[Qo]=e,this[sr]=null,this[br]=-1,this[bn]=null}init(e){if(typeof e!="function"&&(e=Mo),this[sr]===null)if(this[bn]===null){this[bn]=[e];let t=(...n)=>{process.nextTick(()=>{let i=this[bn];this[bn]=null;for(let s of i)s(...n)})};this[Qo].getIdentities(ii((n,i)=>{if(n)return t(n);if(!Array.isArray(i))return t(new Error("Agent implementation failed to provide keys"));let s=[];for(let o of i)o=ni(o),!(o instanceof Error)&&s.push(o);this[sr]=s,this[br]=-1,t()}))}else this[bn].push(e);else process.nextTick(e)}nextKey(){return this[sr]===null||++this[br]>=this[sr].length?!1:this[sr][this[br]]}currentKey(){return this[sr]===null||this[br]>=this[sr].length?null:this[sr][this[br]]}pos(){return this[sr]===null||this[br]>=this[sr].length?-1:this[br]}reset(){this[br]=-1}sign(...e){this[Qo].sign(...e)}};function mc(r){return r instanceof si}Bc.exports={AgentContext:qo,AgentProtocol:Fo,BaseAgent:si,createAgent:Ic,CygwinAgent:Sc,isAgent:mc,OpenSSHAgent:yn,PageantAgent:xc}});var Vo=_e((Sb,Cc)=>{"use strict";var{kMaxLength:$d}=require("buffer"),{createInflate:Gd,constants:{DEFLATE:Yd,INFLATE:jd,Z_DEFAULT_CHUNK:Xd,Z_DEFAULT_COMPRESSION:Vd,Z_DEFAULT_MEMLEVEL:zd,Z_DEFAULT_STRATEGY:Jd,Z_DEFAULT_WINDOWBITS:Zd,Z_PARTIAL_FLUSH:e0}}=require("zlib"),t0=Gd()._handle.constructor;function r0(){throw new Error("Should not get here")}function n0(r,e,t){let n=this._owner,i=new Error(r);i.errno=e,i.code=t,n._err=i}function Xo(r){r._handle&&(r._handle.close(),r._handle=null)}var ts=class{constructor(e){let t=Zd,n=Vd,i=zd,s=Jd,o=void 0;this._err=void 0,this._writeState=new Uint32Array(2),this._chunkSize=Xd,this._maxOutputLength=$d,this._outBuffer=Buffer.allocUnsafe(this._chunkSize),this._outOffset=0,this._handle=new t0(e),this._handle._owner=this,this._handle.onerror=n0,this._handle.init(t,n,i,s,this._writeState,r0,o)}writeSync(e,t){let n=this._handle;if(!n)throw new Error("Invalid Zlib instance");let i=e.length,s=this._chunkSize-this._outOffset,o=0,f,a,c,h=0,l=this._writeState,g=this._outBuffer,p=this._outOffset,y=this._chunkSize;for(;;){if(n.writeSync(e0,e,o,i,g,p,s),this._err)throw this._err;f=l[0],a=l[1];let x=i-a,m=s-f;if(m>0){let L=p===0&&m===g.length?g:g.slice(p,p+m);if(p+=m,c?c.push===void 0?c=[c,L]:c.push(L):c=L,h+=L.byteLength,h>this._maxOutputLength)throw Xo(this),new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}else if(m!==0)throw new Error("have should not go down");if((f===0||p>=y)&&(s=y,p=0,g=Buffer.allocUnsafe(y)),f===0)o+=x,i=a;else break}if(this._outBuffer=g,this._outOffset=p,h===0&&(c=Buffer.alloc(0)),t)return c.totalLen=h,c;if(c.push===void 0)return c;let b=Buffer.allocUnsafe(h);for(let x=0,m=0;x<c.length;++x){let L=c[x];b.set(L,m),m+=L.length}return b}},$o=class{constructor(e){this.allocStart=0,this.allocStartKEX=0,this._protocol=e,this._zlib=new ts(Yd)}cleanup(){this._zlib&&Xo(this._zlib)}alloc(e,t){return Buffer.allocUnsafe(e)}finalize(e,t){if(this._protocol._kexinit===void 0||t){let n=this._zlib.writeSync(e,!0),i=this._protocol._cipher.allocPacket(n.totalLen);if(n.push===void 0)i.set(n,5);else for(let s=0,o=5;s<n.length;++s){let f=n[s];i.set(f,o),o+=f.length}return i}return e}},Go=class{constructor(e){this.allocStart=5,this.allocStartKEX=5,this._protocol=e}cleanup(){}alloc(e,t){return this._protocol._kexinit===void 0||t?this._protocol._cipher.allocPacket(e):Buffer.allocUnsafe(e)}finalize(e,t){return e}},Yo=class{constructor(){this._zlib=new ts(jd)}cleanup(){this._zlib&&Xo(this._zlib)}read(e){return this._zlib.writeSync(e,!1)}},jo=class{cleanup(){}read(e){return e}};Cc.exports={PacketReader:jo,PacketWriter:Go,ZlibPacketReader:Yo,ZlibPacketWriter:$o}});var Tc=_e((Ib,Nc)=>{"use strict";var{bufferSlice:zo,bufferParser:R,doFatalError:ft,sigSSHToASN1:Rc,writeUInt32BE:kc}=rr(),{CHANNEL_OPEN_FAILURE:i0,COMPAT:s0,MESSAGE:ct,TERMINAL_MODE:vc}=pr(),{parseKey:o0}=kr(),f0=Array.from(Object.entries(vc)).reduce((r,[e,t])=>({...r,[e]:t}),{});Nc.exports={[ct.DISCONNECT]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n=R.readString(!0),i=R.readString();if(R.clear(),i===void 0)return ft(r,"Inbound: Malformed DISCONNECT packet");r._debug&&r._debug(`Inbound: Received DISCONNECT (${t}, "${n}")`);let s=r._handlers.DISCONNECT;s&&s(r,t,n)},[ct.IGNORE]:(r,e)=>{r._debug&&r._debug("Inbound: Received IGNORE")},[ct.UNIMPLEMENTED]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE();if(R.clear(),t===void 0)return ft(r,"Inbound: Malformed UNIMPLEMENTED packet");r._debug&&r._debug(`Inbound: Received UNIMPLEMENTED (seqno ${t})`)},[ct.DEBUG]:(r,e)=>{R.init(e,1);let t=R.readBool(),n=R.readString(!0),i=R.readString();if(R.clear(),i===void 0)return ft(r,"Inbound: Malformed DEBUG packet");r._debug&&r._debug("Inbound: Received DEBUG");let s=r._handlers.DEBUG;s&&s(r,t,n)},[ct.SERVICE_REQUEST]:(r,e)=>{R.init(e,1);let t=R.readString(!0);if(R.clear(),t===void 0)return ft(r,"Inbound: Malformed SERVICE_REQUEST packet");r._debug&&r._debug(`Inbound: Received SERVICE_REQUEST (${t})`);let n=r._handlers.SERVICE_REQUEST;n&&n(r,t)},[ct.SERVICE_ACCEPT]:(r,e)=>{R.init(e,1);let t=R.readString(!0);if(R.clear(),t===void 0)return ft(r,"Inbound: Malformed SERVICE_ACCEPT packet");r._debug&&r._debug(`Inbound: Received SERVICE_ACCEPT (${t})`);let n=r._handlers.SERVICE_ACCEPT;n&&n(r,t)},[ct.EXT_INFO]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n;if(t!==void 0){n=[];for(let s=0;s<t;++s){let o=R.readString(!0),f=R.readString();if(f!==void 0)switch(o){case"server-sig-algs":{let a=f.latin1Slice(0,f.length).split(",");n.push({name:o,algs:a});continue}default:continue}n=void 0;break}}if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed EXT_INFO packet");r._debug&&r._debug("Inbound: Received EXT_INFO");let i=r._handlers.EXT_INFO;i&&i(r,n)},[ct.USERAUTH_REQUEST]:(r,e)=>{R.init(e,1);let t=R.readString(!0),n=R.readString(!0),i=R.readString(!0),s,o;switch(i){case"none":s=null;break;case"password":{let a=R.readBool();if(a!==void 0&&(s=R.readString(!0),s!==void 0&&a)){let c=R.readString(!0);c!==void 0?s={oldPassword:s,newPassword:c}:s=void 0}break}case"publickey":{let a=R.readBool();if(a!==void 0){let c=R.readString(!0),h=c,l=R.readString(),g;switch(c){case"rsa-sha2-256":h="ssh-rsa",g="sha256";break;case"rsa-sha2-512":h="ssh-rsa",g="sha512";break}if(a){let p=R.pos(),y=R.readString();if(y!==void 0&&(y.length>4+c.length+4&&y.utf8Slice(4,4+c.length)===c&&(y=zo(y,4+c.length+4)),y=Rc(y,h),y)){let b=r._kex.sessionID,x=Buffer.allocUnsafe(4+b.length+p);kc(x,b.length,0),x.set(b,4),x.set(new Uint8Array(e.buffer,e.byteOffset,p),4+b.length),s={keyAlgo:h,key:l,signature:y,blob:x,hashAlgo:g}}}else s={keyAlgo:h,key:l,hashAlgo:g},o="publickey -- check"}break}case"hostbased":{let a=R.readString(!0),c=a,h=R.readString(),l=R.readString(!0),g=R.readString(!0),p;switch(a){case"rsa-sha2-256":c="ssh-rsa",p="sha256";break;case"rsa-sha2-512":c="ssh-rsa",p="sha512";break}let y=R.pos(),b=R.readString();if(b!==void 0&&(b.length>4+a.length+4&&b.utf8Slice(4,4+a.length)===a&&(b=zo(b,4+a.length+4)),b=Rc(b,c),b!==void 0)){let x=r._kex.sessionID,m=Buffer.allocUnsafe(4+x.length+y);kc(m,x.length,0),m.set(x,4),m.set(new Uint8Array(e.buffer,e.byteOffset,y),4+x.length),s={keyAlgo:c,key:h,signature:b,blob:m,localHostname:l,localUsername:g,hashAlgo:p}}break}case"keyboard-interactive":R.skipString(),s=R.readList();break;default:i!==void 0&&(s=R.readRaw())}if(R.clear(),s===void 0)return ft(r,"Inbound: Malformed USERAUTH_REQUEST packet");o===void 0&&(o=i),r._authsQueue.push(i),r._debug&&r._debug(`Inbound: Received USERAUTH_REQUEST (${o})`);let f=r._handlers.USERAUTH_REQUEST;f&&f(r,t,n,i,s)},[ct.USERAUTH_FAILURE]:(r,e)=>{R.init(e,1);let t=R.readList(),n=R.readBool();if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed USERAUTH_FAILURE packet");r._debug&&r._debug(`Inbound: Received USERAUTH_FAILURE (${t})`),r._authsQueue.shift();let i=r._handlers.USERAUTH_FAILURE;i&&i(r,t,n)},[ct.USERAUTH_SUCCESS]:(r,e)=>{r._debug&&r._debug("Inbound: Received USERAUTH_SUCCESS"),r._authsQueue.shift();let t=r._handlers.USERAUTH_SUCCESS;t&&t(r)},[ct.USERAUTH_BANNER]:(r,e)=>{R.init(e,1);let t=R.readString(!0),n=R.readString();if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed USERAUTH_BANNER packet");r._debug&&r._debug("Inbound: Received USERAUTH_BANNER");let i=r._handlers.USERAUTH_BANNER;i&&i(r,t)},60:(r,e)=>{if(!r._authsQueue.length){r._debug&&r._debug("Inbound: Received payload type 60 without auth");return}switch(r._authsQueue[0]){case"password":{R.init(e,1);let t=R.readString(!0),n=R.readString();if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet");r._debug&&r._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");let i=r._handlers.USERAUTH_PASSWD_CHANGEREQ;i&&i(r,t);break}case"publickey":{R.init(e,1);let t=R.readString(!0),n=R.readString();if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed USERAUTH_PK_OK packet");r._debug&&r._debug("Inbound: Received USERAUTH_PK_OK"),r._authsQueue.shift();let i=r._handlers.USERAUTH_PK_OK;i&&i(r,t,n);break}case"keyboard-interactive":{R.init(e,1);let t=R.readString(!0),n=R.readString(!0);R.readString();let i=R.readUInt32BE(),s;if(i!==void 0){s=new Array(i);let f;for(f=0;f<i;++f){let a=R.readString(!0),c=R.readBool();if(c===void 0)break;s[f]={prompt:a,echo:c}}f!==i&&(s=void 0)}if(R.clear(),s===void 0)return ft(r,"Inbound: Malformed USERAUTH_INFO_REQUEST packet");r._debug&&r._debug("Inbound: Received USERAUTH_INFO_REQUEST");let o=r._handlers.USERAUTH_INFO_REQUEST;o&&o(r,t,n,s);break}default:r._debug&&r._debug("Inbound: Received unexpected payload type 60")}},61:(r,e)=>{if(!r._authsQueue.length){r._debug&&r._debug("Inbound: Received payload type 61 without auth");return}if(r._authsQueue[0]!=="keyboard-interactive")return ft(r,"Inbound: Received unexpected payload type 61");R.init(e,1);let t=R.readUInt32BE(),n;if(t!==void 0){n=new Array(t);let s;for(s=0;s<t;++s){let o=R.readString(!0);if(o===void 0)break;n[s]=o}s!==t&&(n=void 0)}if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet");r._debug&&r._debug("Inbound: Received USERAUTH_INFO_RESPONSE");let i=r._handlers.USERAUTH_INFO_RESPONSE;i&&i(r,n)},[ct.GLOBAL_REQUEST]:(r,e)=>{R.init(e,1);let t=R.readString(!0),n=R.readBool(),i;if(n!==void 0)switch(t){case"tcpip-forward":case"cancel-tcpip-forward":{let o=R.readString(!0),f=R.readUInt32BE();f!==void 0&&(i={bindAddr:o,bindPort:f});break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{let o=R.readString(!0);o!==void 0&&(i={socketPath:o});break}case"no-more-sessions@openssh.com":i=null;break;case"hostkeys-00@openssh.com":{for(i=[];R.avail()>0;){let o=R.readString();if(o===void 0){i=void 0;break}let f=o0(o);f instanceof Error||i.push(f)}break}default:i=R.readRaw()}if(R.clear(),i===void 0)return ft(r,"Inbound: Malformed GLOBAL_REQUEST packet");r._debug&&r._debug(`Inbound: GLOBAL_REQUEST (${t})`);let s=r._handlers.GLOBAL_REQUEST;s?s(r,t,n,i):r.requestFailure()},[ct.REQUEST_SUCCESS]:(r,e)=>{let t=e.length>1?zo(e,1):null;r._debug&&r._debug("Inbound: REQUEST_SUCCESS");let n=r._handlers.REQUEST_SUCCESS;n&&n(r,t)},[ct.REQUEST_FAILURE]:(r,e)=>{r._debug&&r._debug("Inbound: Received REQUEST_FAILURE");let t=r._handlers.REQUEST_FAILURE;t&&t(r)},[ct.CHANNEL_OPEN]:(r,e)=>{R.init(e,1);let t=R.readString(!0),n=R.readUInt32BE(),i=R.readUInt32BE(),s=R.readUInt32BE(),o;switch(t){case"forwarded-tcpip":case"direct-tcpip":{let a=R.readString(!0),c=R.readUInt32BE(),h=R.readString(!0),l=R.readUInt32BE();l!==void 0&&(o={type:t,sender:n,window:i,packetSize:s,data:{destIP:a,destPort:c,srcIP:h,srcPort:l}});break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{let a=R.readString(!0);a!==void 0&&(o={type:t,sender:n,window:i,packetSize:s,data:{socketPath:a}});break}case"x11":{let a=R.readString(!0),c=R.readUInt32BE();c!==void 0&&(o={type:t,sender:n,window:i,packetSize:s,data:{srcIP:a,srcPort:c}});break}default:o={type:t,sender:n,window:i,packetSize:s,data:{}}}if(R.clear(),o===void 0)return ft(r,"Inbound: Malformed CHANNEL_OPEN packet");r._debug&&r._debug(`Inbound: CHANNEL_OPEN (s:${n}, ${t})`);let f=r._handlers.CHANNEL_OPEN;f?f(r,o):r.channelOpenFail(o.sender,i0.ADMINISTRATIVELY_PROHIBITED,"","")},[ct.CHANNEL_OPEN_CONFIRMATION]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n=R.readUInt32BE(),i=R.readUInt32BE(),s=R.readUInt32BE(),o=R.avail()?R.readRaw():void 0;if(R.clear(),s===void 0)return ft(r,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet");r._debug&&r._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${t}, s:${n})`);let f=r._handlers.CHANNEL_OPEN_CONFIRMATION;f&&f(r,{recipient:t,sender:n,window:i,packetSize:s,data:o})},[ct.CHANNEL_OPEN_FAILURE]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n=R.readUInt32BE(),i=R.readString(!0),s=R.readString();if(R.clear(),s===void 0)return ft(r,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet");r._debug&&r._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${t})`);let o=r._handlers.CHANNEL_OPEN_FAILURE;o&&o(r,t,n,i)},[ct.CHANNEL_WINDOW_ADJUST]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n=R.readUInt32BE();if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet");r._debug&&r._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${t}, ${n})`);let i=r._handlers.CHANNEL_WINDOW_ADJUST;i&&i(r,t,n)},[ct.CHANNEL_DATA]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n=R.readString();if(R.clear(),n===void 0)return ft(r,"Inbound: Malformed CHANNEL_DATA packet");r._debug&&r._debug(`Inbound: CHANNEL_DATA (r:${t}, ${n.length})`);let i=r._handlers.CHANNEL_DATA;i&&i(r,t,n)},[ct.CHANNEL_EXTENDED_DATA]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n=R.readUInt32BE(),i=R.readString();if(R.clear(),i===void 0)return ft(r,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet");r._debug&&r._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${t}, ${i.length})`);let s=r._handlers.CHANNEL_EXTENDED_DATA;s&&s(r,t,i,n)},[ct.CHANNEL_EOF]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE();if(R.clear(),t===void 0)return ft(r,"Inbound: Malformed CHANNEL_EOF packet");r._debug&&r._debug(`Inbound: CHANNEL_EOF (r:${t})`);let n=r._handlers.CHANNEL_EOF;n&&n(r,t)},[ct.CHANNEL_CLOSE]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE();if(R.clear(),t===void 0)return ft(r,"Inbound: Malformed CHANNEL_CLOSE packet");r._debug&&r._debug(`Inbound: CHANNEL_CLOSE (r:${t})`);let n=r._handlers.CHANNEL_CLOSE;n&&n(r,t)},[ct.CHANNEL_REQUEST]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE(),n=R.readString(!0),i=R.readBool(),s;if(i!==void 0)switch(n){case"exit-status":s=R.readUInt32BE(),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n}: ${s})`);break;case"exit-signal":{let f,a;if(r._compatFlags&s0.OLD_EXIT){let h=R.readUInt32BE();switch(h){case 1:f="HUP";break;case 2:f="INT";break;case 3:f="QUIT";break;case 6:f="ABRT";break;case 9:f="KILL";break;case 14:f="ALRM";break;case 15:f="TERM";break;default:h!==void 0&&(f=`UNKNOWN (${h})`)}a=!1}else f=R.readString(!0),a=R.readBool(),a===void 0&&(f=void 0);let c=R.readString(!0);R.skipString()!==void 0&&(s={signal:f,coreDumped:a,errorMessage:c}),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n}: ${f})`);break}case"pty-req":{let f=R.readString(!0),a=R.readUInt32BE(),c=R.readUInt32BE(),h=R.readUInt32BE(),l=R.readUInt32BE(),g=R.readString();if(g!==void 0){R.init(g,1);let p={};for(;R.avail();){let y=R.readByte();if(y===vc.TTY_OP_END)break;let b=f0[y],x=R.readUInt32BE();if(y===void 0||b===void 0||x===void 0){p=void 0;break}p[b]=x}p!==void 0&&(s={term:f,cols:a,rows:c,width:h,height:l,modes:p})}r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n})`);break}case"window-change":{let f=R.readUInt32BE(),a=R.readUInt32BE(),c=R.readUInt32BE(),h=R.readUInt32BE();h!==void 0&&(s={cols:f,rows:a,width:c,height:h}),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n})`);break}case"x11-req":{let f=R.readBool(),a=R.readString(!0),c=R.readString(),h=R.readUInt32BE();h!==void 0&&(s={single:f,protocol:a,cookie:c,screen:h}),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n})`);break}case"env":{let f=R.readString(!0),a=R.readString(!0);a!==void 0&&(s={name:f,value:a}),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n}: ${f}=${a})`);break}case"shell":s=null,r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n})`);break;case"exec":s=R.readString(!0),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n}: ${s})`);break;case"subsystem":s=R.readString(!0),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n}: ${s})`);break;case"signal":s=R.readString(!0),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n}: ${s})`);break;case"xon-xoff":s=R.readBool(),r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n}: ${s})`);break;case"auth-agent-req@openssh.com":s=null,r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n})`);break;default:s=R.avail()?R.readRaw():null,r._debug&&r._debug(`Inbound: CHANNEL_REQUEST (r:${t}, ${n})`)}if(R.clear(),s===void 0)return ft(r,"Inbound: Malformed CHANNEL_REQUEST packet");let o=r._handlers.CHANNEL_REQUEST;o&&o(r,t,n,i,s)},[ct.CHANNEL_SUCCESS]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE();if(R.clear(),t===void 0)return ft(r,"Inbound: Malformed CHANNEL_SUCCESS packet");r._debug&&r._debug(`Inbound: CHANNEL_SUCCESS (r:${t})`);let n=r._handlers.CHANNEL_SUCCESS;n&&n(r,t)},[ct.CHANNEL_FAILURE]:(r,e)=>{R.init(e,1);let t=R.readUInt32BE();if(R.clear(),t===void 0)return ft(r,"Inbound: Malformed CHANNEL_FAILURE packet");r._debug&&r._debug(`Inbound: CHANNEL_FAILURE (r:${t})`);let n=r._handlers.CHANNEL_FAILURE;n&&n(r,t)}}});var Zo=_e((mb,Lc)=>{"use strict";var Jo=new Array(256);[rs().HANDLERS,Tc()].forEach(r=>{for(let[e,t]of Object.entries(r))e=+e,isFinite(e)&&e>=0&&e<Jo.length&&(Jo[e]=t)});Lc.exports=Jo});var rs=_e((Cb,Wc)=>{"use strict";var{createDiffieHellman:a0,createDiffieHellmanGroup:c0,createECDH:u0,createHash:rf,createPublicKey:h0,diffieHellman:l0,generateKeyPairSync:d0,randomFillSync:g0}=require("crypto"),{Ber:Oc}=qn(),{COMPAT:nf,curve25519Supported:A0,DEFAULT_KEX:Uc,DEFAULT_SERVER_HOST_KEY:Pc,DEFAULT_CIPHER:ns,DEFAULT_MAC:is,DEFAULT_COMPRESSION:ss,DISCONNECT_REASON:Ke,MESSAGE:st}=pr(),{CIPHER_INFO:xn,createCipher:_0,createDecipher:p0,MAC_INFO:Dc}=Br(),{parseDERKey:E0}=kr(),{bufferFill:b0,bufferParser:qe,convertSignature:y0,doFatalError:$e,FastBuffer:w0,sigSSHToASN1:x0,writeUInt32BE:kt}=rr(),{PacketReader:Hc,PacketWriter:Qc,ZlibPacketReader:os,ZlibPacketWriter:fs}=Vo(),ef,S0=2048,I0=8192,m0=Buffer.alloc(0);function Mc(r){let e;if(r._compatFlags&nf.BAD_DHGEX){let t=r._offer.lists.kex,n=t.array,i=!1;for(let s=0;s<n.length;++s)n[s].includes("group-exchange")&&(i||(i=!0,n=n.slice()),n.splice(s--,1));if(i){let s=17+r._offer.totalSize+1+4,o=Buffer.from(n.join(","));s-=t.buffer.length-o.length;let f=r._offer.lists.all,a=new Uint8Array(f.buffer,f.byteOffset+4+t.buffer.length,f.length-(4+t.buffer.length));e=Buffer.allocUnsafe(s),kt(e,o.length,17),e.set(o,17+4),e.set(a,17+4+o.length)}}e===void 0&&(e=Buffer.allocUnsafe(1+16+r._offer.totalSize+1+4),r._offer.copyAllTo(e,17)),r._debug&&r._debug("Outbound: Sending KEXINIT"),e[0]=st.KEXINIT,g0(e,1,16),b0(e,0,e.length-5),r._kexinit=e,r._packetRW.write.allocStart=0;{let t=r._packetRW.write.allocStartKEX,n=r._packetRW.write.alloc(e.length,!0);n.set(e,t),r._cipher.encrypt(r._packetRW.write.finalize(n,!0))}}function Fc(r,e){let t={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0}};if(qe.init(e,17),(t.kex=qe.readList())===void 0||(t.serverHostKey=qe.readList())===void 0||(t.cs.cipher=qe.readList())===void 0||(t.sc.cipher=qe.readList())===void 0||(t.cs.mac=qe.readList())===void 0||(t.sc.mac=qe.readList())===void 0||(t.cs.compress=qe.readList())===void 0||(t.sc.compress=qe.readList())===void 0||(t.cs.lang=qe.readList())===void 0||(t.sc.lang=qe.readList())===void 0)return qe.clear(),$e(r,"Received malformed KEXINIT","handshake",Ke.KEY_EXCHANGE_FAILED);let n=qe.pos(),i=n<e.length&&e[n]===1;qe.clear();let s=r._offer,o=t,f=s.lists.kex.array;if(r._compatFlags&nf.BAD_DHGEX){let N=!1;for(let K=0;K<f.length;++K)f[K].indexOf("group-exchange")!==-1&&(N||(N=!0,f=f.slice()),f.splice(K--,1))}let a,c,h,l=r._debug;l&&l("Inbound: Handshake in progress"),l&&l(`Handshake: (local) KEX method: ${f}`),l&&l(`Handshake: (remote) KEX method: ${o.kex}`);let g;for(r._server?(c=f,a=o.kex,g=a.indexOf("ext-info-c")!==-1):(c=o.kex,a=f,g=c.indexOf("ext-info-s")!==-1),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching key exchange algorithm"),$e(r,"Handshake failed: no matching key exchange algorithm","handshake",Ke.KEY_EXCHANGE_FAILED);t.kex=a[h],l&&l(`Handshake: KEX algorithm: ${a[h]}`),i&&(!o.kex.length||a[h]!==o.kex[0])&&(r._skipNextInboundPacket=!0);let p=s.lists.serverHostKey.array;for(l&&l(`Handshake: (local) Host key format: ${p}`),l&&l(`Handshake: (remote) Host key format: ${o.serverHostKey}`),r._server?(c=p,a=o.serverHostKey):(c=o.serverHostKey,a=p),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching host key format"),$e(r,"Handshake failed: no matching host key format","handshake",Ke.KEY_EXCHANGE_FAILED);t.serverHostKey=a[h],l&&l(`Handshake: Host key format: ${a[h]}`);let y=s.lists.cs.cipher.array;for(l&&l(`Handshake: (local) C->S cipher: ${y}`),l&&l(`Handshake: (remote) C->S cipher: ${o.cs.cipher}`),r._server?(c=y,a=o.cs.cipher):(c=o.cs.cipher,a=y),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S cipher"),$e(r,"Handshake failed: no matching C->S cipher","handshake",Ke.KEY_EXCHANGE_FAILED);t.cs.cipher=a[h],l&&l(`Handshake: C->S Cipher: ${a[h]}`);let b=s.lists.sc.cipher.array;for(l&&l(`Handshake: (local) S->C cipher: ${b}`),l&&l(`Handshake: (remote) S->C cipher: ${o.sc.cipher}`),r._server?(c=b,a=o.sc.cipher):(c=o.sc.cipher,a=b),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C cipher"),$e(r,"Handshake failed: no matching S->C cipher","handshake",Ke.KEY_EXCHANGE_FAILED);t.sc.cipher=a[h],l&&l(`Handshake: S->C cipher: ${a[h]}`);let x=s.lists.cs.mac.array;if(l&&l(`Handshake: (local) C->S MAC: ${x}`),l&&l(`Handshake: (remote) C->S MAC: ${o.cs.mac}`),xn[t.cs.cipher].authLen>0)t.cs.mac="",l&&l("Handshake: C->S MAC: <implicit>");else{for(r._server?(c=x,a=o.cs.mac):(c=o.cs.mac,a=x),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S MAC"),$e(r,"Handshake failed: no matching C->S MAC","handshake",Ke.KEY_EXCHANGE_FAILED);t.cs.mac=a[h],l&&l(`Handshake: C->S MAC: ${a[h]}`)}let m=s.lists.sc.mac.array;if(l&&l(`Handshake: (local) S->C MAC: ${m}`),l&&l(`Handshake: (remote) S->C MAC: ${o.sc.mac}`),xn[t.sc.cipher].authLen>0)t.sc.mac="",l&&l("Handshake: S->C MAC: <implicit>");else{for(r._server?(c=m,a=o.sc.mac):(c=o.sc.mac,a=m),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C MAC"),$e(r,"Handshake failed: no matching S->C MAC","handshake",Ke.KEY_EXCHANGE_FAILED);t.sc.mac=a[h],l&&l(`Handshake: S->C MAC: ${a[h]}`)}let L=s.lists.cs.compress.array;for(l&&l(`Handshake: (local) C->S compression: ${L}`),l&&l(`Handshake: (remote) C->S compression: ${o.cs.compress}`),r._server?(c=L,a=o.cs.compress):(c=o.cs.compress,a=L),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S compression"),$e(r,"Handshake failed: no matching C->S compression","handshake",Ke.KEY_EXCHANGE_FAILED);t.cs.compress=a[h],l&&l(`Handshake: C->S compression: ${a[h]}`);let W=s.lists.sc.compress.array;for(l&&l(`Handshake: (local) S->C compression: ${W}`),l&&l(`Handshake: (remote) S->C compression: ${o.sc.compress}`),r._server?(c=W,a=o.sc.compress):(c=o.sc.compress,a=W),h=0;h<a.length&&c.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C compression"),$e(r,"Handshake failed: no matching S->C compression","handshake",Ke.KEY_EXCHANGE_FAILED);t.sc.compress=a[h],l&&l(`Handshake: S->C compression: ${a[h]}`),t.cs.lang="",t.sc.lang="",r._kex&&(r._kexinit||Mc(r),r._decipher._onPayload=qc.bind(r,{firstPacket:!1})),r._kex=B0(t,r,e),r._kex.remoteExtInfoEnabled=g,r._kex.start()}var B0=(()=>{function r(o){let f=0,a=o.length;for(;o[f]===0;)++f,--a;let c;return o[f]&128?(c=Buffer.allocUnsafe(1+a),c[0]=0,o.copy(c,1,f),o=c):a!==o.length&&(c=Buffer.allocUnsafe(a),o.copy(c,0,f),o=c),o}class e{constructor(f,a,c){this._protocol=a,this.sessionID=a._kex?a._kex.sessionID:void 0,this.negotiated=f,this.remoteExtInfoEnabled=!1,this._step=1,this._public=null,this._dh=null,this._sentNEWKEYS=!1,this._receivedNEWKEYS=!1,this._finished=!1,this._hostVerified=!1,this._kexinit=a._kexinit,this._remoteKexinit=c,this._identRaw=a._identRaw,this._remoteIdentRaw=a._remoteIdentRaw,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0}finish(f){if(this._finished)return!1;this._finished=!0;let a=this._protocol._server,c=this.negotiated,h=this.convertPublicKey(this._dhData),l=this.computeSecret(this._dhData);if(l instanceof Error)return l.message=`Error while computing DH secret (${this.type}): ${l.message}`,l.level="handshake",$e(this._protocol,l,Ke.KEY_EXCHANGE_FAILED);let g=rf(this.hashName);cr(g,a?this._remoteIdentRaw:this._identRaw),cr(g,a?this._identRaw:this._remoteIdentRaw),cr(g,a?this._remoteKexinit:this._kexinit),cr(g,a?this._kexinit:this._remoteKexinit);let p=a?this._hostKey.getPublicSSH():this._hostKey;if(cr(g,p),this.type==="groupex"){let W=this.getDHParams(),N=Buffer.allocUnsafe(4);kt(N,this._minBits,0),g.update(N),kt(N,this._prefBits,0),g.update(N),kt(N,this._maxBits,0),g.update(N),cr(g,W.prime),cr(g,W.generator)}cr(g,a?h:this.getPublicKey());let y=a?this.getPublicKey():h;cr(g,y),cr(g,l);let b=g.digest();if(a){let W;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":W="sha256";break;case"rsa-sha2-512":W="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let N=this._hostKey.sign(b,W);if(N instanceof Error)return $e(this._protocol,`Handshake failed: signature generation failed for ${this._hostKey.type} host key: ${N.message}`,"handshake",Ke.KEY_EXCHANGE_FAILED);if(N=y0(N,this._hostKey.type),N===!1)return $e(this._protocol,`Handshake failed: signature conversion failed for ${this._hostKey.type} host key`,"handshake",Ke.KEY_EXCHANGE_FAILED);let K=this.negotiated.serverHostKey,q=Buffer.byteLength(K),X=4+q+4+N.length,S=this._protocol._packetRW.write.allocStartKEX,I=this._protocol._packetRW.write.alloc(1+4+p.length+4+y.length+4+X,!0);if(I[S]=st.KEXDH_REPLY,kt(I,p.length,++S),I.set(p,S+=4),kt(I,y.length,S+=p.length),I.set(y,S+=4),kt(I,X,S+=y.length),kt(I,q,S+=4),I.utf8Write(K,S+=4,q),kt(I,N.length,S+=q),I.set(N,S+=4),this._protocol._debug){let O;switch(this.type){case"group":O="KEXDH_REPLY";break;case"groupex":O="KEXDH_GEX_REPLY";break;default:O="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${O}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(I,!0))}else{qe.init(this._sig,0);let W=qe.readString(!0);if(!W)return $e(this._protocol,"Malformed packet while reading signature","handshake",Ke.KEY_EXCHANGE_FAILED);if(W!==c.serverHostKey)return $e(this._protocol,`Wrong signature type: ${W}, expected: ${c.serverHostKey}`,"handshake",Ke.KEY_EXCHANGE_FAILED);let N=qe.readString();if(qe.clear(),N===void 0)return $e(this._protocol,"Malformed packet while reading signature","handshake",Ke.KEY_EXCHANGE_FAILED);if(!(N=x0(N,W)))return $e(this._protocol,"Malformed signature","handshake",Ke.KEY_EXCHANGE_FAILED);let K;{qe.init(this._hostKey,0);let S=qe.readString(!0),I=this._hostKey.slice(qe.pos());if(qe.clear(),K=E0(I,S),K instanceof Error)return K.level="handshake",$e(this._protocol,K,Ke.KEY_EXCHANGE_FAILED)}let q;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":q="sha256";break;case"rsa-sha2-512":q="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");let X=K.verify(b,N,q);if(X!==!0)return X instanceof Error?this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${X.stack}`):this._protocol._debug&&this._protocol._debug("Signature verification failed"),$e(this._protocol,"Handshake failed: signature verification failed","handshake",Ke.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Verified signature")}(a||!f)&&as(this);let x,m,L=W=>{if(x)return as(this),x.outbound.seqno=this._protocol._cipher.outSeqno,this._protocol._cipher.free(),this._protocol._cipher=_0(x),this._protocol._packetRW.write=m,x=void 0,m=void 0,this._protocol._onHandshakeComplete(c),!1;this.sessionID||(this.sessionID=b);{let te=Buffer.allocUnsafe(4+l.length);kt(te,l.length,0),te.set(l,4),l=te}let N=xn[c.cs.cipher],K=xn[c.sc.cipher],q=wn(N.ivLen,this.hashName,l,b,this.sessionID,"A"),X=wn(K.ivLen,this.hashName,l,b,this.sessionID,"B"),S=wn(N.keyLen,this.hashName,l,b,this.sessionID,"C"),I=wn(K.keyLen,this.hashName,l,b,this.sessionID,"D"),O,F;N.authLen||(O=Dc[c.cs.mac],F=wn(O.len,this.hashName,l,b,this.sessionID,"E"));let H,ne;K.authLen||(H=Dc[c.sc.mac],ne=wn(H.len,this.hashName,l,b,this.sessionID,"F"));let ee={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:a?N:K,decipherIV:a?q:X,decipherKey:a?S:I,macInfo:a?O:H,macKey:a?F:ne},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:a?K:N,cipherIV:a?X:q,cipherKey:a?I:S,macInfo:a?H:O,macKey:a?ne:F}};this._protocol._decipher.free(),x=ee,this._protocol._decipher=p0(ee);let J={read:void 0,write:void 0};switch(c.cs.compress){case"zlib":a?J.read=new os:J.write=new fs(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){a?J.read=new os:J.write=new fs(this._protocol);break}default:a?J.read=new Hc:J.write=new Qc(this._protocol)}switch(c.sc.compress){case"zlib":a?J.write=new fs(this._protocol):J.read=new os;break;case"zlib@openssh.com":if(this._protocol._authenticated){a?J.write=new fs(this._protocol):J.read=new os;break}default:a?J.write=new Qc(this._protocol):J.read=new Hc}return this._protocol._packetRW.read.cleanup(),this._protocol._packetRW.write.cleanup(),this._protocol._packetRW.read=J.read,m=J.write,this._public=null,this._dh=null,this._kexinit=this._protocol._kexinit=void 0,this._remoteKexinit=void 0,this._identRaw=void 0,this._remoteIdentRaw=void 0,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0,W?!1:L()};if((a||f)&&(this.finish=L),!a)return L(f)}start(){if(!this._protocol._server){if(this._protocol._debug){let h;switch(this.type){case"group":h="KEXDH_INIT";break;default:h="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${h}`)}let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,c=this._protocol._packetRW.write.alloc(1+4+f.length,!0);c[a]=st.KEXDH_INIT,kt(c,f.length,++a),c.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(c,!0))}}getPublicKey(){this.generateKeys();let f=this._public;if(f)return this.convertPublicKey(f)}convertPublicKey(f){let a,c=0,h=f.length;for(;f[c]===0;)++c,--h;return f[c]&128?(a=Buffer.allocUnsafe(1+h),a[0]=0,f.copy(a,1,c),a):(h!==f.length&&(a=Buffer.allocUnsafe(h),f.copy(a,0,c),f=a),f)}computeSecret(f){this.generateKeys();try{return r(this._dh.computeSecret(f))}catch(a){return a}}parse(f){let a=f[0];switch(this._step){case 1:if(this._protocol._server){if(a!==st.KEXDH_INIT)return $e(this._protocol,`Received packet ${a} instead of ${st.KEXDH_INIT}`,"handshake",Ke.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Init"),qe.init(f,1);let c=qe.readString();if(qe.clear(),c===void 0)return $e(this._protocol,"Received malformed KEX*_INIT","handshake",Ke.KEY_EXCHANGE_FAILED);this._dhData=c;let h=this._protocol._hostKeys[this.negotiated.serverHostKey];Array.isArray(h)&&(h=h[0]),this._hostKey=h,this.finish()}else{if(a!==st.KEXDH_REPLY)return $e(this._protocol,`Received packet ${a} instead of ${st.KEXDH_REPLY}`,"handshake",Ke.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Reply"),qe.init(f,1);let c,h,l;if((c=qe.readString())===void 0||(h=qe.readString())===void 0||(l=qe.readString())===void 0)return qe.clear(),$e(this._protocol,"Received malformed KEX*_REPLY","handshake",Ke.KEY_EXCHANGE_FAILED);qe.clear(),qe.init(c,0);let g=qe.readString(!0);if(qe.clear(),g===void 0)return $e(this._protocol,"Received malformed host public key","handshake",Ke.KEY_EXCHANGE_FAILED);if(g!==this.negotiated.serverHostKey)switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(g==="ssh-rsa")break;default:return $e(this._protocol,"Host key does not match negotiated type","handshake",Ke.KEY_EXCHANGE_FAILED)}this._hostKey=c,this._dhData=h,this._sig=l;let p=!1,y;if(this._protocol._hostVerifier===void 0?(y=!0,this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")):y=this._protocol._hostVerifier(c,b=>{if(!p){if(p=!0,b===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),$e(this._protocol,"Host denied (verification failed)","handshake",Ke.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,this._receivedNEWKEYS?this.finish():as(this)}}),y===void 0){++this._step;return}if(p=!0,y===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),$e(this._protocol,"Host denied (verification failed)","handshake",Ke.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,as(this)}++this._step;break;case 2:return a!==st.NEWKEYS?$e(this._protocol,`Received packet ${a} instead of ${st.NEWKEYS}`,"handshake",Ke.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS"),this._receivedNEWKEYS=!0,++this._step,this.finish(!this._protocol._server&&!this._hostVerified));default:return $e(this._protocol,`Received unexpected packet ${a} after NEWKEYS`,"handshake",Ke.KEY_EXCHANGE_FAILED)}}}class t extends e{constructor(f,...a){super(...a),this.type="25519",this.hashName=f,this._keys=null}generateKeys(){this._keys||(this._keys=d0("x25519"))}getPublicKey(){return this.generateKeys(),this._keys.publicKey.export({type:"spki",format:"der"}).slice(-32)}convertPublicKey(f){let a,c=0,h=f.length;for(;f[c]===0;)++c,--h;return f.length===32||h!==f.length&&(a=Buffer.allocUnsafe(h),f.copy(a,0,c),f=a),f}computeSecret(f){this.generateKeys();try{let a=new Oc.Writer;return a.startSequence(),a.startSequence(),a.writeOID("1.3.101.110"),a.endSequence(),a.startSequence(Oc.BitString),a.writeByte(0),a._ensure(f.length),f.copy(a._buf,a._offset,0,f.length),a._offset+=f.length,a.endSequence(),a.endSequence(),r(l0({privateKey:this._keys.privateKey,publicKey:h0({key:a.buffer,type:"spki",format:"der"})}))}catch(a){return a}}}class n extends e{constructor(f,a,...c){super(...c),this.type="ecdh",this.curveName=f,this.hashName=a}generateKeys(){this._dh||(this._dh=u0(this.curveName),this._public=this._dh.generateKeys())}}class i extends e{constructor(f,...a){super(...a),this.type="groupex",this.hashName=f,this._prime=null,this._generator=null,this._minBits=S0,this._prefBits=C0(this.negotiated),this._protocol._compatFlags&nf.BUG_DHGEX_LARGE&&(this._prefBits=Math.min(this._prefBits,4096)),this._maxBits=I0}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let f=this._protocol._packetRW.write.allocStartKEX,a=this._protocol._packetRW.write.alloc(1+4+4+4,!0);a[f]=st.KEXDH_GEX_REQUEST,kt(a,this._minBits,++f),kt(a,this._prefBits,f+=4),kt(a,this._maxBits,f+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(a,!0))}generateKeys(){!this._dh&&this._prime&&this._generator&&(this._dh=a0(this._prime,this._generator),this._public=this._dh.generateKeys())}setDHParams(f,a){if(!Buffer.isBuffer(f))throw new Error("Invalid prime value");if(!Buffer.isBuffer(a))throw new Error("Invalid generator value");this._prime=f,this._generator=a}getDHParams(){if(this._dh)return{prime:r(this._dh.getPrime()),generator:r(this._dh.getGenerator())}}parse(f){let a=f[0];switch(this._step){case 1:{if(this._protocol._server)return a!==st.KEXDH_GEX_REQUEST?$e(this._protocol,`Received packet ${a} instead of `+st.KEXDH_GEX_REQUEST,"handshake",Ke.KEY_EXCHANGE_FAILED):$e(this._protocol,"Group exchange not implemented for server","handshake",Ke.KEY_EXCHANGE_FAILED);if(a!==st.KEXDH_GEX_GROUP)return $e(this._protocol,`Received packet ${a} instead of ${st.KEXDH_GEX_GROUP}`,"handshake",Ke.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Group"),qe.init(f,1);let c,h;if((c=qe.readString())===void 0||(h=qe.readString())===void 0)return qe.clear(),$e(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",Ke.KEY_EXCHANGE_FAILED);qe.clear(),this.setDHParams(c,h),this.generateKeys();let l=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let g=this._protocol._packetRW.write.allocStartKEX,p=this._protocol._packetRW.write.alloc(1+4+l.length,!0);p[g]=st.KEXDH_GEX_INIT,kt(p,l.length,++g),p.set(l,g+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(p,!0)),++this._step;break}case 2:if(this._protocol._server)return a!==st.KEXDH_GEX_INIT?$e(this._protocol,`Received packet ${a} instead of ${st.KEXDH_GEX_INIT}`,"handshake",Ke.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Received DH GEX Init"),$e(this._protocol,"Group exchange not implemented for server","handshake",Ke.KEY_EXCHANGE_FAILED));if(a!==st.KEXDH_GEX_REPLY)return $e(this._protocol,`Received packet ${a} instead of ${st.KEXDH_GEX_REPLY}`,"handshake",Ke.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Reply"),this._step=1,f[0]=st.KEXDH_REPLY,this.parse=e.prototype.parse,this.parse(f)}}}class s extends e{constructor(f,a,...c){super(...c),this.type="group",this.groupName=f,this.hashName=a}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,c=this._protocol._packetRW.write.alloc(1+4+f.length,!0);c[a]=st.KEXDH_INIT,kt(c,f.length,++a),c.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(c,!0))}}generateKeys(){this._dh||(this._dh=c0(this.groupName),this._public=this._dh.generateKeys())}getDHParams(){if(this._dh)return{prime:r(this._dh.getPrime()),generator:r(this._dh.getGenerator())}}}return(o,...f)=>{if(typeof o!="object"||o===null)throw new Error("Invalid negotiated argument");let a=o.kex;if(typeof a=="string"){switch(f=[o,...f],a){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!A0)break;return new t("sha256",...f);case"ecdh-sha2-nistp256":return new n("prime256v1","sha256",...f);case"ecdh-sha2-nistp384":return new n("secp384r1","sha384",...f);case"ecdh-sha2-nistp521":return new n("secp521r1","sha512",...f);case"diffie-hellman-group1-sha1":return new s("modp2","sha1",...f);case"diffie-hellman-group14-sha1":return new s("modp14","sha1",...f);case"diffie-hellman-group14-sha256":return new s("modp14","sha256",...f);case"diffie-hellman-group15-sha512":return new s("modp15","sha512",...f);case"diffie-hellman-group16-sha512":return new s("modp16","sha512",...f);case"diffie-hellman-group17-sha512":return new s("modp17","sha512",...f);case"diffie-hellman-group18-sha512":return new s("modp18","sha512",...f);case"diffie-hellman-group-exchange-sha1":return new i("sha1",...f);case"diffie-hellman-group-exchange-sha256":return new i("sha256",...f)}throw new Error(`Unsupported key exchange algorithm: ${a}`)}throw new Error(`Invalid key exchange type: ${a}`)}})(),tf=(()=>{let r=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class{constructor(t){if(typeof t!="object"||t===null)throw new TypeError("Argument must be an object");let n={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},all:void 0},i=0;for(let f of r){let a,c,h,l;if(typeof f=="string")a=n,c=t[f],h=l=f;else{let p=f[0];a=n[p],l=f[1],c=t[p][l],h=`${p}.${l}`}let g={array:void 0,buffer:void 0};if(Buffer.isBuffer(c))g.array=(""+c).split(","),g.buffer=c,i+=4+c.length;else{if(typeof c=="string"&&(c=c.split(",")),Array.isArray(c))g.array=c,g.buffer=Buffer.from(c.join(","));else throw new TypeError(`Invalid \`${h}\` type: ${typeof c}`);i+=4+g.buffer.length}a[l]=g}let s=Buffer.allocUnsafe(i);n.all=s;let o=0;for(let f of r){let a;typeof f=="string"?a=n[f].buffer:a=n[f[0]][f[1]].buffer,o=kt(s,a.length,o),s.set(a,o),o+=a.length}this.totalSize=i,this.lists=n}copyAllTo(t,n){let i=this.lists.all;if(typeof n!="number")throw new TypeError(`Invalid offset value: ${typeof n}`);if(t.length-n<i.length)throw new Error("Insufficient space to copy list");return t.set(i,n),i.length}}})(),cr=(()=>{let r=Buffer.allocUnsafe(4);return(e,t)=>{kt(r,t.length,0),e.update(r),e.update(t)}})();function wn(r,e,t,n,i,s){let o;if(r){let f=rf(e).update(t).update(n).update(s).update(i).digest();for(;f.length<r;){let a=rf(e).update(t).update(n).update(f).digest(),c=Buffer.allocUnsafe(f.length+a.length);c.set(f,0),c.set(a,f.length),f=c}f.length===r?o=f:o=new w0(f.buffer,f.byteOffset,r)}else o=m0;return o}function qc(r,e){if(e.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=!1;return}e=this._packetRW.read.read(e);let t=e[0];switch(t){case st.DISCONNECT:case st.IGNORE:case st.UNIMPLEMENTED:case st.DEBUG:return ef||(ef=Zo()),ef[t](this,e);case st.KEXINIT:return r.firstPacket?(r.firstPacket=!1,Fc(this,e)):$e(this,"Received extra KEXINIT during handshake","handshake",Ke.KEY_EXCHANGE_FAILED);default:if(t<20||t>49)return $e(this,`Received unexpected packet type ${t}`,"handshake",Ke.KEY_EXCHANGE_FAILED)}return this._kex.parse(e)}function C0(r){let e=xn[r.cs.cipher],t=xn[r.sc.cipher],n=Math.max(0,e.sslName==="des-ede3-cbc"?14:e.keyLen,e.blockLen,e.ivLen,t.sslName==="des-ede3-cbc"?14:t.keyLen,t.blockLen,t.ivLen)*8;return n<=112?2048:n<=128?3072:n<=192?7680:8192}function as(r){if(!r._sentNEWKEYS){r._protocol._debug&&r._protocol._debug("Outbound: Sending NEWKEYS");let e=r._protocol._packetRW.write.allocStartKEX,t=r._protocol._packetRW.write.alloc(1,!0);t[e]=st.NEWKEYS,r._protocol._cipher.encrypt(r._protocol._packetRW.write.finalize(t,!0)),r._sentNEWKEYS=!0}}Wc.exports={KexInit:tf,kexinit:Mc,onKEXPayload:qc,DEFAULT_KEXINIT_CLIENT:new tf({kex:Uc.concat(["ext-info-c"]),serverHostKey:Pc,cs:{cipher:ns,mac:is,compress:ss,lang:[]},sc:{cipher:ns,mac:is,compress:ss,lang:[]}}),DEFAULT_KEXINIT_SERVER:new tf({kex:Uc,serverHostKey:Pc,cs:{cipher:ns,mac:is,compress:ss,lang:[]},sc:{cipher:ns,mac:is,compress:ss,lang:[]}}),HANDLERS:{[st.KEXINIT]:Fc}}});var Kc=_e((Rb,R0)=>{R0.exports={name:"ssh2",version:"1.14.0",author:"Brian White <mscdex@mscdex.net>",description:"SSH2 client and server modules written in pure JavaScript for node.js",main:"./lib/index.js",engines:{node:">=10.16.0"},dependencies:{asn1:"^0.2.6","bcrypt-pbkdf":"^1.0.2"},devDependencies:{"@mscdex/eslint-config":"^1.1.0",eslint:"^7.32.0"},optionalDependencies:{"cpu-features":"~0.0.8",nan:"^2.17.0"},scripts:{install:"node install.js",rebuild:"node install.js",test:"node test/test.js",lint:"eslint --cache --report-unused-disable-directives --ext=.js .eslintrc.js examples lib test","lint:fix":"npm run lint -- --fix"},keywords:["ssh","ssh2","sftp","secure","shell","exec","remote","client"],licenses:[{type:"MIT",url:"http://github.com/mscdex/ssh2/raw/master/LICENSE"}],repository:{type:"git",url:"http://github.com/mscdex/ssh2.git"}}});var af=_e((kb,nu)=>{"use strict";var{inspect:Vc}=require("util"),{bindingAvailable:k0,NullCipher:v0,NullDecipher:N0}=Br(),{COMPAT_CHECKS:T0,DISCONNECT_REASON:zc,eddsaSupported:L0,MESSAGE:ye,SIGNALS:$c,TERMINAL_MODE:of}=pr(),{DEFAULT_KEXINIT_CLIENT:O0,DEFAULT_KEXINIT_SERVER:U0,KexInit:Gc,kexinit:Jc,onKEXPayload:P0}=rs(),{parseKey:Yc}=kr(),D0=Zo(),{bufferCopy:cs,bufferFill:H0,bufferSlice:Zc,convertSignature:jc,sendPacket:we,writeUInt32BE:B}=rr(),{PacketReader:Q0,PacketWriter:M0,ZlibPacketReader:eu,ZlibPacketWriter:tu}=Vo(),F0=Kc().version,q0=new Map(Object.values(zc).map(r=>[r,1])),ru=Buffer.from(`SSH-2.0-ssh2js${F0}`),W0=Buffer.from(`${ru}\r
`),K0=8192,$0=1024,Xc=Buffer.from([ye.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]),G0=Buffer.from([of.TTY_OP_END]);function sf(){}var ff=class{constructor(e){let t=e.onWrite;if(typeof t!="function")throw new Error("Missing onWrite function");this._onWrite=p=>{t(p)};let n=e.onError;if(typeof n!="function")throw new Error("Missing onError function");this._onError=p=>{n(p)};let i=e.debug;this._debug=typeof i=="function"?p=>{i(p)}:void 0;let s=e.onHeader;this._onHeader=typeof s=="function"?(...p)=>{s(...p)}:sf;let o=e.onPacket;this._onPacket=typeof o=="function"?()=>{o()}:sf;let f=e.onHandshakeComplete;typeof f!="function"&&(f=sf);let a;this._onHandshakeComplete=(...p)=>{this._debug&&this._debug("Handshake completed"),a===void 0?a=!0:a=!1;let y=this._queue;if(y){this._queue=void 0,this._debug&&this._debug(`Draining outbound queue (${y.length}) ...`);for(let b=0;b<y.length;++b){let x=y[b],m=this._packetRW.write.finalize(x);if(m===x){let L=this._cipher.allocPacket(x.length);L.set(x,5),m=L}we(this,m)}this._debug&&this._debug("... finished draining outbound queue")}a&&this._server&&this._kex.remoteExtInfoEnabled&&Z0(this),f(...p)},this._queue=void 0;let c=e.messageHandlers;typeof c=="object"&&c!==null?this._handlers=c:this._handlers={},this._onPayload=V0.bind(this),this._server=!!e.server,this._banner=void 0;let h;if(this._server){if(typeof e.hostKeys!="object"||e.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=e.hostKeys,typeof e.greeting=="string"&&e.greeting.length&&(h=e.greeting.slice(-2)===`\r
`?e.greeting:`${e.greeting}\r
`),typeof e.banner=="string"&&e.banner.length&&(this._banner=e.banner.slice(-2)===`\r
`?e.banner:`${e.banner}\r
`)}else this._hostKeys=void 0;let l=e.offer;typeof l!="object"||l===null?l=this._server?U0:O0:l.constructor!==Gc&&(this._server||(l.kex=l.kex.concat(["ext-info-c"])),l=new Gc(l)),this._kex=void 0,this._kexinit=void 0,this._offer=l,this._cipher=new v0(0,this._onWrite),this._decipher=void 0,this._skipNextInboundPacket=!1,this._packetRW={read:new Q0,write:new M0(this)},this._hostVerifier=!this._server&&typeof e.hostVerifier=="function"?e.hostVerifier:void 0,this._parse=j0,this._buffer=void 0,this._authsQueue=[],this._authenticated=!1,this._remoteIdentRaw=void 0;let g;if(typeof e.ident=="string")this._identRaw=Buffer.from(`SSH-2.0-${e.ident}`),g=Buffer.allocUnsafe(this._identRaw.length+2),g.set(this._identRaw,0),g[g.length-2]=13,g[g.length-1]=10;else if(Buffer.isBuffer(e.ident)){let p=Buffer.allocUnsafe(8+e.ident.length);p.latin1Write("SSH-2.0-",0,8),p.set(e.ident,8),this._identRaw=p,g=Buffer.allocUnsafe(p.length+2),g.set(p,0),g[g.length-2]=13,g[g.length-1]=10}else this._identRaw=ru,g=W0;this._compatFlags=0,this._debug&&(k0?this._debug("Custom crypto binding available"):this._debug("Custom crypto binding not available")),this._debug&&this._debug(`Local ident: ${Vc(this._identRaw.toString())}`),this.start=()=>{this.start=void 0,h&&this._onWrite(h),this._onWrite(g)}}_destruct(e){this._packetRW.read.cleanup(),this._packetRW.write.cleanup(),this._cipher&&this._cipher.free(),this._decipher&&this._decipher.free(),(typeof e!="string"||e.length===0)&&(e="fatal error"),this.parse=()=>{throw new Error(`Instance unusable after ${e}`)},this._onWrite=()=>{throw new Error(`Instance unusable after ${e}`)},this._destruct=void 0}cleanup(){this._destruct&&this._destruct()}parse(e,t,n){for(;t<n;)t=this._parse(e,t,n)}disconnect(e){let n=this._packetRW.write.allocStartKEX,i=this._packetRW.write.alloc(13,!0),s=n+13;q0.has(e)||(e=zc.PROTOCOL_ERROR),i[n]=ye.DISCONNECT,B(i,e,++n),i.fill(0,n+=4,s),this._debug&&this._debug(`Outbound: Sending DISCONNECT (${e})`),we(this,this._packetRW.write.finalize(i,!0),!0)}ping(){let e=this._packetRW.write.allocStart,t=this._packetRW.write.alloc(Xc.length);t.set(Xc,e),this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)"),we(this,this._packetRW.write.finalize(t))}rekey(){this._kexinit===void 0?(this._debug&&this._debug("Outbound: Initiated explicit rekey"),this._queue=[],Jc(this)):this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}requestSuccess(e){let t=this._packetRW.write.allocStart,n;Buffer.isBuffer(e)?(n=this._packetRW.write.alloc(1+e.length),n[t]=ye.REQUEST_SUCCESS,n.set(e,++t)):(n=this._packetRW.write.alloc(1),n[t]=ye.REQUEST_SUCCESS),this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS"),we(this,this._packetRW.write.finalize(n))}requestFailure(){let e=this._packetRW.write.allocStart,t=this._packetRW.write.alloc(1);t[e]=ye.REQUEST_FAILURE,this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE"),we(this,this._packetRW.write.finalize(t))}channelSuccess(e){let t=this._packetRW.write.allocStart,n=this._packetRW.write.alloc(1+4);n[t]=ye.CHANNEL_SUCCESS,B(n,e,++t),this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${e})`),we(this,this._packetRW.write.finalize(n))}channelFailure(e){let t=this._packetRW.write.allocStart,n=this._packetRW.write.alloc(1+4);n[t]=ye.CHANNEL_FAILURE,B(n,e,++t),this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${e})`),we(this,this._packetRW.write.finalize(n))}channelEOF(e){let t=this._packetRW.write.allocStart,n=this._packetRW.write.alloc(1+4);n[t]=ye.CHANNEL_EOF,B(n,e,++t),this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${e})`),we(this,this._packetRW.write.finalize(n))}channelClose(e){let t=this._packetRW.write.allocStart,n=this._packetRW.write.alloc(1+4);n[t]=ye.CHANNEL_CLOSE,B(n,e,++t),this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${e})`),we(this,this._packetRW.write.finalize(n))}channelWindowAdjust(e,t){let n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4);i[n]=ye.CHANNEL_WINDOW_ADJUST,B(i,e,++n),B(i,t,n+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${e}, ${t})`),we(this,this._packetRW.write.finalize(i))}channelData(e,t){let n=Buffer.isBuffer(t),i=n?t.length:Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+i);o[s]=ye.CHANNEL_DATA,B(o,e,++s),B(o,i,s+=4),n?o.set(t,s+=4):o.utf8Write(t,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${e}, ${i})`),we(this,this._packetRW.write.finalize(o))}channelExtData(e,t,n){let i=Buffer.isBuffer(t),s=i?t.length:Buffer.byteLength(t),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+4+s);f[o]=ye.CHANNEL_EXTENDED_DATA,B(f,e,++o),B(f,n,o+=4),B(f,s,o+=4),i?f.set(t,o+=4):f.utf8Write(t,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${e})`),we(this,this._packetRW.write.finalize(f))}channelOpenConfirm(e,t,n,i){let s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+4+4);o[s]=ye.CHANNEL_OPEN_CONFIRMATION,B(o,e,++s),B(o,t,s+=4),B(o,n,s+=4),B(o,i,s+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${e}, l:${t})`),we(this,this._packetRW.write.finalize(o))}channelOpenFail(e,t,n){typeof n!="string"&&(n="");let i=Buffer.byteLength(n),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+4+i+4);o[s]=ye.CHANNEL_OPEN_FAILURE,B(o,e,++s),B(o,t,s+=4),B(o,i,s+=4),s+=4,i&&(o.utf8Write(n,s,i),s+=i),B(o,0,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${e})`),we(this,this._packetRW.write.finalize(o))}service(e){if(this._server)throw new Error("Client-only method called in server mode");let t=Buffer.byteLength(e),n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+t);i[n]=ye.SERVICE_REQUEST,B(i,t,++n),i.utf8Write(e,n+=4,t),this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${e})`),we(this,this._packetRW.write.finalize(i))}authPassword(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=Buffer.byteLength(t),o=n?Buffer.byteLength(n):0,f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+i+4+14+4+8+1+4+s+(n?4+o:0));a[f]=ye.USERAUTH_REQUEST,B(a,i,++f),a.utf8Write(e,f+=4,i),B(a,14,f+=i),a.utf8Write("ssh-connection",f+=4,14),B(a,8,f+=14),a.utf8Write("password",f+=4,8),a[f+=8]=n?1:0,B(a,s,++f),Buffer.isBuffer(t)?cs(t,a,0,s,f+=4):a.utf8Write(t,f+=4,s),n?(B(a,o,f+=s),Buffer.isBuffer(n)?cs(n,a,0,o,f+=4):a.utf8Write(n,f+=4,o),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")):this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)"),this._authsQueue.push("password"),we(this,this._packetRW.write.finalize(a))}authPK(e,t,n,i){if(this._server)throw new Error("Client-only method called in server mode");if(t=Yc(t),t instanceof Error)throw new Error("Invalid key");let s=t.type;t=t.getPublicSSH(),typeof n=="function"&&(i=n,n=void 0),n||(n=s);let o=Buffer.byteLength(e),f=Buffer.byteLength(n),a=t.length,c=this._kex.sessionID,h=c.length,l=(i?4+h:0)+1+4+o+4+14+4+9+1+4+f+4+a,g,p;if(i?(g=Buffer.allocUnsafe(l),p=0,B(g,h,p),g.set(c,p+=4),p+=h):(g=this._packetRW.write.alloc(l),p=this._packetRW.write.allocStart),g[p]=ye.USERAUTH_REQUEST,B(g,o,++p),g.utf8Write(e,p+=4,o),B(g,14,p+=o),g.utf8Write("ssh-connection",p+=4,14),B(g,9,p+=14),g.utf8Write("publickey",p+=4,9),g[p+=9]=i?1:0,B(g,f,++p),g.utf8Write(n,p+=4,f),B(g,a,p+=f),g.set(t,p+=4),!i){this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)"),we(this,this._packetRW.write.finalize(g));return}i(g,y=>{if(y=jc(y,s),y===!1)throw new Error("Error while converting handshake signature");let b=y.length;p=this._packetRW.write.allocStart,g=this._packetRW.write.alloc(1+4+o+4+14+4+9+1+4+f+4+a+4+4+f+4+b),g[p]=ye.USERAUTH_REQUEST,B(g,o,++p),g.utf8Write(e,p+=4,o),B(g,14,p+=o),g.utf8Write("ssh-connection",p+=4,14),B(g,9,p+=14),g.utf8Write("publickey",p+=4,9),g[p+=9]=1,B(g,f,++p),g.utf8Write(n,p+=4,f),B(g,a,p+=f),g.set(t,p+=4),B(g,4+f+4+b,p+=a),B(g,f,p+=4),g.utf8Write(n,p+=4,f),B(g,b,p+=f),g.set(y,p+=4),this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)"),we(this,this._packetRW.write.finalize(g))})}authHostbased(e,t,n,i,s,o){if(this._server)throw new Error("Client-only method called in server mode");if(t=Yc(t),t instanceof Error)throw new Error("Invalid key");let f=t.type;t=t.getPublicSSH(),typeof s=="function"&&(o=s,s=void 0),s||(s=f);let a=Buffer.byteLength(e),c=Buffer.byteLength(s),h=t.length,l=this._kex.sessionID,g=l.length,p=Buffer.byteLength(n),y=Buffer.byteLength(i),b=Buffer.allocUnsafe(4+g+1+4+a+4+14+4+9+4+c+4+h+4+p+4+y),x=0;B(b,g,x),b.set(l,x+=4),b[x+=g]=ye.USERAUTH_REQUEST,B(b,a,++x),b.utf8Write(e,x+=4,a),B(b,14,x+=a),b.utf8Write("ssh-connection",x+=4,14),B(b,9,x+=14),b.utf8Write("hostbased",x+=4,9),B(b,c,x+=9),b.utf8Write(s,x+=4,c),B(b,h,x+=c),b.set(t,x+=4),B(b,p,x+=h),b.utf8Write(n,x+=4,p),B(b,y,x+=p),b.utf8Write(i,x+=4,y),o(b,m=>{if(m=jc(m,f),!m)throw new Error("Error while converting handshake signature");let L=m.length,W=b.length-g-4;x=this._packetRW.write.allocStart;let N=this._packetRW.write.alloc(W+4+4+c+4+L);cs(b,N,4+g,b.length,x),B(N,4+c+4+L,x+=W),B(N,c,x+=4),N.utf8Write(s,x+=4,c),B(N,L,x+=c),N.set(m,x+=4),this._authsQueue.push("hostbased"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)"),we(this,this._packetRW.write.finalize(N))})}authKeyboard(e){if(this._server)throw new Error("Client-only method called in server mode");let t=Buffer.byteLength(e),n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+t+4+14+4+20+4+4);i[n]=ye.USERAUTH_REQUEST,B(i,t,++n),i.utf8Write(e,n+=4,t),B(i,14,n+=t),i.utf8Write("ssh-connection",n+=4,14),B(i,20,n+=14),i.utf8Write("keyboard-interactive",n+=4,20),B(i,0,n+=20),B(i,0,n+=4),this._authsQueue.push("keyboard-interactive"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)"),we(this,this._packetRW.write.finalize(i))}authNone(e){if(this._server)throw new Error("Client-only method called in server mode");let t=Buffer.byteLength(e),n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+t+4+14+4+4);i[n]=ye.USERAUTH_REQUEST,B(i,t,++n),i.utf8Write(e,n+=4,t),B(i,14,n+=t),i.utf8Write("ssh-connection",n+=4,14),B(i,4,n+=14),i.utf8Write("none",n+=4,4),this._authsQueue.push("none"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)"),we(this,this._packetRW.write.finalize(i))}authInfoRes(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0,n;if(e){n=new Array(e.length);for(let o=0;o<e.length;++o){let f=Buffer.byteLength(e[o]);n[o]=f,t+=4+f}}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+t);if(s[i]=ye.USERAUTH_INFO_RESPONSE,e){B(s,e.length,++i),i+=4;for(let o=0;o<e.length;++o){let f=n[o];B(s,f,i),i+=4,f&&(s.utf8Write(e[o],i,f),i+=f)}}else B(s,0,++i);this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE"),we(this,this._packetRW.write.finalize(s))}tcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+13+1+4+i+4);o[s]=ye.GLOBAL_REQUEST,B(o,13,++s),o.utf8Write("tcpip-forward",s+=4,13),o[s+=13]=n===void 0||n===!0?1:0,B(o,i,++s),o.utf8Write(e,s+=4,i),B(o,t,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)"),we(this,this._packetRW.write.finalize(o))}cancelTcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+20+1+4+i+4);o[s]=ye.GLOBAL_REQUEST,B(o,20,++s),o.utf8Write("cancel-tcpip-forward",s+=4,20),o[s+=20]=n===void 0||n===!0?1:0,B(o,i,++s),o.utf8Write(e,s+=4,i),B(o,t,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)"),we(this,this._packetRW.write.finalize(o))}openssh_streamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+31+1+4+n);s[i]=ye.GLOBAL_REQUEST,B(s,31,++i),s.utf8Write("streamlocal-forward@openssh.com",i+=4,31),s[i+=31]=t===void 0||t===!0?1:0,B(s,n,++i),s.utf8Write(e,i+=4,n),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)"),we(this,this._packetRW.write.finalize(s))}openssh_cancelStreamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+38+1+4+n);s[i]=ye.GLOBAL_REQUEST,B(s,38,++i),s.utf8Write("cancel-streamlocal-forward@openssh.com",i+=4,38),s[i+=38]=t===void 0||t===!0?1:0,B(s,n,++i),s.utf8Write(e,i+=4,n),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-streamlocal-forward@openssh.com)"),we(this,this._packetRW.write.finalize(s))}directTcpip(e,t,n,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.srcIP),o=Buffer.byteLength(i.dstIP),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+12+4+4+4+4+s+4+4+o+4);a[f]=ye.CHANNEL_OPEN,B(a,12,++f),a.utf8Write("direct-tcpip",f+=4,12),B(a,e,f+=12),B(a,t,f+=4),B(a,n,f+=4),B(a,o,f+=4),a.utf8Write(i.dstIP,f+=4,o),B(a,i.dstPort,f+=o),B(a,s,f+=4),a.utf8Write(i.srcIP,f+=4,s),B(a,i.srcPort,f+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, direct-tcpip)`),we(this,this._packetRW.write.finalize(a))}openssh_directStreamLocal(e,t,n,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+30+4+4+4+4+s+4+4);f[o]=ye.CHANNEL_OPEN,B(f,30,++o),f.utf8Write("direct-streamlocal@openssh.com",o+=4,30),B(f,e,o+=30),B(f,t,o+=4),B(f,n,o+=4),B(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),H0(f,0,o+=s,o+8),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, direct-streamlocal@openssh.com)`),we(this,this._packetRW.write.finalize(f))}openssh_noMoreSessions(e){if(this._server)throw new Error("Client-only method called in server mode");let t=this._packetRW.write.allocStart,n=this._packetRW.write.alloc(1+4+28+1);n[t]=ye.GLOBAL_REQUEST,B(n,28,++t),n.utf8Write("no-more-sessions@openssh.com",t+=4,28),n[t+=28]=e===void 0||e===!0?1:0,this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)"),we(this,this._packetRW.write.finalize(n))}session(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+7+4+4+4);s[i]=ye.CHANNEL_OPEN,B(s,7,++i),s.utf8Write("session",i+=4,7),B(s,e,i+=7),B(s,t,i+=4),B(s,n,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, session)`),we(this,this._packetRW.write.finalize(s))}windowChange(e,t,n,i,s){if(this._server)throw new Error("Client-only method called in server mode");let o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+13+1+4+4+4+4);f[o]=ye.CHANNEL_REQUEST,B(f,e,++o),B(f,13,o+=4),f.utf8Write("window-change",o+=4,13),f[o+=13]=0,B(f,n,++o),B(f,t,o+=4),B(f,s,o+=4),B(f,i,o+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, window-change)`),we(this,this._packetRW.write.finalize(f))}pty(e,t,n,i,s,o,f,a){if(this._server)throw new Error("Client-only method called in server mode");(!o||!o.length)&&(o="vt100"),f&&!Buffer.isBuffer(f)&&!Array.isArray(f)&&typeof f=="object"&&f!==null&&(f=J0(f)),(!f||!f.length)&&(f=G0);let c=o.length,h=f.length,l=this._packetRW.write.allocStart,g=this._packetRW.write.alloc(1+4+4+7+1+4+c+4+4+4+4+4+h);if(g[l]=ye.CHANNEL_REQUEST,B(g,e,++l),B(g,7,l+=4),g.utf8Write("pty-req",l+=4,7),g[l+=7]=a===void 0||a===!0?1:0,B(g,c,++l),g.utf8Write(o,l+=4,c),B(g,n,l+=c),B(g,t,l+=4),B(g,s,l+=4),B(g,i,l+=4),B(g,h,l+=4),l+=4,Array.isArray(f))for(let p=0;p<h;++p)g[l++]=f[p];else Buffer.isBuffer(f)&&g.set(f,l);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, pty-req)`),we(this,this._packetRW.write.finalize(g))}shell(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+5+1);i[n]=ye.CHANNEL_REQUEST,B(i,e,++n),B(i,5,n+=4),i.utf8Write("shell",n+=4,5),i[n+=5]=t===void 0||t===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, shell)`),we(this,this._packetRW.write.finalize(i))}exec(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.isBuffer(t),s=i?t.length:Buffer.byteLength(t),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+4+1+4+s);f[o]=ye.CHANNEL_REQUEST,B(f,e,++o),B(f,4,o+=4),f.utf8Write("exec",o+=4,4),f[o+=4]=n===void 0||n===!0?1:0,B(f,s,++o),i?f.set(t,o+=4):f.utf8Write(t,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exec: ${t})`),we(this,this._packetRW.write.finalize(f))}signal(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=t;if(t=t.toUpperCase(),t.slice(0,3)==="SIG"&&(t=t.slice(3)),$c[t]!==1)throw new Error(`Invalid signal: ${n}`);let i=t.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+6+1+4+i);o[s]=ye.CHANNEL_REQUEST,B(o,e,++s),B(o,6,s+=4),o.utf8Write("signal",s+=4,6),o[s+=6]=0,B(o,i,++s),o.utf8Write(t,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, signal: ${t})`),we(this,this._packetRW.write.finalize(o))}env(e,t,n,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(t),o=Buffer.isBuffer(n),f=o?n.length:Buffer.byteLength(n),a=this._packetRW.write.allocStart,c=this._packetRW.write.alloc(1+4+4+3+1+4+s+4+f);c[a]=ye.CHANNEL_REQUEST,B(c,e,++a),B(c,3,a+=4),c.utf8Write("env",a+=4,3),c[a+=3]=i===void 0||i===!0?1:0,B(c,s,++a),c.utf8Write(t,a+=4,s),B(c,f,a+=s),o?c.set(n,a+=4):c.utf8Write(n,a+=4,f),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, env: ${t}=${n})`),we(this,this._packetRW.write.finalize(c))}x11Forward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=t.protocol,s=t.cookie,o=Buffer.isBuffer(i),f=o?i.length:Buffer.byteLength(i),a=Buffer.isBuffer(s),c=a?s.length:Buffer.byteLength(s),h=this._packetRW.write.allocStart,l=this._packetRW.write.alloc(1+4+4+7+1+1+4+f+4+c+4);l[h]=ye.CHANNEL_REQUEST,B(l,e,++h),B(l,7,h+=4),l.utf8Write("x11-req",h+=4,7),l[h+=7]=n===void 0||n===!0?1:0,l[++h]=t.single?1:0,B(l,f,++h),o?l.set(i,h+=4):l.utf8Write(i,h+=4,f),B(l,c,h+=f),a?l.set(s,h+=4):l.latin1Write(s,h+=4,c),B(l,t.screen||0,h+=c),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, x11-req)`),we(this,this._packetRW.write.finalize(l))}subsystem(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+9+1+4+i);o[s]=ye.CHANNEL_REQUEST,B(o,e,++s),B(o,9,s+=4),o.utf8Write("subsystem",s+=4,9),o[s+=9]=n===void 0||n===!0?1:0,B(o,i,++s),o.utf8Write(t,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, subsystem: ${t})`),we(this,this._packetRW.write.finalize(o))}openssh_agentForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+26+1);i[n]=ye.CHANNEL_REQUEST,B(i,e,++n),B(i,26,n+=4),i.utf8Write("auth-agent-req@openssh.com",n+=4,26),i[n+=26]=t===void 0||t===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, auth-agent-req@openssh.com)`),we(this,this._packetRW.write.finalize(i))}openssh_hostKeysProve(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0,n=[];for(let o of e){let f=o.getPublicSSH();t+=4+f.length,n.push(f)}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+29+1+t);s[i]=ye.GLOBAL_REQUEST,B(s,29,++i),s.utf8Write("hostkeys-prove-00@openssh.com",i+=4,29),s[i+=29]=1,++i;for(let o of n)B(s,o.length,i),cs(o,s,0,o.length,i+=4),i+=o.length;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)"),we(this,this._packetRW.write.finalize(s))}serviceAccept(e){if(!this._server)throw new Error("Server-only method called in client mode");let t=Buffer.byteLength(e),n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+t);if(i[n]=ye.SERVICE_ACCEPT,B(i,t,++n),i.utf8Write(e,n+=4,t),this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${e})`),we(this,this._packetRW.write.finalize(i)),this._server&&this._banner&&e==="ssh-userauth"){let s=this._banner;this._banner=void 0;let o=Buffer.byteLength(s);n=this._packetRW.write.allocStart;let f=this._packetRW.write.alloc(1+4+o+4);f[n]=ye.USERAUTH_BANNER,B(f,o,++n),f.utf8Write(s,n+=4,o),B(f,0,n+=o),this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER"),we(this,this._packetRW.write.finalize(f))}}forwardedTcpip(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.boundAddr),o=Buffer.byteLength(i.remoteAddr),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+15+4+4+4+4+s+4+4+o+4);a[f]=ye.CHANNEL_OPEN,B(a,15,++f),a.utf8Write("forwarded-tcpip",f+=4,15),B(a,e,f+=15),B(a,t,f+=4),B(a,n,f+=4),B(a,s,f+=4),a.utf8Write(i.boundAddr,f+=4,s),B(a,i.boundPort,f+=s),B(a,o,f+=4),a.utf8Write(i.remoteAddr,f+=4,o),B(a,i.remotePort,f+=o),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, forwarded-tcpip)`),we(this,this._packetRW.write.finalize(a))}x11(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.originAddr),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+3+4+4+4+4+s+4);f[o]=ye.CHANNEL_OPEN,B(f,3,++o),f.utf8Write("x11",o+=4,3),B(f,e,o+=3),B(f,t,o+=4),B(f,n,o+=4),B(f,s,o+=4),f.utf8Write(i.originAddr,o+=4,s),B(f,i.originPort,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, x11)`),we(this,this._packetRW.write.finalize(f))}openssh_authAgent(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+22+4+4+4);s[i]=ye.CHANNEL_OPEN,B(s,22,++i),s.utf8Write("auth-agent@openssh.com",i+=4,22),B(s,e,i+=22),B(s,t,i+=4),B(s,n,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, auth-agent@openssh.com)`),we(this,this._packetRW.write.finalize(s))}openssh_forwardedStreamLocal(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+33+4+4+4+4+s+4);f[o]=ye.CHANNEL_OPEN,B(f,33,++o),f.utf8Write("forwarded-streamlocal@openssh.com",o+=4,33),B(f,e,o+=33),B(f,t,o+=4),B(f,n,o+=4),B(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),B(f,0,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, forwarded-streamlocal@openssh.com)`),we(this,this._packetRW.write.finalize(f))}exitStatus(e,t){if(!this._server)throw new Error("Server-only method called in client mode");let n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+11+1+4);i[n]=ye.CHANNEL_REQUEST,B(i,e,++n),B(i,11,n+=4),i.utf8Write("exit-status",n+=4,11),i[n+=11]=0,B(i,t,++n),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-status: ${t})`),we(this,this._packetRW.write.finalize(i))}exitSignal(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=t;if(typeof s!="string"||!s)throw new Error(`Invalid signal: ${s}`);let o=t.toUpperCase();if(o.slice(0,3)==="SIG"&&(o=o.slice(3)),$c[o]!==1)throw new Error(`Invalid signal: ${s}`);let f=Buffer.byteLength(o),a=i?Buffer.byteLength(i):0,c=this._packetRW.write.allocStart,h=this._packetRW.write.alloc(1+4+4+11+1+4+f+1+4+a+4);h[c]=ye.CHANNEL_REQUEST,B(h,e,++c),B(h,11,c+=4),h.utf8Write("exit-signal",c+=4,11),h[c+=11]=0,B(h,f,++c),h.utf8Write(o,c+=4,f),h[c+=f]=n?1:0,B(h,a,++c),c+=4,a&&(h.utf8Write(i,c,a),c+=a),B(h,0,c),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-signal: ${t})`),we(this,this._packetRW.write.finalize(h))}authFailure(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let n;if(typeof e=="boolean"&&(t=e,e=void 0),e){n=[];for(let f=0;f<e.length;++f)e[f].toLowerCase()!=="none"&&n.push(e[f]);n=n.join(",")}else n="";let i=n.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+i+1);o[s]=ye.USERAUTH_FAILURE,B(o,i,++s),o.utf8Write(n,s+=4,i),o[s+=i]=t===!0?1:0,this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE"),we(this,this._packetRW.write.finalize(o))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let e=this._packetRW.write.allocStart,t=this._packetRW.write.alloc(1);t[e]=ye.USERAUTH_SUCCESS,this._authsQueue.shift(),this._authenticated=!0,this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS"),we(this,this._packetRW.write.finalize(t)),this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.read=new eu),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.write=new tu(this))}authPKOK(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');let n=Buffer.byteLength(e),i=t.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+n+4+i);o[s]=ye.USERAUTH_PK_OK,B(o,n,++s),o.utf8Write(e,s+=4,n),B(o,i,s+=n),o.set(t,s+=4),this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK"),we(this,this._packetRW.write.finalize(o))}authPasswdChg(e){if(!this._server)throw new Error("Server-only method called in client mode");let t=Buffer.byteLength(e),n=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+t+4);i[n]=ye.USERAUTH_PASSWD_CHANGEREQ,B(i,t,++n),i.utf8Write(e,n+=4,t),B(i,0,n+=t),this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ"),we(this,this._packetRW.write.finalize(i))}authInfoReq(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let i=0,s=e?Buffer.byteLength(e):0,o=t?Buffer.byteLength(t):0;for(let c=0;c<n.length;++c)i+=4+Buffer.byteLength(n[c].prompt)+1;let f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+s+4+o+4+4+i);a[f]=ye.USERAUTH_INFO_REQUEST,B(a,s,++f),f+=4,e&&(a.utf8Write(e,f,s),f+=s),B(a,o,f),f+=4,t&&(a.utf8Write(t,f,o),f+=o),B(a,0,f),B(a,n.length,f+=4),f+=4;for(let c=0;c<n.length;++c){let h=n[c],l=Buffer.byteLength(h.prompt);B(a,l,f),f+=4,l&&(a.utf8Write(h.prompt,f,l),f+=l),a[f++]=h.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST"),we(this,this._packetRW.write.finalize(a))}},Y0=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function j0(r,e,t){let n,i;this._buffer?(n=Buffer.allocUnsafe(this._buffer.length+(t-e)),n.set(this._buffer,0),e===0?n.set(r,this._buffer.length):n.set(new Uint8Array(r.buffer,r.byteOffset+e,t-e),this._buffer.length),i=this._buffer.length,e=0):(n=r,i=0);let s=e,o=e,f=e,a=!1,c=0,h=0;for(;e<n.length;++e){let l=n[e];if(l===13){a=!0;continue}if(l===10){if(f>o&&f-o>4&&n[o]===83&&n[o+1]===83&&n[o+2]===72&&n[o+3]===45){let g=n.latin1Slice(s,f+1),p=o===s?g:g.slice(o-s),y=Y0.exec(p);if(!y)throw new Error("Invalid identification string");let b={greeting:o===s?"":g.slice(0,o-s),identRaw:p,versions:{protocol:y[1],software:y[2]},comments:y[3]};return this._remoteIdentRaw=Buffer.from(p),this._debug&&this._debug(`Remote ident: ${Vc(p)}`),this._compatFlags=z0(b),this._buffer=void 0,this._decipher=new N0(0,P0.bind(this,{firstPacket:!0})),this._parse=X0,this._onHeader(b),this._destruct?(Jc(this),e+1-i):t}if(this._server)throw new Error("Greetings from clients not permitted");if(++h>$0)throw new Error("Max greeting lines exceeded");a=!1,o=e+1,c=0}else{if(a)throw new Error("Invalid header: expected newline");if(++c>=K0)throw new Error("Header line too long")}f=e}return this._buffer||(this._buffer=Zc(n,s)),e-i}function X0(r,e,t){return this._decipher.decrypt(r,e,t)}function V0(r){if(this._onPacket(),r.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}r=this._packetRW.read.read(r);let e=r[0];e===ye.USERAUTH_SUCCESS&&!this._server&&!this._authenticated&&(this._authenticated=!0,this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.write=new tu(this)),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.read=new eu));let t=D0[e];if(t===void 0){this._debug&&this._debug(`Inbound: Unsupported message type: ${e}`);return}return t(this,r)}function z0(r){let e=r.versions.software,t=0;for(let n of T0)typeof n[0]=="string"?e===n[0]&&(t|=n[1]):n[0].test(e)&&(t|=n[1]);return t}function J0(r){let e=Object.keys(r),t=Buffer.allocUnsafe(5*e.length+1),n=0;for(let i=0;i<e.length;++i){let s=e[i];if(s==="TTY_OP_END")continue;let o=of[s];if(o===void 0)continue;let f=r[s];typeof f=="number"&&isFinite(f)&&(t[n++]=o,t[n++]=f>>>24,t[n++]=f>>>16,t[n++]=f>>>8,t[n++]=f)}return t[n++]=of.TTY_OP_END,n<t.length?Zc(t,0,n):t}function Z0(r){let e="ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss";L0&&(e=`ssh-ed25519,${e}`);let t=Buffer.byteLength(e),n=r._packetRW.write.allocStart,i=r._packetRW.write.alloc(1+4+4+15+4+t);i[n]=ye.EXT_INFO,B(i,1,++n),B(i,15,n+=4),i.utf8Write("server-sig-algs",n+=4,15),B(i,t,n+=15),i.utf8Write(e,n+=4,t),r._debug&&r._debug("Outbound: Sending EXT_INFO"),we(r,r._packetRW.write.finalize(i))}nu.exports=ff});var cu=_e(oi=>{"use strict";var us=require("assert"),{inspect:eg}=require("util");function iu(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function su(r,e){if(us(typeof e=="string","`thing` has to be of type string"),Array.isArray(r)){let t=r.length;return us(t>0,"At least one expected value needs to be specified"),r=r.map(n=>String(n)),t>2?`one of ${e} ${r.slice(0,t-1).join(", ")}, or `+r[t-1]:t===2?`one of ${e} ${r[0]} or ${r[1]}`:`of ${e} ${r[0]}`}return`of ${e} ${String(r)}`}oi.ERR_INTERNAL_ASSERTION=class fu extends Error{constructor(e){super(),Error.captureStackTrace(this,fu);let t=`This is caused by either a bug in ssh2 or incorrect usage of ssh2 internals.
Please open an issue with this stack trace at https://github.com/mscdex/ssh2/issues
`;this.message=e===void 0?t:`${e}
${t}`}};var tg=2**32,ou=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();oi.ERR_OUT_OF_RANGE=class au extends RangeError{constructor(e,t,n,i){super(),Error.captureStackTrace(this,au),us(t,'Missing "range" argument');let s=i?e:`The value of "${e}" is out of range.`,o;Number.isInteger(n)&&Math.abs(n)>tg?o=iu(String(n)):typeof n=="bigint"?(o=String(n),(n>ou||n<-ou)&&(o=iu(o)),o+="n"):o=eg(n),s+=` It must be ${t}. Received ${o}`,this.message=s}};var hs=class r extends TypeError{constructor(e,t,n){super(),Error.captureStackTrace(this,r),us(typeof e=="string","'name' must be a string");let i;typeof t=="string"&&t.startsWith("not ")?(i="must not be",t=t.replace(/^not /,"")):i="must be";let s;if(e.endsWith(" argument"))s=`The ${e} ${i} ${su(t,"type")}`;else{let o=e.includes(".")?"property":"argument";s=`The "${e}" ${o} ${i} ${su(t,"type")}`}s+=`. Received type ${typeof n}`,this.message=s}};oi.ERR_INVALID_ARG_TYPE=hs;oi.validateNumber=function(e,t){if(typeof e!="number")throw new hs(t,"number",e)}});var fi=_e((Nb,xu)=>{"use strict";var rg=require("events"),Nr=require("fs"),{constants:qt}=Nr,{Readable:Au,Writable:pf}=require("stream"),{inherits:_u,isDate:hf}=require("util"),ng=Buffer[Symbol.species],{bufferCopy:vr,bufferSlice:mn,makeBufferParser:ig,writeUInt32BE:D}=rr(),yr={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648},Ce=Buffer.alloc(28),Ve={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8},sg=new Map(Object.values(Ve).map(r=>[r,1])),og={[Ve.OK]:"No error",[Ve.EOF]:"End of file",[Ve.NO_SUCH_FILE]:"No such file or directory",[Ve.PERMISSION_DENIED]:"Permission denied",[Ve.FAILURE]:"Failure",[Ve.BAD_MESSAGE]:"Bad message",[Ve.NO_CONNECTION]:"No connection",[Ve.CONNECTION_LOST]:"Connection lost",[Ve.OP_UNSUPPORTED]:"Operation unsupported"},me={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200},Wt={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201},xe={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32},uu=2*1024,it=2**32-1,fg=Buffer.from([0,0,0,5,me.INIT,0,0,0,3]),ag=Buffer.from([0,0,0,5,Wt.VERSION,0,0,0,3]),cg=/^SSH-2.0-(?:OpenSSH|dropbear)/,cf=256*1024,k=ig(),ug={readable:!1,writable:!1,push:r=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function pu(){}var lf=class extends rg{constructor(e,t,n){super(),(typeof n!="object"||!n)&&(n={});let i=e._protocol._remoteIdentRaw;this.server=!!n.server,this._debug=typeof n.debug=="function"?n.debug:void 0,this._isOpenSSH=i&&cg.test(i),this._version=-1,this._extensions={},this._biOpt=n.biOpt,this._pktLenBytes=0,this._pktLen=0,this._pktPos=0,this._pktType=0,this._pktData=void 0,this._writeReqid=-1,this._requests={},this._maxInPktLen=cf,this._maxOutPktLen=34e3,this._maxReadLen=(this._isOpenSSH?cf:34e3)-uu,this._maxWriteLen=(this._isOpenSSH?cf:34e3)-uu,this.maxOpenHandles=void 0,this._client=e,this._protocol=e._protocol,this._callbacks=[],this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this._waitWindow=!1,this._chunkcb=void 0,this._buffer=[],this.type=t.type,this.subtype=void 0,this.incoming=t.incoming,this.outgoing=t.outgoing,this.stderr=ug,this.readable=!0}push(e){if(e===null){if(wu(this),!this.readable)return;this.readable=!1,this.emit("end");return}let t=0;for(;t<e.length;){if(this._pktLenBytes<4){let o=Math.min(4-this._pktLenBytes,e.length-t);for(this._pktLenBytes+=o;o--;)this._pktLen=(this._pktLen<<8)+e[t++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return et(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){let f=this._maxInPktLen;return et(this,`Packet length ${this._pktLen} exceeds max length of ${f}`)}if(t>=e.length)return}if(this._pktPos<this._pktLen){let o=Math.min(this._pktLen-this._pktPos,e.length-t);if(t!==0||o!==e.length?o===this._pktLen?this._pkt=new ng(e.buffer,e.byteOffset+t,o):(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(new Uint8Array(e.buffer,e.byteOffset+t,o),this._pktPos)):o===this._pktLen?this._pkt=e:(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(e,this._pktPos)),t+=o,this._pktPos+=o,this._pktPos<this._pktLen)return}let n=this._pkt[0],i=this._pkt;this._pktLen=0,this._pktLenBytes=0,this._pkt=void 0,this._pktPos=0;let s=this.server?Ag[n]:gg[n];if(!s)return et(this,`Unknown packet type ${n}`);if(this._version===-1){if(this.server){if(n!==me.INIT)return et(this,`Expected INIT packet, got ${n}`)}else if(n!==Wt.VERSION)return et(this,`Expected VERSION packet, got ${n}`)}if(s(this,i)===!1)return}}end(){this.destroy()}destroy(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._protocol.channelClose(this.outgoing.id))}_init(){this._init=pu,this.server||Ye(this,fg)}createReadStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new wr(this,e,t)}createWriteStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new Jt(this,e,t)}open(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");typeof n=="function"&&(i=n,n=void 0);let s=typeof t=="number"?t:bu(t);if(s===null)throw new Error(`Unknown flags string: ${t}`);let o=0,f=0;(typeof n=="string"||typeof n=="number")&&(n={mode:n}),typeof n=="object"&&n!==null&&(n=Yr(n),o=n.flags,f=n.nb);let a=Buffer.byteLength(e),c=9,h=Buffer.allocUnsafe(4+1+4+4+a+4+4+f);D(h,h.length-4,0),h[4]=me.OPEN;let l=this._writeReqid=this._writeReqid+1&it;D(h,l,5),D(h,a,c),h.utf8Write(e,c+=4,a),D(h,s,c+=a),D(h,o,c+=4),f&&(c+=4,f===Ce.length?h.set(Ce,c):vr(Ce,h,0,f,c),c+=f),this._requests[l]={cb:i};let g=Ye(this,h);this._debug&&this._debug(`SFTP: Outbound: ${g?"Buffered":"Sending"} OPEN`)}close(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let n=e.length,i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.CLOSE;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.set(e,i+=4),this._requests[o]={cb:t};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} CLOSE`)}read(e,t,n,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>=t.length)throw new Error("offset is out of bounds");if(n+i>t.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");Eu(this,e,t,n,i,s,o)}readData(e,t,n,i,s,o){this.read(e,t,n,i,s,o)}write(e,t,n,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>t.length)throw new Error("offset is out of bounds");if(n+i>t.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");if(!i){o&&process.nextTick(o,void 0,0);return}let f=this._maxWriteLen,a=Math.max(i-f,0),c=s;a&&(i=f);let h=e.length,l=9,g=Buffer.allocUnsafe(4+1+4+4+h+8+4+i);D(g,g.length-4,0),g[4]=me.WRITE;let p=this._writeReqid=this._writeReqid+1&it;D(g,p,5),D(g,h,l),g.set(e,l+=4),l+=h;for(let b=7;b>=0;--b)g[l+b]=s&255,s/=256;D(g,i,l+=8),vr(t,g,n,n+i,l+=4),this._requests[p]={cb:b=>{b?typeof o=="function"&&o(b):a?this.write(e,t,n+i,a,c+i,o):typeof o=="function"&&o(void 0,n+i)}};let y=Ye(this,g);if(this._debug){let b=y?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${b} WRITE (id:${p})`)}}writeData(e,t,n,i,s,o){this.write(e,t,n,i,s,o)}fastGet(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");hu(this,Nr,e,t,n,i)}fastPut(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");hu(Nr,this,e,t,n,i)}readFile(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof n=="function"?i=n:typeof t=="function"&&(i=t,t=void 0),typeof t=="string")t={encoding:t,flag:"r"};else if(!t)t={encoding:null,flag:"r"};else if(typeof t!="object")throw new TypeError("Bad arguments");let s=t.encoding;if(s&&!Buffer.isEncoding(s))throw new Error(`Unknown encoding: ${s}`);let o,f,a,c=0,h,l=0,g=t.flag||"r",p=()=>{o===0?(f=Buffer.allocUnsafe(8192),this.read(h,f,0,8192,l,y)):this.read(h,f,c,o-c,l,y)},y=(x,m)=>{let L;if(x){if(L=x.code===Ve.EOF,!L)return this.close(h,()=>i&&i(x))}else L=!1;if(L||o===0&&m===0)return b();l+=m,c+=m,o!==0?c===o?b():p():(a.push(mn(f,0,m)),p())};y._wantEOFError=!0;let b=()=>{this.close(h,x=>(o===0?f=Buffer.concat(a,c):c<o&&(f=mn(f,0,c)),s&&(f=f.toString(s)),i&&i(x,f)))};this.open(e,g,438,(x,m)=>{if(x)return i&&i(x);h=m;let L=(W,N)=>{if(W){this.stat(e,(K,q)=>{if(K)return this.close(h,()=>{i&&i(W)});L(null,q)});return}if(o=N.size||0,o===0)return a=[],p();f=Buffer.allocUnsafe(o),p()};this.fstat(h,L)})}writeFile(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof n=="function"&&(s=n,n=void 0),typeof n=="string")n={encoding:n,mode:438,flag:"w"};else if(!n)n={encoding:"utf8",mode:438,flag:"w"};else if(typeof n!="object")throw new TypeError("Bad arguments");if(n.encoding&&!Buffer.isEncoding(n.encoding))throw new Error(`Unknown encoding: ${n.encoding}`);let o=n.flag||"w";this.open(e,o,n.mode,(f,a)=>{if(f)s&&s(f);else{let c=Buffer.isBuffer(t)?t:Buffer.from(""+t,n.encoding||"utf8"),h=/a/.test(o)?null:0;if(h===null){let l=(g,p)=>{if(g){this.stat(e,(y,b)=>{if(y)return this.close(a,()=>{s&&s(g)});l(null,b)});return}df(this,a,c,0,c.length,p.size,s)};this.fstat(a,l);return}df(this,a,c,0,c.length,h,s)}})}appendFile(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof n=="function"&&(s=n,n=void 0),typeof n=="string")n={encoding:n,mode:438,flag:"a"};else if(!n)n={encoding:"utf8",mode:438,flag:"a"};else if(typeof n!="object")throw new TypeError("Bad arguments");n.flag||(n=Object.assign({flag:"a"},n)),this.writeFile(e,t,n,s)}exists(e,t){if(this.server)throw new Error("Client-only method called in server mode");this.stat(e,n=>{t&&t(!n)})}unlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.REMOVE;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.utf8Write(e,i+=4,n),this._requests[o]={cb:t};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REMOVE`)}rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=Buffer.byteLength(t),o=9,f=Buffer.allocUnsafe(4+1+4+4+i+4+s);D(f,f.length-4,0),f[4]=me.RENAME;let a=this._writeReqid=this._writeReqid+1&it;D(f,a,5),D(f,i,o),f.utf8Write(e,o+=4,i),D(f,s,o+=i),f.utf8Write(t,o+=4,s),this._requests[a]={cb:n};let c=Ye(this,f);this._debug&&this._debug(`SFTP: Outbound: ${c?"Buffered":"Sending"} RENAME`)}mkdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof t=="function"&&(n=t,t=void 0),typeof t=="object"&&t!==null&&(t=Yr(t),i=t.flags,s=t.nb);let o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);D(a,a.length-4,0),a[4]=me.MKDIR;let c=this._writeReqid=this._writeReqid+1&it;D(a,c,5),D(a,o,f),a.utf8Write(e,f+=4,o),D(a,i,f+=o),s&&(f+=4,s===Ce.length?a.set(Ce,f):vr(Ce,a,0,s,f),f+=s),this._requests[c]={cb:n};let h=Ye(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} MKDIR`)}rmdir(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.RMDIR;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.utf8Write(e,i+=4,n),this._requests[o]={cb:t};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} RMDIR`)}readdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");typeof t=="function"&&(n=t,t={}),(typeof t!="object"||t===null)&&(t={});let i=!(t&&t.full);if(!Buffer.isBuffer(e)&&typeof e!="string")throw new Error("missing directory handle or path");if(typeof e=="string"){let h=[],l=0,g=(p,y)=>{if(p)return n(p);this.readdir(y,t,(b,x)=>{let m=b&&b.code===Ve.EOF;if(b&&!m)return this.close(y,()=>n(b));if(m)return this.close(y,L=>{if(L)return n(L);n(void 0,h)});for(let L=0;L<x.length;++L,++l)h[l]=x[L];g(void 0,y)})};return this.opendir(e,g)}let s=e.length,o=9,f=Buffer.allocUnsafe(4+1+4+4+s);D(f,f.length-4,0),f[4]=me.READDIR;let a=this._writeReqid=this._writeReqid+1&it;D(f,a,5),D(f,s,o),f.set(e,o+=4),this._requests[a]={cb:i?(h,l)=>{if(typeof n=="function"){if(h)return n(h);for(let g=l.length-1;g>=0;--g)(l[g].filename==="."||l[g].filename==="..")&&l.splice(g,1);n(void 0,l)}}:n};let c=Ye(this,f);this._debug&&this._debug(`SFTP: Outbound: ${c?"Buffered":"Sending"} READDIR`)}fstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let n=e.length,i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.FSTAT;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.set(e,i+=4),this._requests[o]={cb:t};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} FSTAT`)}stat(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.STAT;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.utf8Write(e,i+=4,n),this._requests[o]={cb:t};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STAT`)}lstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.LSTAT;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.utf8Write(e,i+=4,n),this._requests[o]={cb:t};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} LSTAT`)}opendir(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.OPENDIR;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.utf8Write(e,i+=4,n),this._requests[o]={cb:t};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} OPENDIR`)}setstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof t=="object"&&t!==null?(t=Yr(t),i=t.flags,s=t.nb):typeof t=="function"&&(n=t);let o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);D(a,a.length-4,0),a[4]=me.SETSTAT;let c=this._writeReqid=this._writeReqid+1&it;D(a,c,5),D(a,o,f),a.utf8Write(e,f+=4,o),D(a,i,f+=o),s&&(f+=4,s===Ce.length?a.set(Ce,f):vr(Ce,a,0,s,f),f+=s),this._requests[c]={cb:n};let h=Ye(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} SETSTAT`)}fsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let i=0,s=0;typeof t=="object"&&t!==null?(t=Yr(t),i=t.flags,s=t.nb):typeof t=="function"&&(n=t);let o=e.length,f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);D(a,a.length-4,0),a[4]=me.FSETSTAT;let c=this._writeReqid=this._writeReqid+1&it;D(a,c,5),D(a,o,f),a.set(e,f+=4),D(a,i,f+=o),s&&(f+=4,s===Ce.length?a.set(Ce,f):vr(Ce,a,0,s,f),f+=s),this._requests[c]={cb:n};let h=Ye(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} FSETSTAT`)}futimes(e,t,n,i){return this.fsetstat(e,{atime:Sn(t),mtime:Sn(n)},i)}utimes(e,t,n,i){return this.setstat(e,{atime:Sn(t),mtime:Sn(n)},i)}fchown(e,t,n,i){return this.fsetstat(e,{uid:t,gid:n},i)}chown(e,t,n,i){return this.setstat(e,{uid:t,gid:n},i)}fchmod(e,t,n){return this.fsetstat(e,{mode:t},n)}chmod(e,t,n){return this.setstat(e,{mode:t},n)}readlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.READLINK;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.utf8Write(e,i+=4,n),this._requests[o]={cb:(a,c)=>{if(typeof t=="function"){if(a)return t(a);if(!c||!c.length)return t(new Error("Response missing link info"));t(void 0,c[0].filename)}}};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} READLINK`)}symlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=Buffer.byteLength(e),o=9,f=Buffer.allocUnsafe(4+1+4+4+i+4+s);D(f,f.length-4,0),f[4]=me.SYMLINK;let a=this._writeReqid=this._writeReqid+1&it;D(f,a,5),this._isOpenSSH?(D(f,s,o),f.utf8Write(e,o+=4,s),D(f,i,o+=s),f.utf8Write(t,o+=4,i)):(D(f,i,o),f.utf8Write(t,o+=4,i),D(f,s,o+=i),f.utf8Write(e,o+=4,s)),this._requests[a]={cb:n};let c=Ye(this,f);this._debug&&this._debug(`SFTP: Outbound: ${c?"Buffered":"Sending"} SYMLINK`)}realpath(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=Buffer.byteLength(e),i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=me.REALPATH;let o=this._writeReqid=this._writeReqid+1&it;D(s,o,5),D(s,n,i),s.utf8Write(e,i+=4,n),this._requests[o]={cb:(a,c)=>{if(typeof t=="function"){if(a)return t(a);if(!c||!c.length)return t(new Error("Response missing path info"));t(void 0,c[0].filename)}}};let f=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i=this._extensions["posix-rename@openssh.com"];if(!i||i!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(e),o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(4+1+4+4+24+4+s+4+o);D(a,a.length-4,0),a[4]=me.EXTENDED;let c=this._writeReqid=this._writeReqid+1&it;D(a,c,5),D(a,24,f),a.utf8Write("posix-rename@openssh.com",f+=4,24),D(a,s,f+=24),a.utf8Write(e,f+=4,s),D(a,o,f+=s),a.utf8Write(t,f+=4,o),this._requests[c]={cb:n};let h=Ye(this,a);if(this._debug){let l=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} posix-rename@openssh.com`)}}ext_openssh_statvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=this._extensions["statvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(e),s=9,o=Buffer.allocUnsafe(4+1+4+4+19+4+i);D(o,o.length-4,0),o[4]=me.EXTENDED;let f=this._writeReqid=this._writeReqid+1&it;D(o,f,5),D(o,19,s),o.utf8Write("statvfs@openssh.com",s+=4,19),D(o,i,s+=19),o.utf8Write(e,s+=4,i),this._requests[f]={extended:"statvfs@openssh.com",cb:t};let a=Ye(this,o);if(this._debug){let c=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${c} statvfs@openssh.com`)}}ext_openssh_fstatvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");let n=this._extensions["fstatvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let i=e.length,s=9,o=Buffer.allocUnsafe(4+1+4+4+20+4+i);D(o,o.length-4,0),o[4]=me.EXTENDED;let f=this._writeReqid=this._writeReqid+1&it;D(o,f,5),D(o,20,s),o.utf8Write("fstatvfs@openssh.com",s+=4,20),D(o,i,s+=20),o.set(e,s+=4),this._requests[f]={extended:"fstatvfs@openssh.com",cb:t};let a=Ye(this,o);if(this._debug){let c=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${c} fstatvfs@openssh.com`)}}ext_openssh_hardlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["hardlink@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(e),o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(4+1+4+4+20+4+s+4+o);D(a,a.length-4,0),a[4]=me.EXTENDED;let c=this._writeReqid=this._writeReqid+1&it;D(a,c,5),D(a,20,f),a.utf8Write("hardlink@openssh.com",f+=4,20),D(a,s,f+=20),a.utf8Write(e,f+=4,s),D(a,o,f+=s),a.utf8Write(t,f+=4,o),this._requests[c]={cb:n};let h=Ye(this,a);if(this._debug){let l=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} hardlink@openssh.com`)}}ext_openssh_fsync(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["fsync@openssh.com"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let i=e.length,s=9,o=Buffer.allocUnsafe(4+1+4+4+17+4+i);D(o,o.length-4,0),o[4]=me.EXTENDED;let f=this._writeReqid=this._writeReqid+1&it;D(o,f,5),D(o,17,s),o.utf8Write("fsync@openssh.com",s+=4,17),D(o,i,s+=17),o.set(e,s+=4),this._requests[f]={cb:t};let a=Ye(this,o);this._debug&&this._debug(`SFTP: Outbound: ${a?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["lsetstat@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=0,o=0;typeof t=="object"&&t!==null?(t=Yr(t),s=t.flags,o=t.nb):typeof t=="function"&&(n=t);let f=Buffer.byteLength(e),a=9,c=Buffer.allocUnsafe(4+1+4+4+20+4+f+4+o);D(c,c.length-4,0),c[4]=me.EXTENDED;let h=this._writeReqid=this._writeReqid+1&it;D(c,h,5),D(c,20,a),c.utf8Write("lsetstat@openssh.com",a+=4,20),D(c,f,a+=20),c.utf8Write(e,a+=4,f),D(c,s,a+=f),o&&(a+=4,o===Ce.length?c.set(Ce,a):vr(Ce,c,0,o,a),a+=o),this._requests[h]={cb:n};let l=Ye(this,c);if(this._debug){let g=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${g} lsetstat@openssh.com`)}}ext_openssh_expandPath(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["expand-path@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(e),s=9,o=Buffer.allocUnsafe(4+1+4+4+23+4+i);D(o,o.length-4,0),o[4]=me.EXTENDED;let f=this._writeReqid=this._writeReqid+1&it;D(o,f,5),D(o,23,s),o.utf8Write("expand-path@openssh.com",s+=4,23),D(o,i,s+=20),o.utf8Write(e,s+=4,i),this._requests[f]={cb:(c,h)=>{if(typeof t=="function"){if(c)return t(c);if(!h||!h.length)return t(new Error("Response missing expanded path"));t(void 0,h[0].filename)}}};let a=Ye(this,o);if(this._debug){let c=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${c} expand-path@openssh.com`)}}ext_copy_data(e,t,n,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["copy-data"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("Source handle is not a Buffer");if(!Buffer.isBuffer(i))throw new Error("Destination handle is not a Buffer");let a=0,c=Buffer.allocUnsafe(4+1+4+4+9+4+e.length+8+8+4+i.length+8);D(c,c.length-4,a),a+=4,c[a]=me.EXTENDED,++a;let h=this._writeReqid=this._writeReqid+1&it;D(c,h,a),a+=4,D(c,9,a),a+=4,c.utf8Write("copy-data",a,9),a+=9,D(c,e.length,a),a+=4,c.set(e,a),a+=e.length;for(let g=7;g>=0;--g)c[a+g]=t&255,t/=256;a+=8;for(let g=7;g>=0;--g)c[a+g]=n&255,n/=256;a+=8,D(c,i.length,a),a+=4,c.set(i,a),a+=i.length;for(let g=7;g>=0;--g)c[a+g]=s&255,s/=256;this._requests[h]={cb:o};let l=Ye(this,c);if(this._debug){let g=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${g} copy-data`)}}ext_home_dir(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["home-directory"]!=="1")throw new Error("Server does not support this extended request");if(typeof e!="string")throw new TypeError("username is not a string");let i=0,s=Buffer.byteLength(e),o=Buffer.allocUnsafe(4+1+4+4+14+4+s);D(o,o.length-4,i),i+=4,o[i]=me.EXTENDED,++i;let f=this._writeReqid=this._writeReqid+1&it;D(o,f,i),i+=4,D(o,14,i),i+=4,o.utf8Write("home-directory",i,14),i+=14,D(o,s,i),i+=4,o.utf8Write(e,i,s),i+=s,this._requests[f]={cb:(c,h)=>{if(typeof t=="function"){if(c)return t(c);if(!h||!h.length)return t(new Error("Response missing home directory"));t(void 0,h[0].filename)}}};let a=Ye(this,o);if(this._debug){let c=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${c} home-directory`)}}ext_users_groups(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["users-groups-by-id@openssh.com"]!=="1")throw new Error("Server does not support this extended request");if(!Array.isArray(e))throw new TypeError("uids is not an array");for(let c of e)if(!Number.isInteger(c)||c<0||c>2**32-1)throw new Error("uid values must all be 32-bit unsigned integers");if(!Array.isArray(t))throw new TypeError("gids is not an array");for(let c of t)if(!Number.isInteger(c)||c<0||c>2**32-1)throw new Error("gid values must all be 32-bit unsigned integers");let s=0,o=Buffer.allocUnsafe(4+1+4+4+30+4+4*e.length+4+4*t.length);D(o,o.length-4,s),s+=4,o[s]=me.EXTENDED,++s;let f=this._writeReqid=this._writeReqid+1&it;D(o,f,s),s+=4,D(o,30,s),s+=4,o.utf8Write("users-groups-by-id@openssh.com",s,30),s+=30,D(o,4*e.length,s),s+=4;for(let c of e)D(o,c,s),s+=4;D(o,4*t.length,s),s+=4;for(let c of t)D(o,c,s),s+=4;this._requests[f]={extended:"users-groups-by-id@openssh.com",cb:n};let a=Ye(this,o);if(this._debug){let c=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${c} users-groups-by-id@openssh.com`)}}handle(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let n=t.length;if(n>256)throw new Error("handle too large (> 256 bytes)");let i=9,s=Buffer.allocUnsafe(4+1+4+4+n);D(s,s.length-4,0),s[4]=Wt.HANDLE,D(s,e,5),D(s,n,i),n&&s.set(t,i+=4);let o=Ye(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} HANDLE`)}status(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");if(!sg.has(t))throw new Error(`Bad status code: ${t}`);n||(n="");let i=Buffer.byteLength(n),s=9,o=Buffer.allocUnsafe(4+1+4+4+4+i+4);D(o,o.length-4,0),o[4]=Wt.STATUS,D(o,e,5),D(o,t,s),D(o,i,s+=4),s+=4,i&&(o.utf8Write(n,s,i),s+=i),D(o,0,s);let f=Ye(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STATUS`)}data(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");let i=Buffer.isBuffer(t);if(!i&&typeof t!="string")throw new Error("data is not a Buffer or string");let s;!i&&!n&&(n=void 0,s=!0);let o=i?t.length:Buffer.byteLength(t,n),f=9,a=Buffer.allocUnsafe(4+1+4+4+o);D(a,a.length-4,0),a[4]=Wt.DATA,D(a,e,5),D(a,o,f),o&&(i?a.set(t,f+=4):s?a.utf8Write(t,f+=4,o):a.write(t,f+=4,o,n));let c=Ye(this,a);this._debug&&this._debug(`SFTP: Outbound: ${c?"Buffered":"Sending"} DATA`)}name(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(t)){if(typeof t!="object"||t===null)throw new Error("names is not an object or array");t=[t]}let n=t.length,i=0,s,o=[];for(let h=0;h<n;++h){let l=t[h],g=!l||!l.filename||typeof l.filename!="string"?"":l.filename;i+=4+Buffer.byteLength(g);let p=!l||!l.longname||typeof l.longname!="string"?"":l.longname;if(i+=4+Buffer.byteLength(p),typeof l.attrs=="object"&&l.attrs!==null){if(s=Yr(l.attrs),i+=4+s.nb,s.nb){let y;s.nb===Ce.length?y=new Uint8Array(Ce):(y=new Uint8Array(s.nb),vr(Ce,y,0,s.nb,0)),s.bytes=y}o.push(s)}else i+=4,o.push(null)}let f=9,a=Buffer.allocUnsafe(4+1+4+4+i);D(a,a.length-4,0),a[4]=Wt.NAME,D(a,e,5),D(a,n,f),f+=4;for(let h=0;h<n;++h){let l=t[h];{let p=!l||!l.filename||typeof l.filename!="string"?"":l.filename,y=Buffer.byteLength(p);D(a,y,f),f+=4,y&&(a.utf8Write(p,f,y),f+=y)}{let p=!l||!l.longname||typeof l.longname!="string"?"":l.longname,y=Buffer.byteLength(p);D(a,y,f),f+=4,y&&(a.utf8Write(p,f,y),f+=y)}let g=o[h];g?(D(a,g.flags,f),f+=4,g.flags&&g.bytes&&(a.set(g.bytes,f),f+=g.nb)):(D(a,0,f),f+=4)}let c=Ye(this,a);this._debug&&this._debug(`SFTP: Outbound: ${c?"Buffered":"Sending"} NAME`)}attrs(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof t!="object"||t===null)throw new Error("attrs is not an object");t=Yr(t);let n=t.flags,i=t.nb,s=9,o=Buffer.allocUnsafe(4+1+4+4+i);D(o,o.length-4,0),o[4]=Wt.ATTRS,D(o,e,5),D(o,n,s),i&&(s+=4,i===Ce.length?o.set(Ce,s):vr(Ce,o,0,i,s),s+=i);let f=Ye(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} ATTRS`)}};function hg(r){try{return Buffer.allocUnsafe(r)}catch(e){return e}}function Eu(r,e,t,n,i,s,o,f){let a=r._maxReadLen,c=Math.max(i-a,0);c&&(i=a);let h=e.length,l=9,g=s,p=Buffer.allocUnsafe(4+1+4+4+h+8+4);D(p,p.length-4,0),p[4]=me.READ;let y=r._writeReqid=r._writeReqid+1&it;D(p,y,5),D(p,h,l),p.set(e,l+=4),l+=h;for(let m=7;m>=0;--m)p[l+m]=g&255,g/=256;D(p,i,l+=8),typeof o!="function"&&(o=pu);let b=f||{nb:0,position:s,off:n,origOff:n,len:void 0,overflow:void 0,cb:(m,L,W)=>{let N=b.len,K=b.overflow;if(m){if(o._wantEOFError||m.code!==Ve.EOF)return o(m)}else{if(W>N)return o(new Error("Received more data than requested"));if(W===N&&K){b.nb+=W,b.position+=W,b.off+=W,Eu(r,e,t,b.off,K,b.position,o,b);return}}W=W||0,b.origOff===0&&t.length===b.nb?L=t:L=mn(t,b.origOff,b.origOff+b.nb+W),o(void 0,b.nb+W,L,b.position)},buffer:void 0};b.len=i,b.overflow=c,b.buffer=mn(t,n,n+i),r._requests[y]=b;let x=Ye(r,p);r._debug&&r._debug(`SFTP: Outbound: ${x?"Buffered":"Sending"} READ`)}function hu(r,e,t,n,i,s){let o=64,f=32768,a,c,h;typeof i=="function"?s=i:typeof i=="object"&&i!==null&&(typeof i.concurrency=="number"&&i.concurrency>0&&!isNaN(i.concurrency)&&(o=i.concurrency),typeof i.chunkSize=="number"&&i.chunkSize>0&&!isNaN(i.chunkSize)&&(f=i.chunkSize),typeof i.fileSize=="number"&&i.fileSize>0&&!isNaN(i.fileSize)&&(h=i.fileSize),typeof i.step=="function"&&(a=i.step),(typeof i.mode=="string"||typeof i.mode=="number")&&(c=Ef(i.mode)));let l,g=0,p=0,y=!1,b,x,m,L=f*o;function W(N){if(y)return;y=!0;let K=0,q;b||x?(q=()=>{--K===0&&s(N)},b&&(r===Nr||r.outgoing.state==="open")&&++K,x&&(e===Nr||e.outgoing.state==="open")&&++K,b&&(r===Nr||r.outgoing.state==="open")&&r.close(b,q),x&&(e===Nr||e.outgoing.state==="open")&&e.close(x,q)):s(N)}r.open(t,"r",(N,K)=>{if(N)return W(N);b=K,h===void 0?r.fstat(b,q):q(null,{size:h});function q(X,S){if(X){if(r!==Nr){r.stat(t,(I,O)=>{if(I)return W(X);q(null,O)});return}return W(X)}l=S.size,e.open(n,"w",(I,O)=>{if(I)return W(I);if(x=O,l<=0)return W();for(;L>l;){if(o===1){L=l;break}L-=f,--o}if(m=hg(L),m instanceof Error)return W(m);c!==void 0?e.fchmod(x,c,function J(te){if(te){e.chmod(n,c,ie=>J());return}ee()}):ee();function F(J,te,ie,T,M,Q){if(J)return W(J);M=M||0,e.write(x,m,M,te,T,z);function z(le){if(le)return W(le);if(p+=te,a&&a(p,te,l),te<Q)return ne(M,T+te,Q-te);if(p===l){e.close(x,ge=>{if(x=void 0,ge)return W(ge);r.close(b,at=>{if(b=void 0,at)return W(at);s()})});return}if(g>=l)return;let pe=g+f>l?l-g:f;ne(M,g,pe),g+=pe}}function H(J,te,ie){return(T,M,Q)=>{F(T,M,Q,te,J,ie)}}function ne(J,te,ie){r.read(b,m,J,ie,te,H(J,te,ie))}function ee(){let J=0,te=0;for(;g<l&&J<o;){let ie=g+f>l?l-g:f;ne(te,g,ie),te+=ie,g+=ie,++J}}})}})}function df(r,e,t,n,i,s,o){let f=typeof o=="function"?o:void 0;r.write(e,t,n,i,s,(a,c)=>{if(a)return r.close(e,()=>{f&&f(a)});c===i?r.close(e,f):(n+=c,i-=c,s+=c,df(r,e,t,n,i,s,f))})}var ds=class{constructor(e){this.mode=e&&e.mode,this.uid=e&&e.uid,this.gid=e&&e.gid,this.size=e&&e.size,this.atime=e&&e.atime,this.mtime=e&&e.mtime,this.extended=e&&e.extended}isDirectory(){return(this.mode&qt.S_IFMT)===qt.S_IFDIR}isFile(){return(this.mode&qt.S_IFMT)===qt.S_IFREG}isBlockDevice(){return(this.mode&qt.S_IFMT)===qt.S_IFBLK}isCharacterDevice(){return(this.mode&qt.S_IFMT)===qt.S_IFCHR}isSymbolicLink(){return(this.mode&qt.S_IFMT)===qt.S_IFLNK}isFIFO(){return(this.mode&qt.S_IFMT)===qt.S_IFIFO}isSocket(){return(this.mode&qt.S_IFMT)===qt.S_IFSOCK}};function Yr(r){let e=0,t=0;if(typeof r=="object"&&r!==null){if(typeof r.size=="number"){e|=yr.SIZE;let n=r.size;Ce[t++]=n/72057594037927940,Ce[t++]=n/281474976710656,Ce[t++]=n/1099511627776,Ce[t++]=n/4294967296,Ce[t++]=n/16777216,Ce[t++]=n/65536,Ce[t++]=n/256,Ce[t++]=n}if(typeof r.uid=="number"&&typeof r.gid=="number"){e|=yr.UIDGID;let n=r.uid,i=r.gid;Ce[t++]=n>>>24,Ce[t++]=n>>>16,Ce[t++]=n>>>8,Ce[t++]=n,Ce[t++]=i>>>24,Ce[t++]=i>>>16,Ce[t++]=i>>>8,Ce[t++]=i}if(typeof r.mode=="number"||typeof r.mode=="string"){let n=Ef(r.mode);e|=yr.PERMISSIONS,Ce[t++]=n>>>24,Ce[t++]=n>>>16,Ce[t++]=n>>>8,Ce[t++]=n}if((typeof r.atime=="number"||hf(r.atime))&&(typeof r.mtime=="number"||hf(r.mtime))){let n=Sn(r.atime),i=Sn(r.mtime);e|=yr.ACMODTIME,Ce[t++]=n>>>24,Ce[t++]=n>>>16,Ce[t++]=n>>>8,Ce[t++]=n,Ce[t++]=i>>>24,Ce[t++]=i>>>16,Ce[t++]=i>>>8,Ce[t++]=i}}return{flags:e,nb:t}}function Sn(r){if(typeof r=="number"&&r===r)return r;if(hf(r))return parseInt(r.getTime()/1e3,10);throw new Error(`Cannot parse time: ${r}`)}function Ef(r){if(typeof r=="number"&&r===r)return r;if(typeof r=="string")return Ef(parseInt(r,8));throw new Error(`Cannot parse mode: ${r}`)}var gf={r:xe.READ,"r+":xe.READ|xe.WRITE,w:xe.TRUNC|xe.CREAT|xe.WRITE,wx:xe.TRUNC|xe.CREAT|xe.WRITE|xe.EXCL,xw:xe.TRUNC|xe.CREAT|xe.WRITE|xe.EXCL,"w+":xe.TRUNC|xe.CREAT|xe.READ|xe.WRITE,"wx+":xe.TRUNC|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL,"xw+":xe.TRUNC|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL,a:xe.APPEND|xe.CREAT|xe.WRITE,ax:xe.APPEND|xe.CREAT|xe.WRITE|xe.EXCL,xa:xe.APPEND|xe.CREAT|xe.WRITE|xe.EXCL,"a+":xe.APPEND|xe.CREAT|xe.READ|xe.WRITE,"ax+":xe.APPEND|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL,"xa+":xe.APPEND|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL};function bu(r){let e=gf[r];return e!==void 0?e:null}var lg=(()=>{let r=Object.keys(gf);return e=>{for(let t=0;t<r.length;++t){let n=r[t];if(gf[n]===e)return n}return null}})();function In(r){let e=k.readUInt32BE();if(e===void 0)return;let t=new ds;if(e&yr.SIZE){let n=k.readUInt64BE(r);if(n===void 0)return;t.size=n}if(e&yr.UIDGID){let n=k.readUInt32BE(),i=k.readUInt32BE();if(i===void 0)return;t.uid=n,t.gid=i}if(e&yr.PERMISSIONS){let n=k.readUInt32BE();if(n===void 0)return;t.mode=n}if(e&yr.ACMODTIME){let n=k.readUInt32BE(),i=k.readUInt32BE();if(i===void 0)return;t.atime=n,t.mtime=i}if(e&yr.EXTENDED){let n=k.readUInt32BE();if(n===void 0)return;let i={};for(let s=0;s<n;++s){let o=k.readString(!0),f=k.readString();if(f===void 0)return;i[o]=f}t.extended=i}return t}function Ye(r,e){let t=yu(r,e);return t!==void 0?(r._buffer.push(t),!1):!0}function yu(r,e){let t=r.outgoing;if(t.state!=="open")return;if(t.window===0)return r._waitWindow=!0,r._chunkcb=lu,e;let n,i=e.length,s=0;for(;i-s>0&&t.window>0;){let o=Math.min(i-s,t.window,t.packetSize);t.window-=o,t.window===0&&(r._waitWindow=!0,r._chunkcb=lu),s===0&&o===i?r._protocol.channelData(r.outgoing.id,e):r._protocol.channelData(r.outgoing.id,mn(e,s,s+o)),s+=o}return i-s>0&&(s>0?n=mn(e,s,i):n=e),n}function lu(){this._chunkcb=void 0;let r=this._buffer,e=0;for(;e<r.length;){let t=r[e],n=yu(this,t);if(n!==void 0){n!==t&&(r[e]=n),e>0&&(this._buffer=r.slice(e));return}++e}e>0&&(this._buffer=[])}function et(r,e,t){let n=new Error(e);return n.level="sftp-protocol",!t&&r._debug&&r._debug(`SFTP: Inbound: ${e}`),r.emit("error",n),r.destroy(),wu(r),!1}function wu(r){let e=Object.keys(r._requests);if(e.length===0)return;let t=r._requests;r._requests={};let n=new Error("No response from server");for(let i=0;i<e.length;++i){let s=t[e[i]];typeof s.cb=="function"&&s.cb(n)}}function dg(r,e){let t=9,n=Buffer.allocUnsafe(4+1+4+4+18);D(n,n.length-4,0),n[4]=me.EXTENDED;let i=r._writeReqid=r._writeReqid+1&it;D(n,i,5),D(n,18,t),n.utf8Write("limits@openssh.com",t+=4,18),r._requests[i]={extended:"limits@openssh.com",cb:e};let s=Ye(r,n);if(r._debug){let o=s?"Buffered":"Sending";r._debug(`SFTP: Outbound: ${o} limits@openssh.com`)}}var gg={[Wt.VERSION]:(r,e)=>{if(r._version!==-1)return et(r,"Duplicate VERSION packet");let t={};k.init(e,1);let n=k.readUInt32BE();for(;k.avail();){let i=k.readString(!0),s=k.readString(!0);if(s===void 0){n=void 0;break}t[i]=s}if(k.clear(),n===void 0)return et(r,"Malformed VERSION packet");if(r._debug){let i=Object.keys(t);i.length?r._debug(`SFTP: Inbound: Received VERSION (v${n}, exts:${i})`):r._debug(`SFTP: Inbound: Received VERSION (v${n})`)}if(r._version=n,r._extensions=t,t["limits@openssh.com"]==="1")return dg(r,(i,s)=>{i||(s.maxPktLen>0&&(r._maxOutPktLen=s.maxPktLen),s.maxReadLen>0&&(r._maxReadLen=s.maxReadLen),s.maxWriteLen>0&&(r._maxWriteLen=s.maxWriteLen),r.maxOpenHandles=s.maxOpenHandles>0?s.maxOpenHandles:1/0),r.emit("ready")});r.emit("ready")},[Wt.STATUS]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readUInt32BE(),i=k.readString(!0);if(k.clear(),r._debug){let o=JSON.stringify(i);r._debug(`SFTP: Inbound: Received STATUS (id:${t}, ${n}, ${o})`)}let s=r._requests[t];if(delete r._requests[t],s&&typeof s.cb=="function"){if(n===Ve.OK){s.cb();return}let o=new Error(i||og[n]||"Unknown status");o.code=n,s.cb(o)}},[Wt.HANDLE]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString();if(k.clear(),n===void 0)return t!==void 0&&delete r._requests[t],et(r,"Malformed HANDLE packet");r._debug&&r._debug(`SFTP: Inbound: Received HANDLE (id:${t})`);let i=r._requests[t];delete r._requests[t],i&&typeof i.cb=="function"&&i.cb(void 0,n)},[Wt.DATA]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n;if(t!==void 0&&(n=r._requests[t],delete r._requests[t]),n&&typeof n.cb=="function")if(n.buffer){let i=k.readString(n.buffer);if(k.clear(),i!==void 0){r._debug&&r._debug(`SFTP: Inbound: Received DATA (id:${t}, ${i})`),n.cb(void 0,n.buffer,i);return}}else{let i=k.readString();if(k.clear(),i!==void 0){r._debug&&r._debug(`SFTP: Inbound: Received DATA (id:${t}, ${i.length})`),n.cb(void 0,i);return}}else{let i=k.skipString();if(k.clear(),i!==void 0){r._debug&&r._debug(`SFTP: Inbound: Received DATA (id:${t}, ${i})`);return}}return et(r,"Malformed DATA packet")},[Wt.NAME]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n;t!==void 0&&(n=r._requests[t],delete r._requests[t]);let i=k.readUInt32BE();if(i!==void 0){let s=[];for(let o=0;o<i;++o){let f=k.readString(!0),a=k.readString(!0),c=In(r._biOpt);if(c===void 0){s=void 0;break}s.push({filename:f,longname:a,attrs:c})}if(s!==void 0){r._debug&&r._debug(`SFTP: Inbound: Received NAME (id:${t}, ${s.length})`),k.clear(),n&&typeof n.cb=="function"&&n.cb(void 0,s);return}}return k.clear(),et(r,"Malformed NAME packet")},[Wt.ATTRS]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n;t!==void 0&&(n=r._requests[t],delete r._requests[t]);let i=In(r._biOpt);if(k.clear(),i!==void 0){r._debug&&r._debug(`SFTP: Inbound: Received ATTRS (id:${t})`),n&&typeof n.cb=="function"&&n.cb(void 0,i);return}return et(r,"Malformed ATTRS packet")},[Wt.EXTENDED]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE();if(t!==void 0){let n=r._requests[t];if(n)switch(delete r._requests[t],n.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{let i=r._biOpt,s={f_bsize:k.readUInt64BE(i),f_frsize:k.readUInt64BE(i),f_blocks:k.readUInt64BE(i),f_bfree:k.readUInt64BE(i),f_bavail:k.readUInt64BE(i),f_files:k.readUInt64BE(i),f_ffree:k.readUInt64BE(i),f_favail:k.readUInt64BE(i),f_sid:k.readUInt64BE(i),f_flag:k.readUInt64BE(i),f_namemax:k.readUInt64BE(i)};if(s.f_namemax===void 0)break;r._debug&&r._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${t}, ${n.extended})`),k.clear(),typeof n.cb=="function"&&n.cb(void 0,s);return}case"limits@openssh.com":{let i={maxPktLen:k.readUInt64BE(),maxReadLen:k.readUInt64BE(),maxWriteLen:k.readUInt64BE(),maxOpenHandles:k.readUInt64BE()};if(i.maxOpenHandles===void 0)break;r._debug&&r._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${t}, ${n.extended})`),k.clear(),typeof n.cb=="function"&&n.cb(void 0,i);return}case"users-groups-by-id@openssh.com":{let i=k.readUInt32BE();if(i===void 0)break;let s=new Array(i);for(let a=0;a<s.length;++a)s[a]=k.readString(!0);let o=k.readUInt32BE();if(o===void 0)break;let f=new Array(o);for(let a=0;a<f.length;++a)f[a]=k.readString(!0);if(f.length>0&&f[f.length-1]===void 0)break;r._debug&&r._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${t}, ${n.extended})`),k.clear(),typeof n.cb=="function"&&n.cb(void 0,s,f);return}default:r._debug&&r._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${t}, ???)`),k.clear(),typeof n.cb=="function"&&n.cb();return}else{r._debug&&r._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${t}, ???)`),k.clear();return}}return k.clear(),et(r,"Malformed EXTENDED_REPLY packet")}},Ag={[me.INIT]:(r,e)=>{if(r._version!==-1)return et(r,"Duplicate INIT packet");let t={};k.init(e,1);let n=k.readUInt32BE();for(;k.avail();){let i=k.readString(!0),s=k.readString(!0);if(s===void 0){n=void 0;break}t[i]=s}if(k.clear(),n===void 0)return et(r,"Malformed INIT packet");if(r._debug){let i=Object.keys(t);i.length?r._debug(`SFTP: Inbound: Received INIT (v${n}, exts:${i})`):r._debug(`SFTP: Inbound: Received INIT (v${n})`)}Ye(r,ag),r._version=n,r._extensions=t,r.emit("ready")},[me.OPEN]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0),i=k.readUInt32BE(),s=In(r._biOpt);if(k.clear(),s===void 0)return et(r,"Malformed OPEN packet");r._debug&&r._debug(`SFTP: Inbound: Received OPEN (id:${t})`),r.emit("OPEN",t,n,i,s)||r.status(t,Ve.OP_UNSUPPORTED)},[me.CLOSE]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString();if(k.clear(),n===void 0||n.length>256)return et(r,"Malformed CLOSE packet");r._debug&&r._debug(`SFTP: Inbound: Received CLOSE (id:${t})`),r.emit("CLOSE",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.READ]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(),i=k.readUInt64BE(r._biOpt),s=k.readUInt32BE();if(k.clear(),s===void 0||n.length>256)return et(r,"Malformed READ packet");r._debug&&r._debug(`SFTP: Inbound: Received READ (id:${t})`),r.emit("READ",t,n,i,s)||r.status(t,Ve.OP_UNSUPPORTED)},[me.WRITE]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(),i=k.readUInt64BE(r._biOpt),s=k.readString();if(k.clear(),s===void 0||n.length>256)return et(r,"Malformed WRITE packet");r._debug&&r._debug(`SFTP: Inbound: Received WRITE (id:${t})`),r.emit("WRITE",t,n,i,s)||r.status(t,Ve.OP_UNSUPPORTED)},[me.LSTAT]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(k.clear(),n===void 0)return et(r,"Malformed LSTAT packet");r._debug&&r._debug(`SFTP: Inbound: Received LSTAT (id:${t})`),r.emit("LSTAT",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.FSTAT]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString();if(k.clear(),n===void 0||n.length>256)return et(r,"Malformed FSTAT packet");r._debug&&r._debug(`SFTP: Inbound: Received FSTAT (id:${t})`),r.emit("FSTAT",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.SETSTAT]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0),i=In(r._biOpt);if(k.clear(),i===void 0)return et(r,"Malformed SETSTAT packet");r._debug&&r._debug(`SFTP: Inbound: Received SETSTAT (id:${t})`),r.emit("SETSTAT",t,n,i)||r.status(t,Ve.OP_UNSUPPORTED)},[me.FSETSTAT]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(),i=In(r._biOpt);if(k.clear(),i===void 0||n.length>256)return et(r,"Malformed FSETSTAT packet");r._debug&&r._debug(`SFTP: Inbound: Received FSETSTAT (id:${t})`),r.emit("FSETSTAT",t,n,i)||r.status(t,Ve.OP_UNSUPPORTED)},[me.OPENDIR]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(k.clear(),n===void 0)return et(r,"Malformed OPENDIR packet");r._debug&&r._debug(`SFTP: Inbound: Received OPENDIR (id:${t})`),r.emit("OPENDIR",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.READDIR]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString();if(k.clear(),n===void 0||n.length>256)return et(r,"Malformed READDIR packet");r._debug&&r._debug(`SFTP: Inbound: Received READDIR (id:${t})`),r.emit("READDIR",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.REMOVE]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(k.clear(),n===void 0)return et(r,"Malformed REMOVE packet");r._debug&&r._debug(`SFTP: Inbound: Received REMOVE (id:${t})`),r.emit("REMOVE",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.MKDIR]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0),i=In(r._biOpt);if(k.clear(),i===void 0)return et(r,"Malformed MKDIR packet");r._debug&&r._debug(`SFTP: Inbound: Received MKDIR (id:${t})`),r.emit("MKDIR",t,n,i)||r.status(t,Ve.OP_UNSUPPORTED)},[me.RMDIR]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(k.clear(),n===void 0)return et(r,"Malformed RMDIR packet");r._debug&&r._debug(`SFTP: Inbound: Received RMDIR (id:${t})`),r.emit("RMDIR",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.REALPATH]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(k.clear(),n===void 0)return et(r,"Malformed REALPATH packet");r._debug&&r._debug(`SFTP: Inbound: Received REALPATH (id:${t})`),r.emit("REALPATH",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.STAT]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(k.clear(),n===void 0)return et(r,"Malformed STAT packet");r._debug&&r._debug(`SFTP: Inbound: Received STAT (id:${t})`),r.emit("STAT",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.RENAME]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0),i=k.readString(!0);if(k.clear(),i===void 0)return et(r,"Malformed RENAME packet");r._debug&&r._debug(`SFTP: Inbound: Received RENAME (id:${t})`),r.emit("RENAME",t,n,i)||r.status(t,Ve.OP_UNSUPPORTED)},[me.READLINK]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(k.clear(),n===void 0)return et(r,"Malformed READLINK packet");r._debug&&r._debug(`SFTP: Inbound: Received READLINK (id:${t})`),r.emit("READLINK",t,n)||r.status(t,Ve.OP_UNSUPPORTED)},[me.SYMLINK]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0),i=k.readString(!0);if(k.clear(),i===void 0)return et(r,"Malformed SYMLINK packet");r._debug&&r._debug(`SFTP: Inbound: Received SYMLINK (id:${t})`);let s;r._isOpenSSH?s=r.emit("SYMLINK",t,i,n):s=r.emit("SYMLINK",t,n,i),s||r.status(t,Ve.OP_UNSUPPORTED)},[me.EXTENDED]:(r,e)=>{k.init(e,1);let t=k.readUInt32BE(),n=k.readString(!0);if(n===void 0)return k.clear(),et(r,"Malformed EXTENDED packet");let i;k.avail()&&(i=k.readRaw()),k.clear(),r._debug&&r._debug(`SFTP: Inbound: Received EXTENDED (id:${t})`),r.emit("EXTENDED",t,n,i)||r.status(t,Ve.OP_UNSUPPORTED)}},{ERR_INVALID_ARG_TYPE:_g,ERR_OUT_OF_RANGE:ls,validateNumber:pg}=cu(),du=128,Qt,Af=[];function Eg(r){Af.length>0?Qt=Af.pop():Qt=Buffer.allocUnsafe(r),Qt.used=0}function _f(r,e){if(!Number.isSafeInteger(r))throw pg(r,e),Number.isInteger(r)?new ls(e,">= 0 and <= 2 ** 53 - 1",r):new ls(e,"an integer",r);if(r<0)throw new ls(e,">= 0 and <= 2 ** 53 - 1",r)}function uf(r){return r+7&-8}function wr(r,e,t){if(t===void 0)t={};else if(typeof t=="string")t={encoding:t};else{if(t===null||typeof t!="object")throw new TypeError('"options" argument must be a string or an object');t=Object.create(t)}if(t.highWaterMark===void 0&&(t.highWaterMark=64*1024),t.emitClose=!1,t.autoDestroy=!1,Au.call(this,t),this.path=e,this.flags=t.flags===void 0?"r":t.flags,this.mode=t.mode===void 0?438:t.mode,this.start=t.start,this.end=t.end,this.autoClose=t.autoClose===void 0?!0:t.autoClose,this.pos=0,this.bytesRead=0,this.isClosed=!1,this.handle=t.handle===void 0?null:t.handle,this.sftp=r,this._opening=!1,this.start!==void 0&&(_f(this.start,"start"),this.pos=this.start),this.end===void 0)this.end=1/0;else if(this.end!==1/0&&(_f(this.end,"end"),this.start!==void 0&&this.start>this.end))throw new ls("start",`<= "end" (here: ${this.end})`,this.start);this.on("end",function(){this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}_u(wr,Au);wr.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(r,e)=>{if(this._opening=!1,r){this.emit("error",r),this.autoClose&&this.destroy();return}this.handle=e,this.emit("open",e),this.emit("ready"),this.read()}))};wr.prototype._read=function(r){if(!Buffer.isBuffer(this.handle))return this.once("open",()=>this._read(r));if(this.destroyed)return;(!Qt||Qt.length-Qt.used<du)&&Eg(this.readableHighWaterMark||this._readableState.highWaterMark);let e=Qt,t=Math.min(Qt.length-Qt.used,r),n=Qt.used;if(this.end!==void 0&&(t=Math.min(this.end-this.pos+1,t)),t<=0)return this.push(null);this.sftp.read(this.handle,Qt,Qt.used,t,this.pos,(i,s)=>{if(i){this.emit("error",i),this.autoClose&&this.destroy();return}let o=null;if(n+t===e.used&&e===Qt)e.used=uf(e.used+s-t);else{let f=n+t&-8,a=uf(n+s);f-a>=du&&Af.push(e.slice(a,f))}s>0&&(this.bytesRead+=s,o=e.slice(n,n+s)),this.pos+=s,this.push(o)}),Qt.used=uf(Qt.used+t)};wr.prototype._destroy=function(r,e){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",gu.bind(null,this,e,r));return}gu(this,e,r),this.handle=null,this._opening=!1};function gu(r,e,t){if(!r.handle)return n();r.sftp.close(r.handle,n);function n(i){i=i||t,e(i),r.isClosed=!0,i||r.emit("close")}}wr.prototype.close=function(r){this.destroy(null,r)};Object.defineProperty(wr.prototype,"pending",{get(){return this.handle===null},configurable:!0});function Jt(r,e,t){if(t===void 0)t={};else if(typeof t=="string")t={encoding:t};else{if(t===null||typeof t!="object")throw new TypeError('"options" argument must be a string or an object');t=Object.create(t)}t.emitClose=!1,t.autoDestroy=!1,pf.call(this,t),this.path=e,this.flags=t.flags===void 0?"w":t.flags,this.mode=t.mode===void 0?438:t.mode,this.start=t.start,this.autoClose=t.autoClose===void 0?!0:t.autoClose,this.pos=0,this.bytesWritten=0,this.isClosed=!1,this.handle=t.handle===void 0?null:t.handle,this.sftp=r,this._opening=!1,this.start!==void 0&&(_f(this.start,"start"),this.pos=this.start),t.encoding&&this.setDefaultEncoding(t.encoding),this.on("finish",function(){this._writableState.finalCalled||this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}_u(Jt,pf);Jt.prototype._final=function(r){this.autoClose&&this.destroy(),r()};Jt.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(r,e)=>{if(this._opening=!1,r){this.emit("error",r),this.autoClose&&this.destroy();return}this.handle=e;let t=n=>{if(n){this.sftp.chmod(this.path,this.mode,i=>t());return}if(this.flags[0]==="a"){let i=(s,o)=>{if(s){this.sftp.stat(this.path,(f,a)=>{if(f){this.destroy(),this.emit("error",s);return}i(null,a)});return}this.pos=o.size,this.emit("open",e),this.emit("ready")};this.sftp.fstat(e,i);return}this.emit("open",e),this.emit("ready")};this.sftp.fchmod(e,this.mode,t)}))};Jt.prototype._write=function(r,e,t){if(!Buffer.isBuffer(r)){let n=new _g("data","Buffer",r);return this.emit("error",n)}if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._write(r,e,t)});this.sftp.write(this.handle,r,0,r.length,this.pos,(n,i)=>{if(n)return this.autoClose&&this.destroy(),t(n);this.bytesWritten+=i,t()}),this.pos+=r.length};Jt.prototype._writev=function(r,e){if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._writev(r,e)});let t=this.sftp,n=this.handle,i=r.length,s=(o,f)=>{if(o)return this.destroy(),e(o);this.bytesWritten+=f,--i===0&&e()};for(let o=0;o<r.length;++o){let f=r[o].chunk;t.write(n,f,0,f.length,this.pos,s),this.pos+=f.length}};typeof pf.prototype.destroy!="function"&&(Jt.prototype.destroy=wr.prototype.destroy);Jt.prototype._destroy=wr.prototype._destroy;Jt.prototype.close=function(r){if(r){if(this.isClosed){process.nextTick(r);return}this.on("close",r)}this.autoClose||this.on("finish",this.destroy.bind(this)),this.end()};Jt.prototype.destroySoon=Jt.prototype.end;Object.defineProperty(Jt.prototype,"pending",{get(){return this.handle===null},configurable:!0});xu.exports={flagsToString:lg,OPEN_MODE:xe,SFTP:lf,Stats:ds,STATUS_CODE:Ve,stringToFlags:bu}});var If=_e((Tb,Bu)=>{"use strict";var{Duplex:bg,Readable:yg,Writable:wg}=require("stream"),{CHANNEL_EXTENDED_DATATYPE:{STDERR:Su}}=pr(),{bufferSlice:gs}=rr(),xg=32*1024,ai=2*1024*1024,xf=ai/2,bf=class extends yg{constructor(e,t){super(t),this._channel=e}_read(e){this._channel._waitChanDrain&&(this._channel._waitChanDrain=!1,this._channel.incoming.window<=xf&&Sf(this._channel))}},yf=class extends wg{constructor(e){super({highWaterMark:ai}),this._channel=e}_write(e,t,n){let i=this._channel,s=i._client._protocol,o=i.outgoing,f=o.packetSize,a=o.id,c=o.window,h=e.length,l=0;if(o.state==="open"){for(;h-l>0&&c>0;){let g=h-l;g>c&&(g=c),g>f&&(g=f),l===0&&g===h?s.channelExtData(a,e,Su):s.channelExtData(a,gs(e,l,l+g),Su),l+=g,c-=g}if(o.window=c,h-l>0){c===0&&(i._waitWindow=!0),l>0?i._chunkErr=gs(e,l,h):i._chunkErr=e,i._chunkcbErr=n;return}n()}}},wf=class extends bg{constructor(e,t,n){let i={highWaterMark:ai,allowHalfOpen:!n||n&&n.allowHalfOpen!==!1,emitClose:!1};super(i),this.allowHalfOpen=i.allowHalfOpen;let s=!!(n&&n.server);this.server=s,this.type=t.type,this.subtype=void 0,this.incoming=t.incoming,this.outgoing=t.outgoing,this._callbacks=[],this._client=e,this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this.stdin=this.stdout=this,s?this.stderr=new yf(this):this.stderr=new bf(this,i),this._waitWindow=!1,this._waitChanDrain=!1,this._chunk=void 0,this._chunkcb=void 0,this._chunkErr=void 0,this._chunkcbErr=void 0,this.on("finish",Iu).on("prefinish",Iu),this.on("end",mu).on("close",mu)}_read(e){this._waitChanDrain&&(this._waitChanDrain=!1,this.incoming.window<=xf&&Sf(this))}_write(e,t,n){let i=this._client._protocol,s=this.outgoing,o=s.packetSize,f=s.id,a=s.window,c=e.length,h=0;if(s.state==="open"){for(;c-h>0&&a>0;){let l=c-h;l>a&&(l=a),l>o&&(l=o),h===0&&l===c?i.channelData(f,e):i.channelData(f,gs(e,h,h+l)),h+=l,a-=l}if(s.window=a,c-h>0){a===0&&(this._waitWindow=!0),h>0?this._chunk=gs(e,h,c):this._chunk=e,this._chunkcb=n;return}n()}}eof(){this.outgoing.state==="open"&&(this.outgoing.state="eof",this._client._protocol.channelEOF(this.outgoing.id))}close(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._client._protocol.channelClose(this.outgoing.id))}destroy(){return this.end(),this.close(),this}setWindow(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.windowChange(this.outgoing.id,e,t,n,i)}signal(e){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.signal(this.outgoing.id,e)}exit(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&(typeof e=="number"?this._client._protocol.exitStatus(this.outgoing.id,e):this._client._protocol.exitSignal(this.outgoing.id,e,t,n))}};function Iu(){this.eof(),(this.server||!this.allowHalfOpen)&&this.close(),this.writable=!1}function mu(){this.readable=!1}function Sf(r){if(r.outgoing.state==="closed")return;let e=ai-r.incoming.window;e<=0||(r.incoming.window+=e,r._client._protocol.channelWindowAdjust(r.outgoing.id,e))}Bu.exports={Channel:wf,MAX_WINDOW:ai,PACKET_SIZE:xg,windowAdjust:Sf,WINDOW_THRESHOLD:xf}});var Cf=_e((Lb,ku)=>{"use strict";var{SFTP:Sg}=fi(),ci=2**32-1;function Cu(r,e,t,n){if(r._chanMgr.remove(e),typeof n!="function")return;let i;t instanceof Error?i=t:typeof t=="object"&&t!==null?(i=new Error(`(SSH) Channel open failure: ${t.description}`),i.reason=t.reason):(i=new Error("(SSH) Channel open failure: server closed channel unexpectedly"),i.reason=""),n(i)}function Ru(r,e,t,n,i){if(typeof t=="function"){Cu(r,e,n,t);return}if(typeof t!="object"||t===null||t.incoming&&t.incoming.state==="closed"||(r._chanMgr.remove(e),t.server&&t.constructor.name==="Session"))return;t.incoming.state="closed",t.readable&&t.push(null),t.server?t.stderr.writable&&t.stderr.end():t.stderr.readable&&t.stderr.push(null),t.constructor!==Sg&&(t.outgoing.state==="open"||t.outgoing.state==="eof")&&!i&&t.close(),t.outgoing.state==="closing"&&(t.outgoing.state="closed");let s=t._readableState,o=t._writableState;o&&!o.ending&&!o.finished&&!i&&t.end();let f=t._callbacks;t._callbacks=[];for(let a=0;a<f.length;++a)f[a](!0);if(t.server)!t.readable||t.destroyed||s&&s.endEmitted?t.emit("close"):t.once("end",()=>t.emit("close"));else{let a;switch(t.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":a=()=>t.emit("close");break;default:{let h=t._exit;a=()=>{h.code===null?t.emit("close",h.code,h.signal,h.dump,h.desc):t.emit("close",h.code)}}}!t.readable||t.destroyed||s&&s.endEmitted?a():t.once("end",a);let c=t.stderr._readableState;!t.stderr.readable||t.stderr.destroyed||c&&c.endEmitted?t.stderr.emit("close"):t.stderr.once("end",()=>t.stderr.emit("close"))}}var Bf=class{constructor(e){this._client=e,this._channels={},this._cur=-1,this._count=0}add(e){let t;if(this._cur<ci)t=++this._cur;else if(this._count===0)this._cur=0,t=0;else{let n=this._channels;for(let i=0;i<ci;++i)if(n[i]===void 0){t=i;break}}return t===void 0?-1:(this._channels[t]=e||!0,++this._count,t)}update(e,t){if(typeof e!="number"||e<0||e>=ci||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);t&&this._channels[e]&&(this._channels[e]=t)}get(e){if(typeof e!="number"||e<0||e>=ci||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);return this._channels[e]}remove(e){if(typeof e!="number"||e<0||e>=ci||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);this._channels[e]&&(delete this._channels[e],this._count&&--this._count)}cleanup(e){let t=this._channels;this._channels={},this._cur=-1,this._count=0;let n=Object.keys(t),i=this._client;for(let s=0;s<n.length;++s){let o=+n[s],f=t[o];Ru(i,o,f._channel||f,e,!0)}}},mf=(()=>{let r=Object.prototype.toString;return e=>r.call(e)==="[object RegExp]"})();function Ig(r,e,t){if(Array.isArray(r)&&r.length>0){for(let n=0;n<r.length;++n)if(t.indexOf(r[n])===-1)throw new Error(`Unsupported algorithm: ${r[n]}`);return r}if(typeof r=="object"&&r!==null){let n=Object.keys(r),i=e;for(let s=0;s<n.length;++s){let o=n[s],f=r[o];switch(o){case"append":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let c=f[a];if(typeof c=="string"){if(!c||i.indexOf(c)!==-1)continue;if(t.indexOf(c)===-1)throw new Error(`Unsupported algorithm: ${c}`);i===e&&(i=i.slice()),i.push(c)}else if(mf(c))for(let h=0;h<t.length;++h){let l=t[h];if(c.test(l)){if(i.indexOf(l)!==-1)continue;i===e&&(i=i.slice()),i.push(l)}}}break;case"prepend":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=f.length;a>=0;--a){let c=f[a];if(typeof c=="string"){if(!c||i.indexOf(c)!==-1)continue;if(t.indexOf(c)===-1)throw new Error(`Unsupported algorithm: ${c}`);i===e&&(i=i.slice()),i.unshift(c)}else if(mf(c))for(let h=t.length;h>=0;--h){let l=t[h];if(c.test(l)){if(i.indexOf(l)!==-1)continue;i===e&&(i=i.slice()),i.unshift(l)}}}break;case"remove":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let c=f[a];if(typeof c=="string"){if(!c)continue;let h=i.indexOf(c);if(h===-1)continue;i===e&&(i=i.slice()),i.splice(h,1)}else if(mf(c))for(let h=0;h<i.length;++h)c.test(i[h])&&(i===e&&(i=i.slice()),i.splice(h,1),--h)}break}}return i}return e}ku.exports={ChannelManager:Bf,generateAlgorithmList:Ig,onChannelOpenFailure:Cu,onCHANNEL_CLOSE:Ru,isWritable:r=>r&&r.writable&&r._readableState&&r._readableState.ended===!1}});var Tf=_e((Ob,zu)=>{"use strict";var{createHash:mg,getHashes:Bg,randomFillSync:Cg}=require("crypto"),{Socket:Rg}=require("net"),{lookup:kg}=require("dns"),vg=require("events"),Ng=Bg(),{COMPAT:ju,CHANNEL_EXTENDED_DATATYPE:{STDERR:Tg},CHANNEL_OPEN_FAILURE:ui,DEFAULT_CIPHER:vu,DEFAULT_COMPRESSION:Nu,DEFAULT_KEX:Tu,DEFAULT_MAC:Lu,DEFAULT_SERVER_HOST_KEY:Ou,DISCONNECT_REASON:Uu,DISCONNECT_REASON_BY_VALUE:Lg,SUPPORTED_CIPHER:Og,SUPPORTED_COMPRESSION:Ug,SUPPORTED_KEX:Pg,SUPPORTED_MAC:Dg,SUPPORTED_SERVER_HOST_KEY:Hg}=pr(),{init:Qg}=Br(),Mg=af(),{parseKey:ps}=kr(),{SFTP:Fg}=fi(),{bufferCopy:Pu,makeBufferParser:Xu,makeError:qg,readUInt32BE:Wg,sigSSHToASN1:Kg,writeUInt32BE:Rf}=rr(),{AgentContext:Du,createAgent:Hu,isAgent:Qu}=Ko(),{Channel:Vu,MAX_WINDOW:Es,PACKET_SIZE:bs,windowAdjust:Mu,WINDOW_THRESHOLD:Fu}=If(),{ChannelManager:$g,generateAlgorithmList:hi,isWritable:It,onChannelOpenFailure:Gg,onCHANNEL_CLOSE:Yg}=Cf(),As=Xu(),_s=Xu(),li=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/,vf=r=>{},Nf=class extends vg{constructor(){super(),this.config={host:void 0,port:void 0,localAddress:void 0,localPort:void 0,forceIPv4:void 0,forceIPv6:void 0,keepaliveCountMax:void 0,keepaliveInterval:void 0,readyTimeout:void 0,ident:void 0,username:void 0,password:void 0,privateKey:void 0,tryKeyboard:void 0,agent:void 0,allowAgentFwd:void 0,authHandler:void 0,hostHashAlgo:void 0,hostHashCb:void 0,strictVendor:void 0,debug:void 0},this._agent=void 0,this._readyTimeout=void 0,this._chanMgr=void 0,this._callbacks=void 0,this._forwarding=void 0,this._forwardingUnix=void 0,this._acceptX11=void 0,this._agentFwdEnabled=void 0,this._remoteVer=void 0,this._protocol=void 0,this._sock=void 0,this._resetKA=void 0}connect(e){if(this._sock&&It(this._sock))return this.once("close",()=>{this.connect(e)}),this.end(),this;this.config.host=e.hostname||e.host||"localhost",this.config.port=e.port||22,this.config.localAddress=typeof e.localAddress=="string"?e.localAddress:void 0,this.config.localPort=typeof e.localPort=="string"||typeof e.localPort=="number"?e.localPort:void 0,this.config.forceIPv4=e.forceIPv4||!1,this.config.forceIPv6=e.forceIPv6||!1,this.config.keepaliveCountMax=typeof e.keepaliveCountMax=="number"&&e.keepaliveCountMax>=0?e.keepaliveCountMax:3,this.config.keepaliveInterval=typeof e.keepaliveInterval=="number"&&e.keepaliveInterval>0?e.keepaliveInterval:0,this.config.readyTimeout=typeof e.readyTimeout=="number"&&e.readyTimeout>=0?e.readyTimeout:2e4,this.config.ident=typeof e.ident=="string"||Buffer.isBuffer(e.ident)?e.ident:void 0;let t={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:[]},sc:void 0},n=!0;if(typeof e.algorithms=="object"&&e.algorithms!==null&&(t.kex=hi(e.algorithms.kex,Tu,Pg),t.kex!==Tu&&(n=!1),t.serverHostKey=hi(e.algorithms.serverHostKey,Ou,Hg),t.serverHostKey!==Ou&&(n=!1),t.cs.cipher=hi(e.algorithms.cipher,vu,Og),t.cs.cipher!==vu&&(n=!1),t.cs.mac=hi(e.algorithms.hmac,Lu,Dg),t.cs.mac!==Lu&&(n=!1),t.cs.compress=hi(e.algorithms.compress,Nu,Ug),t.cs.compress!==Nu&&(n=!1),n||(t.sc=t.cs)),typeof e.username=="string")this.config.username=e.username;else if(typeof e.user=="string")this.config.username=e.user;else throw new Error("Invalid username");this.config.password=typeof e.password=="string"?e.password:void 0,this.config.privateKey=typeof e.privateKey=="string"||Buffer.isBuffer(e.privateKey)?e.privateKey:void 0,this.config.localHostname=typeof e.localHostname=="string"?e.localHostname:void 0,this.config.localUsername=typeof e.localUsername=="string"?e.localUsername:void 0,this.config.tryKeyboard=e.tryKeyboard===!0,typeof e.agent=="string"&&e.agent.length?this.config.agent=Hu(e.agent):Qu(e.agent)?this.config.agent=e.agent:this.config.agent=void 0,this.config.allowAgentFwd=e.agentForward===!0&&this.config.agent!==void 0;let i=this.config.authHandler=typeof e.authHandler=="function"||Array.isArray(e.authHandler)?e.authHandler:void 0;this.config.strictVendor=typeof e.strictVendor=="boolean"?e.strictVendor:!0;let s=this.config.debug=typeof e.debug=="function"?e.debug:void 0;if(e.agentForward===!0&&!this.config.allowAgentFwd)throw new Error("You must set a valid agent path to allow agent forwarding");let o=this._callbacks=[];this._chanMgr=new $g(this),this._forwarding={},this._forwardingUnix={},this._acceptX11=0,this._agentFwdEnabled=!1,this._agent=this.config.agent?this.config.agent:void 0,this._remoteVer=void 0;let f;if(this.config.privateKey){if(f=ps(this.config.privateKey,e.passphrase),f instanceof Error)throw new Error(`Cannot parse privateKey: ${f.message}`);if(Array.isArray(f)&&(f=f[0]),f.getPrivatePEM()===null)throw new Error("privateKey value does not contain a (valid) private key")}let a;if(typeof e.hostVerifier=="function"){let T=e.hostVerifier,M;Ng.indexOf(e.hostHash)!==-1&&(M=mg(e.hostHash)),a=(Q,z)=>{M&&(M.update(Q),Q=M.digest("hex"));let le=T(Q,z);le!==void 0&&z(le)}}let c=this._sock=e.sock||new Rg,h=!1,l=!1;this._protocol&&this._protocol.cleanup();let g=s?(T,M,Q)=>{s(`Debug output from server: ${JSON.stringify(Q)}`)}:void 0,p,y=this._protocol=new Mg({ident:this.config.ident,offer:n?void 0:t,onWrite:T=>{It(c)&&c.write(T)},onError:T=>{T.level==="handshake"&&clearTimeout(this._readyTimeout),y._destruct||c.removeAllListeners("data"),this.emit("error",T);try{c.end()}catch{}},onHeader:T=>{l=!0,this._remoteVer=T.versions.software,T.greeting&&this.emit("greeting",T.greeting)},onHandshakeComplete:T=>{this.emit("handshake",T),h||(h=!0,y.service("ssh-userauth"))},debug:s,hostVerifier:a,messageHandlers:{DEBUG:g,DISCONNECT:(T,M,Q)=>{if(M!==Uu.BY_APPLICATION){Q||(Q=Lg[M],Q===void 0&&(Q=`Unexpected disconnection reason: ${M}`));let z=new Error(Q);z.code=M,this.emit("error",z)}c.end()},SERVICE_ACCEPT:(T,M)=>{M==="ssh-userauth"&&J()},EXT_INFO:(T,M)=>{if(p===void 0){for(let Q of M)if(Q.name==="server-sig-algs"){p=Q.algs;return}p=null}},USERAUTH_BANNER:(T,M)=>{this.emit("banner",M)},USERAUTH_SUCCESS:T=>{N(),clearTimeout(this._readyTimeout),this.emit("ready")},USERAUTH_FAILURE:(T,M,Q)=>{if(S.keyAlgos){let z=S.keyAlgos[0][0];if(s&&s(`Client: ${S.type} (${z}) auth failed`),S.keyAlgos.shift(),S.keyAlgos.length){let[le,pe]=S.keyAlgos[0];switch(S.type){case"agent":y.authPK(S.username,S.agentCtx.currentKey(),le);return;case"publickey":y.authPK(S.username,S.key,le);return;case"hostbased":y.authHostbased(S.username,S.key,S.localHostname,S.localUsername,le,(ge,at)=>{let Tt=S.key.sign(ge,pe);if(Tt instanceof Error)return Tt.message=`Error while signing with key: ${Tt.message}`,Tt.level="client-authentication",this.emit("error",Tt),J();at(Tt)});return}}else S.keyAlgos=void 0}if(S.type==="agent"){let z=S.agentCtx.pos();return s&&s(`Client: Agent key #${z+1} failed`),te()}s&&s(`Client: ${S.type} auth failed`),I=Q,O=M,J()},USERAUTH_PASSWD_CHANGEREQ:(T,M)=>{S.type==="password"&&this.emit("change password",M,Q=>{y.authPassword(this.config.username,this.config.password,Q)})},USERAUTH_PK_OK:T=>{let M,Q;if(S.keyAlgos&&([M,Q]=S.keyAlgos[0]),S.type==="agent"){let z=S.agentCtx.currentKey();y.authPK(S.username,z,M,(le,pe)=>{let ge={hash:Q};S.agentCtx.sign(z,le,ge,(at,Tt)=>{if(at)at.level="agent",this.emit("error",at);else return pe(Tt);te()})})}else S.type==="publickey"&&y.authPK(S.username,S.key,M,(z,le)=>{let pe=S.key.sign(z,Q);if(pe instanceof Error)return pe.message=`Error signing data with key: ${pe.message}`,pe.level="client-authentication",this.emit("error",pe),J();le(pe)})},USERAUTH_INFO_REQUEST:(T,M,Q,z)=>{if(S.type==="keyboard-interactive"){if((Array.isArray(z)?z.length:0)===0){s&&s("Client: Sending automatic USERAUTH_INFO_RESPONSE"),y.authInfoRes();return}S.prompt(M,Q,"",z,pe=>{y.authInfoRes(pe)})}},REQUEST_SUCCESS:(T,M)=>{o.length&&o.shift()(!1,M)},REQUEST_FAILURE:T=>{o.length&&o.shift()(!0)},GLOBAL_REQUEST:(T,M,Q,z)=>{switch(M){case"hostkeys-00@openssh.com":Jg(this,z,(le,pe)=>{le||this.emit("hostkeys",pe)}),Q&&y.requestSuccess();break;default:Q&&y.requestFailure()}},CHANNEL_OPEN:(T,M)=>{Vg(this,M)},CHANNEL_OPEN_CONFIRMATION:(T,M)=>{let Q=this._chanMgr.get(M.recipient);if(typeof Q!="function")return;let z=Q.type==="sftp",pe={type:z?"session":Q.type,incoming:{id:M.recipient,window:Es,packetSize:bs,state:"open"},outgoing:{id:M.sender,window:M.window,packetSize:M.packetSize,state:"open"}},ge=z?new Fg(this,pe,{debug:s}):new Vu(this,pe);this._chanMgr.update(M.recipient,ge),Q(void 0,ge)},CHANNEL_OPEN_FAILURE:(T,M,Q,z)=>{let le=this._chanMgr.get(M);if(typeof le!="function")return;Gg(this,M,{reason:Q,description:z},le)},CHANNEL_DATA:(T,M,Q)=>{let z=this._chanMgr.get(M);if(!(typeof z!="object"||z===null)&&z.incoming.window!==0){if(z.incoming.window-=Q.length,z.push(Q)===!1){z._waitChanDrain=!0;return}z.incoming.window<=Fu&&Mu(z)}},CHANNEL_EXTENDED_DATA:(T,M,Q,z)=>{if(z!==Tg)return;let le=this._chanMgr.get(M);if(!(typeof le!="object"||le===null)&&le.incoming.window!==0){if(le.incoming.window-=Q.length,!le.stderr.push(Q)){le._waitChanDrain=!0;return}le.incoming.window<=Fu&&Mu(le)}},CHANNEL_WINDOW_ADJUST:(T,M,Q)=>{let z=this._chanMgr.get(M);typeof z!="object"||z===null||(z.outgoing.window+=Q,z._waitWindow&&(z._waitWindow=!1,z._chunk?z._write(z._chunk,null,z._chunkcb):z._chunkcb?z._chunkcb():z._chunkErr?z.stderr._write(z._chunkErr,null,z._chunkcbErr):z._chunkcbErr&&z._chunkcbErr()))},CHANNEL_SUCCESS:(T,M)=>{let Q=this._chanMgr.get(M);typeof Q!="object"||Q===null||(this._resetKA(),Q._callbacks.length&&Q._callbacks.shift()(!1))},CHANNEL_FAILURE:(T,M)=>{let Q=this._chanMgr.get(M);typeof Q!="object"||Q===null||(this._resetKA(),Q._callbacks.length&&Q._callbacks.shift()(!0))},CHANNEL_REQUEST:(T,M,Q,z,le)=>{let pe=this._chanMgr.get(M);if(typeof pe!="object"||pe===null)return;let ge=pe._exit;if(ge.code===void 0){switch(Q){case"exit-status":pe.emit("exit",ge.code=le);return;case"exit-signal":pe.emit("exit",ge.code=null,ge.signal=`SIG${le.signal}`,ge.dump=le.coreDumped,ge.desc=le.errorMessage);return}z&&T.channelFailure(pe.outgoing.id)}},CHANNEL_EOF:(T,M)=>{let Q=this._chanMgr.get(M);typeof Q!="object"||Q===null||Q.incoming.state==="open"&&(Q.incoming.state="eof",Q.readable&&Q.push(null),Q.stderr.readable&&Q.stderr.push(null))},CHANNEL_CLOSE:(T,M)=>{Yg(this,M,this._chanMgr.get(M))}}});c.pause();let b=this.config.keepaliveInterval,x=this.config.keepaliveCountMax,m=0,L,W=()=>{if(++m>x){if(clearInterval(L),c.readable){let T=new Error("Keepalive timeout");T.level="client-timeout",this.emit("error",T),c.destroy()}return}It(c)?(o.push(N),y.ping()):clearInterval(L)};function N(){b>0&&(m=0,clearInterval(L),It(c)&&(L=setInterval(W,b)))}this._resetKA=N;let K=(()=>{let T=!1;return()=>{if(!T&&(T=!0,X&&!l)){let M=qg("Connection lost before handshake","protocol",!0);this.emit("error",M)}}})(),q=(()=>{let T=!1;return()=>{T||(T=!0,X=!0,s&&s("Socket connected"),this.emit("connect"),Qg.then(()=>{y.start(),c.on("data",M=>{try{y.parse(M,0,M.length)}catch(Q){this.emit("error",Q);try{It(c)&&c.end()}catch{}}}),c.stderr&&typeof c.stderr.resume=="function"&&c.stderr.resume(),c.resume()}).catch(M=>{this.emit("error",M);try{It(c)&&c.end()}catch{}}))}})(),X=!1;c.on("connect",q).on("timeout",()=>{this.emit("timeout")}).on("error",T=>{s&&s(`Socket error: ${T.message}`),clearTimeout(this._readyTimeout),T.level="client-socket",this.emit("error",T)}).on("end",()=>{s&&s("Socket ended"),K(),y.cleanup(),clearTimeout(this._readyTimeout),clearInterval(L),this.emit("end")}).on("close",()=>{s&&s("Socket closed"),K(),y.cleanup(),clearTimeout(this._readyTimeout),clearInterval(L),this.emit("close");let T=o;o=this._callbacks=[];let M=new Error("No response from server");for(let Q=0;Q<T.length;++Q)T[Q](M);this._chanMgr.cleanup(M)});let S,I=null,O=null,F=["none"];this.config.password!==void 0&&F.push("password"),f!==void 0&&F.push("publickey"),this._agent!==void 0&&F.push("agent"),this.config.tryKeyboard&&F.push("keyboard-interactive"),f!==void 0&&this.config.localHostname!==void 0&&this.config.localUsername!==void 0&&F.push("hostbased"),Array.isArray(i)?i=Yu(i):typeof i!="function"&&(i=Yu(F));let H=!1,ne=T=>{if(!H){if(H=!0,T===!1){let M=new Error("All configured authentication methods failed");M.level="client-authentication",this.emit("error",M),this.end();return}if(typeof T=="string"){let M=T;if(F.indexOf(M)===-1)return ee(`Authentication method not allowed: ${M}`);let Q=this.config.username;switch(M){case"password":T={type:M,username:Q,password:this.config.password};break;case"publickey":T={type:M,username:Q,key:f};break;case"hostbased":T={type:M,username:Q,key:f,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":T={type:M,username:Q,agentCtx:new Du(this._agent)};break;case"keyboard-interactive":T={type:M,username:Q,prompt:(...z)=>this.emit("keyboard-interactive",...z)};break;case"none":T={type:M,username:Q};break;default:return ee(`Skipping unsupported authentication method: ${T}`)}}else{if(typeof T!="object"||T===null)return ee(`Skipping invalid authentication attempt: ${T}`);{let M=T.username;if(typeof M!="string")return ee(`Skipping invalid authentication attempt: ${T}`);let Q=T.type;switch(Q){case"password":{let{password:z}=T;if(typeof z!="string"&&!Buffer.isBuffer(z))return ee("Skipping invalid password auth attempt");T={type:Q,username:M,password:z};break}case"publickey":{let z=ps(T.key,T.passphrase);if(z instanceof Error)return ee("Skipping invalid key auth attempt");if(!z.isPrivateKey())return ee("Skipping non-private key");T={type:Q,username:M,key:z};break}case"hostbased":{let{localHostname:z,localUsername:le}=T,pe=ps(T.key,T.passphrase);if(pe instanceof Error||typeof z!="string"||typeof le!="string")return ee("Skipping invalid hostbased auth attempt");if(!pe.isPrivateKey())return ee("Skipping non-private key");T={type:Q,username:M,key:pe,localHostname:z,localUsername:le};break}case"agent":{let z=T.agent;if(typeof z=="string"&&z.length)z=Hu(z);else if(!Qu(z))return ee(`Skipping invalid agent: ${T.agent}`);T={type:Q,username:M,agentCtx:new Du(z)};break}case"keyboard-interactive":{let{prompt:z}=T;if(typeof z!="function")return ee("Skipping invalid keyboard-interactive auth attempt");T={type:Q,username:M,prompt:z};break}case"none":T={type:Q,username:M};break;default:return ee(`Skipping unsupported authentication method: ${T}`)}}}S=T;try{let M=S.username;switch(S.type){case"password":y.authPassword(M,S.password);break;case"publickey":{let Q;if(S.keyAlgos=kf(this,S.key,p),S.keyAlgos)if(S.keyAlgos.length)Q=S.keyAlgos[0][0];else return ee("Skipping key authentication (no mutual hash algorithm)");y.authPK(M,S.key,Q);break}case"hostbased":{let Q,z;if(S.keyAlgos=kf(this,S.key,p),S.keyAlgos)if(S.keyAlgos.length)[Q,z]=S.keyAlgos[0];else return ee("Skipping hostbased authentication (no mutual hash algorithm)");y.authHostbased(M,S.key,S.localHostname,S.localUsername,Q,(le,pe)=>{let ge=S.key.sign(le,z);if(ge instanceof Error)return ge.message=`Error while signing with key: ${ge.message}`,ge.level="client-authentication",this.emit("error",ge),J();pe(ge)});break}case"agent":S.agentCtx.init(Q=>{if(Q)return Q.level="agent",this.emit("error",Q),J();te()});break;case"keyboard-interactive":y.authKeyboard(M);break;case"none":y.authNone(M);break}}finally{H=!1}}};function ee(T){s&&s(T),process.nextTick(J)}function J(){H=!1;let T=i(O,I,ne);H||T===void 0||ne(T)}let te=()=>{if(S.type==="agent"){let T=S.agentCtx.nextKey();if(T===!1)s&&s("Agent: No more keys left to try"),s&&s("Client: agent auth failed"),J();else{let M=S.agentCtx.pos(),Q;if(S.keyAlgos=kf(this,T,p),S.keyAlgos)if(S.keyAlgos.length)Q=S.keyAlgos[0][0];else{s&&s(`Agent: Skipping key #${M+1} (no mutual hash algorithm)`),te();return}s&&s(`Agent: Trying key #${M+1}`),y.authPK(S.username,T,Q)}}},ie=()=>{this.config.readyTimeout>0&&(this._readyTimeout=setTimeout(()=>{let T=new Error("Timed out while waiting for handshake");T.level="client-timeout",this.emit("error",T),c.destroy()},this.config.readyTimeout))};if(e.sock)ie(),typeof c.connecting=="boolean"&&c.connecting||q();else{let T=this.config.host,M=this.config.forceIPv4,Q=this.config.forceIPv6;s&&s(`Client: Trying ${T} on port ${this.config.port} ...`);let z=()=>{ie(),c.connect({host:T,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort}),c.setMaxListeners(0),c.setTimeout(typeof e.timeout=="number"?e.timeout:0)};!M&&!Q||M&&Q?z():kg(T,M?4:6,(le,pe,ge)=>{if(le){let at=M?"IPv4":"IPv6",Tt=new Error(`Error while looking up ${at} address for '${T}': ${le}`);clearTimeout(this._readyTimeout),Tt.level="client-dns",this.emit("error",Tt),this.emit("close");return}T=pe,z()})}return this}end(){return this._sock&&It(this._sock)&&(this._protocol.disconnect(Uu.BY_APPLICATION),this._sock.end()),this}destroy(){return this._sock&&It(this._sock)&&this._sock.destroy(),this}exec(e,t,n){if(!this._sock||!It(this._sock))throw new Error("Not connected");typeof t=="function"&&(n=t,t={});let i={allowHalfOpen:t.allowHalfOpen!==!1};return Bn(this,"session",i,(s,o)=>{if(s){n(s);return}let f=[];function a(c){if(c){o.close(),n(c);return}f.length&&f.shift()()}(this.config.allowAgentFwd===!0||t&&t.agentForward===!0&&this._agent!==void 0)&&f.push(()=>Ku(o,a)),typeof t=="object"&&t!==null&&(typeof t.env=="object"&&t.env!==null&&$u(o,t.env),(typeof t.pty=="object"&&t.pty!==null||t.pty===!0)&&f.push(()=>Wu(o,t.pty,a)),(typeof t.x11=="object"&&t.x11!==null||t.x11==="number"||t.x11===!0)&&f.push(()=>qu(o,t.x11,a))),f.push(()=>Xg(o,e,t,n)),f.shift()()}),this}shell(e,t,n){if(!this._sock||!It(this._sock))throw new Error("Not connected");return typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),e&&(e.x11!==void 0||e.env!==void 0)&&(t=e,e=void 0),Bn(this,"session",(i,s)=>{if(i){n(i);return}let o=[];function f(a){if(a){s.close(),n(a);return}o.length&&o.shift()()}(this.config.allowAgentFwd===!0||t&&t.agentForward===!0&&this._agent!==void 0)&&o.push(()=>Ku(s,f)),e!==!1&&o.push(()=>Wu(s,e,f)),typeof t=="object"&&t!==null&&(typeof t.env=="object"&&t.env!==null&&$u(s,t.env),(typeof t.x11=="object"&&t.x11!==null||t.x11==="number"||t.x11===!0)&&o.push(()=>qu(s,t.x11,f))),o.push(()=>jg(s,n)),o.shift()()}),this}subsys(e,t){if(!this._sock||!It(this._sock))throw new Error("Not connected");return Bn(this,"session",(n,i)=>{if(n){t(n);return}Gu(i,e,(s,o)=>{if(s){t(s);return}t(void 0,o)})}),this}forwardIn(e,t,n){if(!this._sock||!It(this._sock))throw new Error("Not connected");let i=typeof n=="function";return i&&this._callbacks.push((s,o)=>{if(s){n(s!==!0?s:new Error(`Unable to bind to ${e}:${t}`));return}let f=t;t===0&&o&&o.length>=4&&(f=Wg(o,0),this._protocol._compatFlags&ju.DYN_RPORT_BUG||(t=f)),this._forwarding[`${e}:${t}`]=f,n(void 0,f)}),this._protocol.tcpipForward(e,t,i),this}unforwardIn(e,t,n){if(!this._sock||!It(this._sock))throw new Error("Not connected");let i=typeof n=="function";return i&&this._callbacks.push(s=>{if(s){n(s!==!0?s:new Error(`Unable to unbind from ${e}:${t}`));return}delete this._forwarding[`${e}:${t}`],n()}),this._protocol.cancelTcpipForward(e,t,i),this}forwardOut(e,t,n,i,s){if(!this._sock||!It(this._sock))throw new Error("Not connected");let o={srcIP:e,srcPort:t,dstIP:n,dstPort:i};return typeof s!="function"&&(s=vf),Bn(this,"direct-tcpip",o,s),this}openssh_noMoreSessions(e){if(!this._sock||!It(this._sock))throw new Error("Not connected");let t=typeof e=="function";return!this.config.strictVendor||this.config.strictVendor&&li.test(this._remoteVer)?(t&&this._callbacks.push(n=>{if(n){e(n!==!0?n:new Error("Unable to disable future sessions"));return}e()}),this._protocol.openssh_noMoreSessions(t),this):t?(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardInStreamLocal(e,t){if(!this._sock||!It(this._sock))throw new Error("Not connected");let n=typeof t=="function";return!this.config.strictVendor||this.config.strictVendor&&li.test(this._remoteVer)?(n&&this._callbacks.push(i=>{if(i){t(i!==!0?i:new Error(`Unable to bind to ${e}`));return}this._forwardingUnix[e]=!0,t()}),this._protocol.openssh_streamLocalForward(e,n),this):n?(process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_unforwardInStreamLocal(e,t){if(!this._sock||!It(this._sock))throw new Error("Not connected");let n=typeof t=="function";return!this.config.strictVendor||this.config.strictVendor&&li.test(this._remoteVer)?(n&&this._callbacks.push(i=>{if(i){t(i!==!0?i:new Error(`Unable to unbind from ${e}`));return}delete this._forwardingUnix[e],t()}),this._protocol.openssh_cancelStreamLocalForward(e,n),this):n?(process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardOutStreamLocal(e,t){if(!this._sock||!It(this._sock))throw new Error("Not connected");return typeof t!="function"&&(t=vf),!this.config.strictVendor||this.config.strictVendor&&li.test(this._remoteVer)?(Bn(this,"direct-streamlocal@openssh.com",{socketPath:e},t),this):(process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this)}sftp(e){if(!this._sock||!It(this._sock))throw new Error("Not connected");return Bn(this,"sftp",(t,n)=>{if(t){e(t);return}Gu(n,"sftp",(i,s)=>{if(i){e(i);return}function o(){n.removeListener("ready",f),n.removeListener("error",a),n.removeListener("exit",c),n.removeListener("close",c)}function f(){o(),e(void 0,n)}function a(h){o(),e(h)}function c(h,l){o();let g;typeof h=="number"?g=`Received exit code ${h} while establishing SFTP session`:l!==void 0?g=`Received signal ${l} while establishing SFTP session`:g="Received unexpected SFTP session termination";let p=new Error(g);p.code=h,p.signal=l,e(p)}n.on("ready",f).on("error",a).on("exit",c).on("close",c),n._init()})}),this}setNoDelay(e){return this._sock&&typeof this._sock.setNoDelay=="function"&&this._sock.setNoDelay(e),this}};function Bn(r,e,t,n){let i=Es,s=bs;typeof t=="function"&&(n=t,t={});let o=(a,c)=>{n(a,c)};o.type=e;let f=r._chanMgr.add(o);if(f===-1){n(new Error("No free channels available"));return}switch(e){case"session":case"sftp":r._protocol.session(f,i,s);break;case"direct-tcpip":r._protocol.directTcpip(f,i,s,t);break;case"direct-streamlocal@openssh.com":r._protocol.openssh_directStreamLocal(f,i,s,t);break;default:throw new Error(`Unsupported channel type: ${e}`)}}function qu(r,e,t){let n={single:!1,protocol:"MIT-MAGIC-COOKIE-1",cookie:void 0,screen:0};typeof e=="function"?t=e:typeof e=="object"&&e!==null&&(typeof e.single=="boolean"&&(n.single=e.single),typeof e.screen=="number"&&(n.screen=e.screen),typeof e.protocol=="string"&&(n.protocol=e.protocol),typeof e.cookie=="string"?n.cookie=e.cookie:Buffer.isBuffer(e.cookie)&&(n.cookie=e.cookie.hexSlice(0,e.cookie.length))),n.cookie===void 0&&(n.cookie=zg());let i=typeof t=="function";if(r.outgoing.state!=="open"){i&&t(new Error("Channel is not open"));return}i&&r._callbacks.push(s=>{if(s){t(s!==!0?s:new Error("Unable to request X11"));return}r._hasX11=!0,++r._client._acceptX11,r.once("close",()=>{r._client._acceptX11&&--r._client._acceptX11}),t()}),r._client._protocol.x11Forward(r.outgoing.id,n,i)}function Wu(r,e,t){let n=24,i=80,s=640,o=480,f="vt100",a=null;typeof e=="function"?t=e:typeof e=="object"&&e!==null&&(typeof e.rows=="number"&&(n=e.rows),typeof e.cols=="number"&&(i=e.cols),typeof e.width=="number"&&(s=e.width),typeof e.height=="number"&&(o=e.height),typeof e.term=="string"&&(f=e.term),typeof e.modes=="object"&&(a=e.modes));let c=typeof t=="function";if(r.outgoing.state!=="open"){c&&t(new Error("Channel is not open"));return}c&&r._callbacks.push(h=>{if(h){t(h!==!0?h:new Error("Unable to request a pseudo-terminal"));return}t()}),r._client._protocol.pty(r.outgoing.id,n,i,o,s,f,a,c)}function Ku(r,e){let t=typeof e=="function";if(r.outgoing.state!=="open"){t&&e(new Error("Channel is not open"));return}if(r._client._agentFwdEnabled){t&&e(!1);return}r._client._agentFwdEnabled=!0,r._callbacks.push(n=>{if(n){r._client._agentFwdEnabled=!1,t&&e(n!==!0?n:new Error("Unable to request agent forwarding"));return}t&&e()}),r._client._protocol.openssh_agentForward(r.outgoing.id,!0)}function jg(r,e){if(r.outgoing.state!=="open"){e(new Error("Channel is not open"));return}r._callbacks.push(t=>{if(t){e(t!==!0?t:new Error("Unable to open shell"));return}r.subtype="shell",e(void 0,r)}),r._client._protocol.shell(r.outgoing.id,!0)}function Xg(r,e,t,n){if(r.outgoing.state!=="open"){n(new Error("Channel is not open"));return}r._callbacks.push(i=>{if(i){n(i!==!0?i:new Error("Unable to exec"));return}r.subtype="exec",r.allowHalfOpen=t.allowHalfOpen!==!1,n(void 0,r)}),r._client._protocol.exec(r.outgoing.id,e,!0)}function $u(r,e){if(r.outgoing.state!=="open")return;let t=Object.keys(e||{});for(let n=0;n<t.length;++n){let i=t[n],s=e[i];r._client._protocol.env(r.outgoing.id,i,s,!1)}}function Gu(r,e,t){if(r.outgoing.state!=="open"){t(new Error("Channel is not open"));return}r._callbacks.push(n=>{if(n){t(n!==!0?n:new Error(`Unable to start subsystem: ${e}`));return}r.subtype="subsystem",t(void 0,r)}),r._client._protocol.subsystem(r.outgoing.id,e,!0)}function Vg(r,e){let t=-1,n,i=()=>{let a={type:e.type,incoming:{id:t,window:Es,packetSize:bs,state:"open"},outgoing:{id:e.sender,window:e.window,packetSize:e.packetSize,state:"open"}},c=new Vu(r,a);return r._chanMgr.update(t,c),r._protocol.channelOpenConfirm(e.sender,t,Es,bs),c},s=()=>{n===void 0&&(t===-1?n=ui.RESOURCE_SHORTAGE:n=ui.CONNECT_FAILED),t!==-1&&r._chanMgr.remove(t),r._protocol.channelOpenFail(e.sender,n,"")},o=()=>(t=r._chanMgr.add(),t===-1&&(n=ui.RESOURCE_SHORTAGE,r.config.debug&&r.config.debug("Client: Automatic rejection of incoming channel open: no channels available")),t!==-1),f=e.data;switch(e.type){case"forwarded-tcpip":{let a=r._forwarding[`${f.destIP}:${f.destPort}`];if(a!==void 0&&o()){f.destPort===0&&(f.destPort=a),r.emit("tcp connection",f,i,s);return}break}case"forwarded-streamlocal@openssh.com":if(r._forwardingUnix[f.socketPath]!==void 0&&o()){r.emit("unix connection",f,i,s);return}break;case"auth-agent@openssh.com":if(r._agentFwdEnabled&&typeof r._agent.getStream=="function"&&o()){r._agent.getStream((a,c)=>{if(a)return s();let h=i();h.pipe(c).pipe(h)});return}break;case"x11":if(r._acceptX11!==0&&o()){r.emit("x11",f,i,s);return}break;default:n=ui.UNKNOWN_CHANNEL_TYPE,r.config.debug&&r.config.debug(`Client: Automatic rejection of unsupported incoming channel open type: ${e.type}`)}n===void 0&&(n=ui.ADMINISTRATIVELY_PROHIBITED,r.config.debug&&r.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+e.type)),s()}var zg=(()=>{let r=Buffer.allocUnsafe(16);return()=>(Cg(r,0,16),r.hexSlice(0,16))})();function Yu(r){if(!Array.isArray(r))throw new Error("authList must be an array");let e=0;return(t,n,i)=>e===r.length?!1:r[e++]}function Jg(r,e,t){if(!r._sock||!It(r._sock))return;if(typeof t!="function"&&(t=vf),!Array.isArray(e))throw new TypeError("Invalid keys argument type");let n=[];for(let i of e){let s=ps(i);if(s instanceof Error)throw s;n.push(s)}if(!r.config.strictVendor||r.config.strictVendor&&li.test(r._remoteVer)){r._callbacks.push((i,s)=>{if(i){t(i!==!0?i:new Error("Server failed to prove supplied keys"));return}let o=[],f=0;for(As.init(s,0);As.avail()&&f!==n.length;){let a=n[f++],c=a.getPublicSSH(),h=As.readString();_s.init(h,0);let l=_s.readString(!0),g=_s.readString(),p;if(l!==a.type)if(a.type==="ssh-rsa")switch(l){case"rsa-sha2-256":p="sha256";break;case"rsa-sha2-512":p="sha512";break;default:continue}else continue;let y=r._protocol._kex.sessionID,b=Buffer.allocUnsafe(4+29+4+y.length+4+c.length),x=0;Rf(b,29,x),b.utf8Write("hostkeys-prove-00@openssh.com",x+=4,29),Rf(b,y.length,x+=29),Pu(y,b,0,y.length,x+=4),Rf(b,c.length,x+=y.length),Pu(c,b,0,c.length,x+=4),(g=Kg(g,l))&&a.verify(b,g,p)===!0&&o.push(a)}_s.clear(),As.clear(),t(null,o)}),r._protocol.openssh_hostKeysProve(n);return}process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}function kf(r,e,t){switch(e.type){case"ssh-rsa":if(r._protocol._compatFlags&ju.IMPLY_RSA_SHA2_SIGALGS&&(Array.isArray(t)?t=["rsa-sha2-256","rsa-sha2-512",...t]:t=["rsa-sha2-256","rsa-sha2-512"]),Array.isArray(t)){if(t.indexOf("rsa-sha2-256")!==-1)return[["rsa-sha2-256","sha256"]];if(t.indexOf("rsa-sha2-512")!==-1)return[["rsa-sha2-512","sha512"]];if(t.indexOf("ssh-rsa")===-1)return[]}return[["ssh-rsa","sha1"]]}}zu.exports=Nf});var Zu=_e(Ju=>{"use strict";var{Agent:Of}=require("http"),{Agent:Zg}=require("https"),{connect:eA}=require("tls"),Lf;for(let r of[Of,Zg]){class e extends r{constructor(n,i){super(i),this._connectCfg=n,this._defaultSrcIP=i&&i.srcIP||"localhost"}createConnection(n,i){let s=n&&n.localAddress||this._defaultSrcIP,o=n&&n.localPort||0,f=n.host,a=n.port;Lf===void 0&&(Lf=Tf());let c=new Lf,h=!1;c.on("ready",()=>{c.forwardOut(s,o,f,a,(l,g)=>{if(h=!0,l)return c.end(),i(l);g.once("close",()=>c.end()),i(null,tA(g,r,n))})}).on("error",i).on("close",()=>{h||i(new Error("Unexpected connection close"))}).connect(this._connectCfg)}}Ju[r===Of?"SSHTTPAgent":"SSHTTPSAgent"]=e}function di(){}function tA(r,e,t){if(e===Of)return r.setKeepAlive=di,r.setNoDelay=di,r.setTimeout=di,r.ref=di,r.unref=di,r.destroySoon=r.destroy,r;t.socket=r;let n=eA(t),i=(()=>{let s=!1;return()=>{s||(s=!0,r.isPaused()&&r.resume())}})();return n.on("end",i).on("close",i),n}});var th=_e((Pb,Hf)=>{"use strict";var{Server:rA}=require("net"),Ai=require("events"),{listenerCount:Dt}=Ai,{CHANNEL_OPEN_FAILURE:Cn,DEFAULT_CIPHER:nA,DEFAULT_COMPRESSION:iA,DEFAULT_KEX:sA,DEFAULT_MAC:oA,DEFAULT_SERVER_HOST_KEY:fA,DISCONNECT_REASON:Rn,DISCONNECT_REASON_BY_VALUE:aA,SUPPORTED_CIPHER:cA,SUPPORTED_COMPRESSION:uA,SUPPORTED_KEX:hA,SUPPORTED_MAC:lA,SUPPORTED_SERVER_HOST_KEY:dA}=pr(),{init:gA}=Br(),{KexInit:AA}=rs(),{parseKey:eh}=kr(),_A=af(),{SFTP:pA}=fi(),{writeUInt32BE:EA}=rr(),{Channel:kn,MAX_WINDOW:Tr,PACKET_SIZE:Lr,windowAdjust:bA,WINDOW_THRESHOLD:yA}=If(),{ChannelManager:wA,generateAlgorithmList:gi,isWritable:ys,onChannelOpenFailure:xA,onCHANNEL_CLOSE:SA}=Cf(),IA=10,Or=class extends Ai{constructor(e,t,n,i,s){super(),this.username=this.user=t,this.service=n,this.method=i,this._initialResponse=!1,this._finalResponse=!1,this._multistep=!1,this._cbfinal=(o,f,a)=>{this._finalResponse||(this._finalResponse=!0,s(this,o,f,a))},this._protocol=e}accept(){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!0)}reject(e,t){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!1,e,t)}},ws=class extends Or{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._multistep=!0,this._cb=void 0,this._onInfoResponse=f=>{let a=this._cb;a&&(this._cb=void 0,a(f))},this.submethods=s,this.on("abort",()=>{this._cb&&this._cb(new Error("Authentication request aborted"))})}prompt(e,t,n,i){Array.isArray(e)||(e=[e]),typeof t=="function"?(i=t,t=n=void 0):typeof n=="function"?(i=n,n=void 0):typeof i!="function"&&(i=void 0);for(let s=0;s<e.length;++s)typeof e[s]=="string"&&(e[s]={prompt:e[s],echo:!0});this._cb=i,this._initialResponse=!0,this._protocol.authInfoReq(t,n,e)}},Pf=class extends Or{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this.key={algo:s.keyAlgo,data:s.key},this.hashAlgo=s.hashAlgo,this.signature=s.signature,this.blob=s.blob}accept(){this.signature?Or.prototype.accept.call(this):(this._initialResponse=!0,this._protocol.authPKOK(this.key.algo,this.key.data))}},Df=class extends Or{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this.key={algo:s.keyAlgo,data:s.key},this.hashAlgo=s.hashAlgo,this.signature=s.signature,this.blob=s.blob,this.localHostname=s.localHostname,this.localUsername=s.localUsername}},xs=class extends Or{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this.password=s,this._changeCb=void 0}requestChange(e,t){if(this._changeCb)throw new Error("Change request already in progress");if(typeof e!="string")throw new Error("prompt argument must be a string");if(typeof t!="function")throw new Error("Callback argument must be a function");this._changeCb=t,this._protocol.authPasswdChg(e)}},ur=class extends Ai{constructor(e,t,n){super(),this.type="session",this.subtype=void 0,this.server=!0,this._ending=!1,this._channel=void 0,this._chanInfo={type:"session",incoming:{id:n,window:Tr,packetSize:Lr,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}}}},Yt=class extends Ai{constructor(e,t){if(super(),typeof e!="object"||e===null)throw new Error("Missing configuration object");let n=Object.create(null),i=[],s=e.hostKeys;if(!Array.isArray(s))throw new Error("hostKeys must be an array");let o=typeof e.algorithms=="object"&&e.algorithms!==null?e.algorithms:{},f=gi(o.serverHostKey,fA,dA);for(let g=0;g<s.length;++g){let p;if(Buffer.isBuffer(s[g])||typeof s[g]=="string"?p=eh(s[g]):p=eh(s[g].key,s[g].passphrase),p instanceof Error)throw new Error(`Cannot parse privateKey: ${p.message}`);if(Array.isArray(p)&&(p=p[0]),p.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(!i.includes(p.type))if(p.type==="ssh-rsa"){let y=f.indexOf("ssh-rsa"),b=f.indexOf("rsa-sha2-256"),x=f.indexOf("rsa-sha2-512");y===-1&&(y=1/0),[y,b,x].sort(mA).forEach(m=>{if(m===-1)return;let L;switch(m){case y:L="ssh-rsa";break;case b:L="rsa-sha2-256";break;case x:L="rsa-sha2-512";break;default:return}n[L]=p,i.push(L)})}else n[p.type]=p,i.push(p.type)}let a={kex:gi(o.kex,sA,hA),serverHostKey:i,cs:{cipher:gi(o.cipher,nA,cA),mac:gi(o.hmac,oA,lA),compress:gi(o.compress,iA,uA),lang:[]},sc:void 0};a.sc=a.cs,typeof t=="function"&&this.on("connection",t);let c=typeof e.debug=="function"?e.debug:void 0,h=e.ident?Buffer.from(e.ident):void 0,l=new AA(a);this._srv=new rA(g=>{if(this._connections>=this.maxConnections){g.destroy();return}++this._connections,g.once("close",()=>{--this._connections});let p;if(c){let y=`[${process.hrtime().join(".")}] `;p=b=>{c(`${y}${b}`)}}new Ss(g,n,h,l,p,this,e)}).on("error",g=>{this.emit("error",g)}).on("listening",()=>{this.emit("listening")}).on("close",()=>{this.emit("close")}),this._connections=0,this.maxConnections=1/0}injectSocket(e){this._srv.emit("connection",e)}listen(...e){return this._srv.listen(...e),this}address(){return this._srv.address()}getConnections(e){return this._srv.getConnections(e),this}close(e){return this._srv.close(e),this}ref(){return this._srv.ref(),this}unref(){return this._srv.unref(),this}};Yt.KEEPALIVE_CLIENT_INTERVAL=15e3;Yt.KEEPALIVE_CLIENT_COUNT_MAX=3;var Ss=class extends Ai{constructor(e,t,n,i,s,o,f){super();let a=0,c=!1,h=[],l,g,p,y=[];this._sock=e,this._chanMgr=new wA(this),this._debug=s,this.noMoreSessions=!1,this.authenticated=!1;function b(X){}this.on("error",b);let x=s?(X,S,I)=>{s(`Debug output from client: ${JSON.stringify(I)}`)}:void 0,m=typeof f.keepaliveInterval=="number"&&isFinite(f.keepaliveInterval)&&f.keepaliveInterval>0?f.keepaliveInterval:typeof Yt.KEEPALIVE_CLIENT_INTERVAL=="number"&&isFinite(Yt.KEEPALIVE_CLIENT_INTERVAL)&&Yt.KEEPALIVE_CLIENT_INTERVAL>0?Yt.KEEPALIVE_CLIENT_INTERVAL:-1,L=typeof f.keepaliveCountMax=="number"&&isFinite(f.keepaliveCountMax)&&f.keepaliveCountMax>=0?f.keepaliveCountMax:typeof Yt.KEEPALIVE_CLIENT_COUNT_MAX=="number"&&isFinite(Yt.KEEPALIVE_CLIENT_COUNT_MAX)&&Yt.KEEPALIVE_CLIENT_COUNT_MAX>=0?Yt.KEEPALIVE_CLIENT_COUNT_MAX:-1,W=0;m!==-1&&L!==-1&&(this.once("ready",()=>{let X=()=>{clearInterval(g)};this.on("close",X).on("end",X),g=setInterval(()=>{if(++W>L){clearInterval(g);let S=new Error("Keepalive timeout");S.level="client-timeout",this.emit("error",S),this.end()}else N.ping()},m)}),p=()=>{g&&g.refresh(),W=0});let N=this._protocol=new _A({server:!0,hostKeys:t,ident:n,offer:i,onPacket:p,greeting:f.greeting,banner:f.banner,onWrite:X=>{ys(e)&&e.write(X)},onError:X=>{N._destruct||e.removeAllListeners("data"),this.emit("error",X);try{e.end()}catch{}},onHeader:X=>{this.removeListener("error",b);let S={ip:e.remoteAddress,family:e.remoteFamily,port:e.remotePort,header:X};if(!o.emit("connection",this,S)){N.disconnect(Rn.BY_APPLICATION),e.end();return}X.greeting&&this.emit("greeting",X.greeting)},onHandshakeComplete:X=>{++a>1&&this.emit("rekey"),this.emit("handshake",X)},debug:s,messageHandlers:{DEBUG:x,DISCONNECT:(X,S,I)=>{if(S!==Rn.BY_APPLICATION){I||(I=aA[S],I===void 0&&(I=`Unexpected disconnection reason: ${S}`));let O=new Error(I);O.code=S,this.emit("error",O)}e.end()},CHANNEL_OPEN:(X,S)=>{if(S.type==="session"&&this.noMoreSessions||!this.authenticated){let te=Cn.ADMINISTRATIVELY_PROHIBITED;return N.channelOpenFail(S.sender,te)}let I=-1,O,F=!1,H,ne=()=>{F||(F=!0,O===void 0&&(I===-1?O=Cn.RESOURCE_SHORTAGE:O=Cn.CONNECT_FAILED),I!==-1&&this._chanMgr.remove(I),N.channelOpenFail(S.sender,O,""))},ee=()=>(I=this._chanMgr.add(),I===-1&&(O=Cn.RESOURCE_SHORTAGE,s&&s("Automatic rejection of incoming channel open: no channels available")),I!==-1),J=S.data;switch(S.type){case"session":if(Dt(this,"session")&&ee()){H=()=>{if(F)return;F=!0;let te=new ur(this,S,I);return this._chanMgr.update(I,te),N.channelOpenConfirm(S.sender,I,Tr,Lr),te},this.emit("session",H,ne);return}break;case"direct-tcpip":if(Dt(this,"tcpip")&&ee()){H=()=>{if(F)return;F=!0;let te={type:void 0,incoming:{id:I,window:Tr,packetSize:Lr,state:"open"},outgoing:{id:S.sender,window:S.window,packetSize:S.packetSize,state:"open"}},ie=new kn(this,te,{server:!0});return this._chanMgr.update(I,ie),N.channelOpenConfirm(S.sender,I,Tr,Lr),ie},this.emit("tcpip",H,ne,J);return}break;case"direct-streamlocal@openssh.com":if(Dt(this,"openssh.streamlocal")&&ee()){H=()=>{if(F)return;F=!0;let te={type:void 0,incoming:{id:I,window:Tr,packetSize:Lr,state:"open"},outgoing:{id:S.sender,window:S.window,packetSize:S.packetSize,state:"open"}},ie=new kn(this,te,{server:!0});return this._chanMgr.update(I,ie),N.channelOpenConfirm(S.sender,I,Tr,Lr),ie},this.emit("openssh.streamlocal",H,ne,J);return}break;default:O=Cn.UNKNOWN_CHANNEL_TYPE,s&&s(`Automatic rejection of unsupported incoming channel open type: ${S.type}`)}O===void 0&&(O=Cn.ADMINISTRATIVELY_PROHIBITED,s&&s(`Automatic rejection of unexpected incoming channel open for: ${S.type}`)),ne()},CHANNEL_OPEN_CONFIRMATION:(X,S)=>{let I=this._chanMgr.get(S.recipient);if(typeof I!="function")return;let O={type:I.type,incoming:{id:S.recipient,window:Tr,packetSize:Lr,state:"open"},outgoing:{id:S.sender,window:S.window,packetSize:S.packetSize,state:"open"}},F=new kn(this,O,{server:!0});this._chanMgr.update(S.recipient,F),I(void 0,F)},CHANNEL_OPEN_FAILURE:(X,S,I,O)=>{let F=this._chanMgr.get(S);if(typeof F!="function")return;xA(this,S,{reason:I,description:O},F)},CHANNEL_DATA:(X,S,I)=>{let O=this._chanMgr.get(S);if(!(typeof O!="object"||O===null)&&!(O.constructor===ur&&(O=O._channel,!O))&&O.incoming.window!==0){if(O.incoming.window-=I.length,O.push(I)===!1){O._waitChanDrain=!0;return}O.incoming.window<=yA&&bA(O)}},CHANNEL_EXTENDED_DATA:(X,S,I,O)=>{},CHANNEL_WINDOW_ADJUST:(X,S,I)=>{let O=this._chanMgr.get(S);typeof O!="object"||O===null||O.constructor===ur&&(O=O._channel,!O)||(O.outgoing.window+=I,O._waitWindow&&(O._waitWindow=!1,O._chunk?O._write(O._chunk,null,O._chunkcb):O._chunkcb?O._chunkcb():O._chunkErr?O.stderr._write(O._chunkErr,null,O._chunkcbErr):O._chunkcbErr&&O._chunkcbErr()))},CHANNEL_SUCCESS:(X,S)=>{let I=this._chanMgr.get(S);typeof I!="object"||I===null||I.constructor===ur&&(I=I._channel,!I)||I._callbacks.length&&I._callbacks.shift()(!1)},CHANNEL_FAILURE:(X,S)=>{let I=this._chanMgr.get(S);typeof I!="object"||I===null||I.constructor===ur&&(I=I._channel,!I)||I._callbacks.length&&I._callbacks.shift()(!0)},CHANNEL_REQUEST:(X,S,I,O,F)=>{let H=this._chanMgr.get(S);if(typeof H!="object"||H===null)return;let ne=!1,ee,J;if(H.constructor!==ur){O&&N.channelFailure(H.outgoing.id);return}if(O&&(I!=="shell"&&I!=="exec"&&I!=="subsystem"&&(ee=()=>{ne||H._ending||H._channel||(ne=!0,N.channelSuccess(H._chanInfo.outgoing.id))}),J=()=>{ne||H._ending||H._channel||(ne=!0,N.channelFailure(H._chanInfo.outgoing.id))}),H._ending){J&&J();return}switch(I){case"env":if(Dt(H,"env")){H.emit("env",ee,J,{key:F.name,val:F.value});return}break;case"pty-req":if(Dt(H,"pty")){H.emit("pty",ee,J,F);return}break;case"window-change":Dt(H,"window-change")?H.emit("window-change",ee,J,F):J&&J();break;case"x11-req":if(Dt(H,"x11")){H.emit("x11",ee,J,F);return}break;case"signal":if(Dt(H,"signal")){H.emit("signal",ee,J,{name:F});return}break;case"auth-agent-req@openssh.com":if(Dt(H,"auth-agent")){H.emit("auth-agent",ee,J);return}break;case"shell":if(Dt(H,"shell")){ee=()=>{if(ne||H._ending||H._channel)return;ne=!0,O&&N.channelSuccess(H._chanInfo.outgoing.id);let te=new kn(this,H._chanInfo,{server:!0});return te.subtype=H.subtype=I,H._channel=te,te},H.emit("shell",ee,J);return}break;case"exec":if(Dt(H,"exec")){ee=()=>{if(ne||H._ending||H._channel)return;ne=!0,O&&N.channelSuccess(H._chanInfo.outgoing.id);let te=new kn(this,H._chanInfo,{server:!0});return te.subtype=H.subtype=I,H._channel=te,te},H.emit("exec",ee,J,{command:F});return}break;case"subsystem":{let te=F==="sftp";if(ee=()=>{if(ne||H._ending||H._channel)return;ne=!0,O&&N.channelSuccess(H._chanInfo.outgoing.id);let ie;return te?ie=new pA(this,H._chanInfo,{server:!0,debug:s}):(ie=new kn(this,H._chanInfo,{server:!0}),ie.subtype=H.subtype=`${I}:${F}`),H._channel=ie,ie},F==="sftp"){if(Dt(H,"sftp")){H.emit("sftp",ee,J);return}te=!1}if(Dt(H,"subsystem")){H.emit("subsystem",ee,J,{name:F});return}break}}s&&s(`Automatic rejection of incoming channel request: ${I}`),J&&J()},CHANNEL_EOF:(X,S)=>{let I=this._chanMgr.get(S);typeof I!="object"||I===null||I.constructor===ur&&(I._ending||(I._ending=!0,I.emit("eof"),I.emit("end")),I=I._channel,!I)||I.incoming.state==="open"&&(I.incoming.state="eof",I.readable&&I.push(null))},CHANNEL_CLOSE:(X,S)=>{let I=this._chanMgr.get(S);typeof I!="object"||I===null||I.constructor===ur&&(I._ending=!0,I.emit("close"),I=I._channel,!I)||SA(this,S,I)},SERVICE_REQUEST:(X,S)=>{if(a===0||c||this.authenticated||S!=="ssh-userauth"){N.disconnect(Rn.SERVICE_NOT_AVAILABLE),e.end();return}c=!0,N.serviceAccept(S)},USERAUTH_REQUEST:(X,S,I,O,F)=>{if(a===0||this.authenticated||l&&(l.username!==S||l.service!==I)||O!=="password"&&O!=="publickey"&&O!=="hostbased"&&O!=="keyboard-interactive"&&O!=="none"||h.length===IA){N.disconnect(Rn.PROTOCOL_ERROR),e.end();return}else if(I!=="ssh-connection"){N.disconnect(Rn.SERVICE_NOT_AVAILABLE),e.end();return}let H;switch(O){case"keyboard-interactive":H=new ws(N,S,I,O,F,K);break;case"publickey":H=new Pf(N,S,I,O,F,K);break;case"hostbased":H=new Df(N,S,I,O,F,K);break;case"password":if(l&&l instanceof xs&&l._changeCb){let ne=l._changeCb;l._changeCb=void 0,ne(F.newPassword);return}H=new xs(N,S,I,O,F,K);break;case"none":H=new Or(N,S,I,O,K);break}if(l)if(l._initialResponse)l._multistep&&!l._finalResponse&&(l._cleanup&&l._cleanup(),l.emit("abort"));else return h.push(H);l=H,Dt(this,"authentication")?this.emit("authentication",l):l.reject()},USERAUTH_INFO_RESPONSE:(X,S)=>{l&&l instanceof ws&&l._onInfoResponse(S)},GLOBAL_REQUEST:(X,S,I,O)=>{let F={type:null,buf:null};function H(ne,ee){F.type=ne,F.buf=ee,q()}if(I&&y.push(F),(S==="tcpip-forward"||S==="cancel-tcpip-forward"||S==="no-more-sessions@openssh.com"||S==="streamlocal-forward@openssh.com"||S==="cancel-streamlocal-forward@openssh.com")&&Dt(this,"request")&&this.authenticated){let ne,ee;if(I){let J=!1;ne=te=>{if(J)return;J=!0;let ie;S==="tcpip-forward"&&O.bindPort===0&&typeof te=="number"&&(ie=Buffer.allocUnsafe(4),EA(ie,te,0)),H("SUCCESS",ie)},ee=()=>{J||(J=!0,H("FAILURE"))}}if(S==="no-more-sessions@openssh.com"){this.noMoreSessions=!0,ne&&ne();return}this.emit("request",ne,ee,S,O)}else I&&H("FAILURE")}}});e.pause(),gA.then(()=>{N.start(),e.on("data",X=>{try{N.parse(X,0,X.length)}catch(S){this.emit("error",S);try{ys(e)&&e.end()}catch{}}}),e.resume()}).catch(X=>{this.emit("error",X);try{ys(e)&&e.end()}catch{}}),e.on("error",X=>{X.level="socket",this.emit("error",X)}).once("end",()=>{s&&s("Socket ended"),N.cleanup(),this.emit("end")}).once("close",()=>{s&&s("Socket closed"),N.cleanup(),this.emit("close");let X=new Error("No response from server");this._chanMgr.cleanup(X)});let K=(X,S,I,O)=>{l===X&&!this.authenticated&&(S?(l=void 0,this.authenticated=!0,N.authSuccess(),h=[],this.emit("ready")):(N.authFailure(I,O),h.length&&(l=h.pop(),Dt(this,"authentication")?this.emit("authentication",l):l.reject())))};function q(){for(;y.length>0&&y[0].type;){let X=y.shift();X.type==="SUCCESS"&&N.requestSuccess(X.buf),X.type==="FAILURE"&&N.requestFailure()}}}end(){return this._sock&&ys(this._sock)&&(this._protocol.disconnect(Rn.BY_APPLICATION),this._sock.end()),this}x11(e,t,n){return Uf(this,"x11",{originAddr:e,originPort:t},n),this}forwardOut(e,t,n,i,s){return Uf(this,"forwarded-tcpip",{boundAddr:e,boundPort:t,remoteAddr:n,remotePort:i},s),this}openssh_forwardOutStreamLocal(e,t){return Uf(this,"forwarded-streamlocal@openssh.com",{socketPath:e},t),this}rekey(e){let t;try{this._protocol.rekey()}catch(n){t=n}typeof e=="function"&&(t?process.nextTick(e,t):this.once("rekey",e))}setNoDelay(e){return this._sock&&typeof this._sock.setNoDelay=="function"&&this._sock.setNoDelay(e),this}};function Uf(r,e,t,n){let i=Tr,s=Lr;typeof t=="function"&&(n=t,t={});let o=(a,c)=>{n(a,c)};o.type=e;let f=r._chanMgr.add(o);if(f===-1){n(new Error("No free channels available"));return}switch(e){case"forwarded-tcpip":r._protocol.forwardedTcpip(f,i,s,t);break;case"x11":r._protocol.x11(f,i,s,t);break;case"forwarded-streamlocal@openssh.com":r._protocol.openssh_forwardedStreamLocal(f,i,s,t);break;default:throw new Error(`Unsupported channel type: ${e}`)}}function mA(r,e){return r-e}Hf.exports=Yt;Hf.exports.IncomingClient=Ss});var oh=_e((Db,sh)=>{"use strict";var{createCipheriv:BA,generateKeyPair:CA,generateKeyPairSync:RA,getCurves:kA,randomBytes:rh}=require("crypto"),{Ber:ut}=qn(),vA=to().pbkdf,{CIPHER_INFO:NA}=Br(),TA=16,LA=16,OA=kA(),UA=new Map(Object.entries(NA));function nh(r,e){if(typeof r!="string")throw new TypeError("Key type must be a string");let t={type:"spki",format:"der"},n={type:"pkcs8",format:"der"};switch(r.toLowerCase()){case"rsa":{if(typeof e!="object"||e===null)throw new TypeError("Missing options object for RSA key");let i=e.bits;if(!Number.isInteger(i))throw new TypeError("RSA bits must be an integer");if(i<=0||i>16384)throw new RangeError("RSA bits must be non-zero and <= 16384");return["rsa",{modulusLength:i,publicKeyEncoding:t,privateKeyEncoding:n}]}case"ecdsa":{if(typeof e!="object"||e===null)throw new TypeError("Missing options object for ECDSA key");if(!Number.isInteger(e.bits))throw new TypeError("ECDSA bits must be an integer");let i;switch(e.bits){case 256:i="prime256v1";break;case 384:i="secp384r1";break;case 521:i="secp521r1";break;default:throw new Error("ECDSA bits must be 256, 384, or 521")}if(!OA.includes(i))throw new Error("Unsupported ECDSA bits value");return["ec",{namedCurve:i,publicKeyEncoding:t,privateKeyEncoding:n}]}case"ed25519":return["ed25519",{publicKeyEncoding:t,privateKeyEncoding:n}];default:throw new Error(`Unsupported key type: ${r}`)}}function PA(r,e,t){switch(r){case"rsa":{let n=new ut.Reader(t);if(n.readSequence(),n.readInt()!==0)throw new Error("Unsupported version in RSA private key");if(n.readSequence(),n.readOID()!=="1.2.840.113549.1.1.1")throw new Error("Bad RSA private OID");if(n.readByte()!==ut.Null)throw new Error("Malformed RSA private key (expected null)");if(n.readByte()!==0)throw new Error("Malformed RSA private key (expected zero-length null)");if(n=new ut.Reader(n.readString(ut.OctetString,!0)),n.readSequence(),n.readInt()!==0)throw new Error("Unsupported version in RSA private key");let i=n.readString(ut.Integer,!0),s=n.readString(ut.Integer,!0),o=n.readString(ut.Integer,!0),f=n.readString(ut.Integer,!0),a=n.readString(ut.Integer,!0);n.readString(ut.Integer,!0),n.readString(ut.Integer,!0);let c=n.readString(ut.Integer,!0),h=Buffer.from("ssh-rsa"),l=Buffer.allocUnsafe(4+h.length+4+i.length+4+s.length+4+o.length+4+c.length+4+f.length+4+a.length),g=0;l.writeUInt32BE(h.length,g+=0),l.set(h,g+=4),l.writeUInt32BE(i.length,g+=h.length),l.set(i,g+=4),l.writeUInt32BE(s.length,g+=i.length),l.set(s,g+=4),l.writeUInt32BE(o.length,g+=s.length),l.set(o,g+=4),l.writeUInt32BE(c.length,g+=o.length),l.set(c,g+=4),l.writeUInt32BE(f.length,g+=c.length),l.set(f,g+=4),l.writeUInt32BE(a.length,g+=f.length),l.set(a,g+=4);let p=Buffer.allocUnsafe(4+h.length+4+s.length+4+i.length);return g=0,p.writeUInt32BE(h.length,g+=0),p.set(h,g+=4),p.writeUInt32BE(s.length,g+=h.length),p.set(s,g+=4),p.writeUInt32BE(i.length,g+=s.length),p.set(i,g+=4),{sshName:h.toString(),priv:l,pub:p}}case"ec":{let n=new ut.Reader(e);if(n.readSequence(),n.readSequence(),n.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA public OID");n.readOID();let i=n.readString(ut.BitString,!0);{let g=0;for(;g<i.length&&i[g]===0;++g);g>0&&(i=i.slice(g))}if(n=new ut.Reader(t),n.readSequence(),n.readInt()!==0)throw new Error("Unsupported version in ECDSA private key");if(n.readSequence(),n.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA private OID");let s=n.readOID(),o;switch(s){case"1.2.840.10045.3.1.7":o="nistp256";break;case"1.3.132.0.34":o="nistp384";break;case"1.3.132.0.35":o="nistp521";break;default:throw new Error("Unsupported curve in ECDSA private key")}if(n=new ut.Reader(n.readString(ut.OctetString,!0)),n.readSequence(),n.readInt()!==1)throw new Error("Unsupported version in ECDSA private key");let f=Buffer.concat([Buffer.from([0]),n.readString(ut.OctetString,!0)]),a=Buffer.from(`ecdsa-sha2-${o}`);o=Buffer.from(o);let c=Buffer.allocUnsafe(4+a.length+4+o.length+4+i.length+4+f.length),h=0;c.writeUInt32BE(a.length,h+=0),c.set(a,h+=4),c.writeUInt32BE(o.length,h+=a.length),c.set(o,h+=4),c.writeUInt32BE(i.length,h+=o.length),c.set(i,h+=4),c.writeUInt32BE(f.length,h+=i.length),c.set(f,h+=4);let l=Buffer.allocUnsafe(4+a.length+4+o.length+4+i.length);return h=0,l.writeUInt32BE(a.length,h+=0),l.set(a,h+=4),l.writeUInt32BE(o.length,h+=a.length),l.set(o,h+=4),l.writeUInt32BE(i.length,h+=o.length),l.set(i,h+=4),{sshName:a.toString(),priv:c,pub:l}}case"ed25519":{let n=new ut.Reader(e);if(n.readSequence(),n.readSequence(),n.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 public OID");let i=n.readString(ut.BitString,!0);{let h=0;for(;h<i.length&&i[h]===0;++h);h>0&&(i=i.slice(h))}if(n=new ut.Reader(t),n.readSequence(),n.readInt()!==0)throw new Error("Unsupported version in ED25519 private key");if(n.readSequence(),n.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 private OID");n=new ut.Reader(n.readString(ut.OctetString,!0));let s=n.readString(ut.OctetString,!0),o=Buffer.from("ssh-ed25519"),f=Buffer.allocUnsafe(4+o.length+4+i.length+4+(s.length+i.length)),a=0;f.writeUInt32BE(o.length,a+=0),f.set(o,a+=4),f.writeUInt32BE(i.length,a+=o.length),f.set(i,a+=4),f.writeUInt32BE(s.length+i.length,a+=i.length),f.set(s,a+=4),f.set(i,a+=s.length);let c=Buffer.allocUnsafe(4+o.length+4+i.length);return a=0,c.writeUInt32BE(o.length,a+=0),c.set(o,a+=4),c.writeUInt32BE(i.length,a+=o.length),c.set(i,a+=4),{sshName:o.toString(),priv:f,pub:c}}}}function ih(r,e,t,n){let i="new",s,o="";if(typeof n=="object"&&n!==null&&(typeof n.comment=="string"&&n.comment&&(o=n.comment),typeof n.format=="string"&&n.format&&(i=n.format),n.passphrase)){let f;if(typeof n.passphrase=="string")f=Buffer.from(n.passphrase);else if(Buffer.isBuffer(n.passphrase))f=n.passphrase;else throw new Error("Invalid passphrase");if(n.cipher===void 0)throw new Error("Missing cipher name");let a=UA.get(n.cipher);if(a===void 0)throw new Error("Invalid cipher name");if(i==="new"){let c=LA;if(n.rounds!==void 0){if(!Number.isInteger(n.rounds))throw new TypeError("rounds must be an integer");n.rounds>0&&(c=n.rounds)}let h=Buffer.allocUnsafe(a.keyLen+a.ivLen),l=rh(TA);if(vA(f,f.length,l,l.length,h,h.length,c)!==0)return new Error("Failed to generate information to encrypt key");let p=Buffer.allocUnsafe(4+l.length+4);{let y=0;p.writeUInt32BE(l.length,y+=0),p.set(l,y+=4),p.writeUInt32BE(c,y+=l.length)}s={cipher:a,cipherName:n.cipher,kdfName:"bcrypt",kdfOptions:p,key:h.slice(0,a.keyLen),iv:h.slice(a.keyLen)}}}switch(i){case"new":{let f=`-----BEGIN OPENSSH PRIVATE KEY-----
`,a,c=Buffer.from(s?s.cipherName:"none"),h=Buffer.from(s?s.kdfName:"none"),l=s?s.kdfOptions:Buffer.alloc(0),g=s?s.cipher.blockLen:8,p=PA(r,e,t),y=rh(4),b=Buffer.from(o),x=4+4+p.priv.length+4+b.length,m=[];for(let q=1;(x+m.length)%g;++q)m.push(q&255);m=Buffer.from(m);let L=Buffer.allocUnsafe(x+m.length),W;{let q=0;L.set(y,q+=0),L.set(y,q+=4),L.set(p.priv,q+=4),L.writeUInt32BE(b.length,q+=p.priv.length),L.set(b,q+=4),L.set(m,q+=b.length)}if(s){let q={authTagLength:s.cipher.authLen},X=BA(s.cipher.sslName,s.key,s.iv,q);X.setAutoPadding(!1),L=Buffer.concat([X.update(L),X.final()]),s.cipher.authLen>0?W=X.getAuthTag():W=Buffer.alloc(0),s.key.fill(0),s.iv.fill(0)}else W=Buffer.alloc(0);let N=Buffer.from("openssh-key-v1\0"),K=Buffer.allocUnsafe(N.length+4+c.length+4+h.length+4+l.length+4+4+p.pub.length+4+L.length+W.length);{let q=0;K.set(N,q+=0),K.writeUInt32BE(c.length,q+=N.length),K.set(c,q+=4),K.writeUInt32BE(h.length,q+=c.length),K.set(h,q+=4),K.writeUInt32BE(l.length,q+=h.length),K.set(l,q+=4),K.writeUInt32BE(1,q+=l.length),K.writeUInt32BE(p.pub.length,q+=4),K.set(p.pub,q+=4),K.writeUInt32BE(L.length,q+=p.pub.length),K.set(L,q+=4),K.set(W,q+=L.length)}{let q=K.base64Slice(0,K.length),X=q.replace(/.{64}/g,`$&
`);q.length&63&&(X+=`
`),f+=X}{let q=p.pub.base64Slice(0,p.pub.length);a=`${p.sshName} ${q}${o?` ${o}`:""}`}return f+=`-----END OPENSSH PRIVATE KEY-----
`,{private:f,public:a}}default:throw new Error("Invalid output key format")}}function DA(){}sh.exports={generateKeyPair:(r,e,t)=>{typeof e=="function"&&(t=e,e=void 0),typeof t!="function"&&(t=DA);let n=nh(r,e);CA(...n,(i,s,o)=>{if(i)return t(i);let f;try{f=ih(n[0],s,o,e)}catch(a){return t(a)}t(null,f)})},generateKeyPairSync:(r,e)=>{let t=nh(r,e),{publicKey:n,privateKey:i}=RA(...t);return ih(t[0],n,i,e)}}});var ah=_e((Hb,fh)=>{"use strict";var{AgentProtocol:HA,BaseAgent:QA,createAgent:MA,CygwinAgent:FA,OpenSSHAgent:qA,PageantAgent:WA}=Ko(),{SSHTTPAgent:KA,SSHTTPSAgent:$A}=Zu(),{parseKey:GA}=kr(),{flagsToString:YA,OPEN_MODE:jA,STATUS_CODE:XA,stringToFlags:VA}=fi();fh.exports={AgentProtocol:HA,BaseAgent:QA,createAgent:MA,Client:Tf(),CygwinAgent:FA,HTTPAgent:KA,HTTPSAgent:$A,OpenSSHAgent:qA,PageantAgent:WA,Server:th(),utils:{parseKey:GA,...oh(),sftp:{flagsToString:YA,OPEN_MODE:jA,STATUS_CODE:XA,stringToFlags:VA}}}});var Qf=_e((Qb,ch)=>{ch.exports=require("stream")});var Ah=_e((Mb,gh)=>{"use strict";function uh(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function hh(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uh(Object(t),!0).forEach(function(n){zA(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):uh(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function zA(r,e,t){return e=dh(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function JA(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function lh(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,dh(n.key),n)}}function ZA(r,e,t){return e&&lh(r.prototype,e),t&&lh(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function dh(r){var e=e_(r,"string");return typeof e=="symbol"?e:String(e)}function e_(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var t_=require("buffer"),Is=t_.Buffer,r_=require("util"),Mf=r_.inspect,n_=Mf&&Mf.custom||"inspect";function i_(r,e,t){Is.prototype.copy.call(r,e,t)}gh.exports=function(){function r(){JA(this,r),this.head=null,this.tail=null,this.length=0}return ZA(r,[{key:"push",value:function(t){var n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(t){var n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=t+n.data;return i}},{key:"concat",value:function(t){if(this.length===0)return Is.alloc(0);for(var n=Is.allocUnsafe(t>>>0),i=this.head,s=0;i;)i_(i.data,n,s),s+=i.data.length,i=i.next;return n}},{key:"consume",value:function(t,n){var i;return t<this.head.data.length?(i=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):t===this.head.data.length?i=this.shift():i=n?this._getString(t):this._getBuffer(t),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var n=this.head,i=1,s=n.data;for(t-=s.length;n=n.next;){var o=n.data,f=t>o.length?o.length:t;if(f===o.length?s+=o:s+=o.slice(0,t),t-=f,t===0){f===o.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(f));break}++i}return this.length-=i,s}},{key:"_getBuffer",value:function(t){var n=Is.allocUnsafe(t),i=this.head,s=1;for(i.data.copy(n),t-=i.data.length;i=i.next;){var o=i.data,f=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,f),t-=f,t===0){f===o.length?(++s,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(f));break}++s}return this.length-=s,n}},{key:n_,value:function(t,n){return Mf(this,hh(hh({},n),{},{depth:0,customInspect:!1}))}}]),r}()});var qf=_e((Fb,ph)=>{"use strict";function s_(r,e){var t=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Ff,this,r)):process.nextTick(Ff,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?t._writableState?t._writableState.errorEmitted?process.nextTick(ms,t):(t._writableState.errorEmitted=!0,process.nextTick(_h,t,s)):process.nextTick(_h,t,s):e?(process.nextTick(ms,t),e(s)):process.nextTick(ms,t)}),this)}function _h(r,e){Ff(r,e),ms(r)}function ms(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function o_(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Ff(r,e){r.emit("error",e)}function f_(r,e){var t=r._readableState,n=r._writableState;t&&t.autoDestroy||n&&n.autoDestroy?r.destroy(e):r.emit("error",e)}ph.exports={destroy:s_,undestroy:o_,errorOrDestroy:f_}});var Ur=_e((qb,yh)=>{"use strict";var bh={};function Zt(r,e,t){t||(t=Error);function n(s,o,f){return typeof e=="string"?e:e(s,o,f)}class i extends t{constructor(o,f,a){super(n(o,f,a))}}i.prototype.name=t.name,i.prototype.code=r,bh[r]=i}function Eh(r,e){if(Array.isArray(r)){let t=r.length;return r=r.map(n=>String(n)),t>2?`one of ${e} ${r.slice(0,t-1).join(", ")}, or `+r[t-1]:t===2?`one of ${e} ${r[0]} or ${r[1]}`:`of ${e} ${r[0]}`}else return`of ${e} ${String(r)}`}function a_(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function c_(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function u_(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}Zt("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError);Zt("ERR_INVALID_ARG_TYPE",function(r,e,t){let n;typeof e=="string"&&a_(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";let i;if(c_(r," argument"))i=`The ${r} ${n} ${Eh(e,"type")}`;else{let s=u_(r,".")?"property":"argument";i=`The "${r}" ${s} ${n} ${Eh(e,"type")}`}return i+=`. Received type ${typeof t}`,i},TypeError);Zt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Zt("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"});Zt("ERR_STREAM_PREMATURE_CLOSE","Premature close");Zt("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"});Zt("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Zt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Zt("ERR_STREAM_WRITE_AFTER_END","write after end");Zt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Zt("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError);Zt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");yh.exports.codes=bh});var Wf=_e((Wb,wh)=>{"use strict";var h_=Ur().codes.ERR_INVALID_OPT_VALUE;function l_(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function d_(r,e,t,n){var i=l_(e,n,t);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var s=n?t:"highWaterMark";throw new h_(s,i)}return Math.floor(i)}return r.objectMode?16:16*1024}wh.exports={getHighWaterMark:d_}});var xh=_e((Kb,Kf)=>{typeof Object.create=="function"?Kf.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Kf.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}});var jr=_e(($b,Gf)=>{try{if($f=require("util"),typeof $f.inherits!="function")throw"";Gf.exports=$f.inherits}catch{Gf.exports=xh()}var $f});var Ih=_e((Gb,Sh)=>{Sh.exports=require("util").deprecate});var Xf=_e((Yb,vh)=>{"use strict";vh.exports=wt;function Bh(r){var e=this;this.next=null,this.entry=null,this.finish=function(){M_(e,r)}}var vn;wt.WritableState=pi;var g_={deprecate:Ih()},Ch=Qf(),Cs=require("buffer").Buffer,A_=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function __(r){return Cs.from(r)}function p_(r){return Cs.isBuffer(r)||r instanceof A_}var jf=qf(),E_=Wf(),b_=E_.getHighWaterMark,Pr=Ur().codes,y_=Pr.ERR_INVALID_ARG_TYPE,w_=Pr.ERR_METHOD_NOT_IMPLEMENTED,x_=Pr.ERR_MULTIPLE_CALLBACK,S_=Pr.ERR_STREAM_CANNOT_PIPE,I_=Pr.ERR_STREAM_DESTROYED,m_=Pr.ERR_STREAM_NULL_VALUES,B_=Pr.ERR_STREAM_WRITE_AFTER_END,C_=Pr.ERR_UNKNOWN_ENCODING,Nn=jf.errorOrDestroy;jr()(wt,Ch);function R_(){}function pi(r,e,t){vn=vn||Xr(),r=r||{},typeof t!="boolean"&&(t=e instanceof vn),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=b_(this,r,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=r.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){U_(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Bh(this)}pi.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(pi.prototype,"buffer",{get:g_.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var Bs;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Bs=Function.prototype[Symbol.hasInstance],Object.defineProperty(wt,Symbol.hasInstance,{value:function(e){return Bs.call(this,e)?!0:this!==wt?!1:e&&e._writableState instanceof pi}})):Bs=function(e){return e instanceof this};function wt(r){vn=vn||Xr();var e=this instanceof vn;if(!e&&!Bs.call(wt,this))return new wt(r);this._writableState=new pi(r,this,e),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),Ch.call(this)}wt.prototype.pipe=function(){Nn(this,new S_)};function k_(r,e){var t=new B_;Nn(r,t),process.nextTick(e,t)}function v_(r,e,t,n){var i;return t===null?i=new m_:typeof t!="string"&&!e.objectMode&&(i=new y_("chunk",["string","Buffer"],t)),i?(Nn(r,i),process.nextTick(n,i),!1):!0}wt.prototype.write=function(r,e,t){var n=this._writableState,i=!1,s=!n.objectMode&&p_(r);return s&&!Cs.isBuffer(r)&&(r=__(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=n.defaultEncoding),typeof t!="function"&&(t=R_),n.ending?k_(this,t):(s||v_(this,n,r,t))&&(n.pendingcb++,i=T_(this,n,s,r,e,t)),i};wt.prototype.cork=function(){this._writableState.corked++};wt.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Rh(this,r))};wt.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new C_(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(wt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function N_(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=Cs.from(e,t)),e}Object.defineProperty(wt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function T_(r,e,t,n,i,s){if(!t){var o=N_(e,n,i);n!==o&&(t=!0,i="buffer",n=o)}var f=e.objectMode?1:n.length;e.length+=f;var a=e.length<e.highWaterMark;if(a||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:t,callback:s,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Yf(r,e,!1,f,n,i,s);return a}function Yf(r,e,t,n,i,s,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new I_("write")):t?r._writev(i,e.onwrite):r._write(i,s,e.onwrite),e.sync=!1}function L_(r,e,t,n,i){--e.pendingcb,t?(process.nextTick(i,n),process.nextTick(_i,r,e),r._writableState.errorEmitted=!0,Nn(r,n)):(i(n),r._writableState.errorEmitted=!0,Nn(r,n),_i(r,e))}function O_(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function U_(r,e){var t=r._writableState,n=t.sync,i=t.writecb;if(typeof i!="function")throw new x_;if(O_(t),e)L_(r,t,n,e,i);else{var s=kh(t)||r.destroyed;!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Rh(r,t),n?process.nextTick(mh,r,t,s,i):mh(r,t,s,i)}}function mh(r,e,t,n){t||P_(r,e),e.pendingcb--,n(),_i(r,e)}function P_(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function Rh(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var n=e.bufferedRequestCount,i=new Array(n),s=e.corkedRequestsFree;s.entry=t;for(var o=0,f=!0;t;)i[o]=t,t.isBuf||(f=!1),t=t.next,o+=1;i.allBuffers=f,Yf(r,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new Bh(e),e.bufferedRequestCount=0}else{for(;t;){var a=t.chunk,c=t.encoding,h=t.callback,l=e.objectMode?1:a.length;if(Yf(r,e,!1,l,a,c,h),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}wt.prototype._write=function(r,e,t){t(new w_("_write()"))};wt.prototype._writev=null;wt.prototype.end=function(r,e,t){var n=this._writableState;return typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),n.corked&&(n.corked=1,this.uncork()),n.ending||Q_(this,n,t),this};Object.defineProperty(wt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function kh(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function D_(r,e){r._final(function(t){e.pendingcb--,t&&Nn(r,t),e.prefinished=!0,r.emit("prefinish"),_i(r,e)})}function H_(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(D_,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function _i(r,e){var t=kh(e);if(t&&(H_(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"),e.autoDestroy))){var n=r._readableState;(!n||n.autoDestroy&&n.endEmitted)&&r.destroy()}return t}function Q_(r,e,t){e.ending=!0,_i(r,e),t&&(e.finished?process.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function M_(r,e,t){var n=r.entry;for(r.entry=null;n;){var i=n.callback;e.pendingcb--,i(t),n=n.next}e.corkedRequestsFree.next=r}Object.defineProperty(wt.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}});wt.prototype.destroy=jf.destroy;wt.prototype._undestroy=jf.undestroy;wt.prototype._destroy=function(r,e){e(r)}});var Xr=_e((jb,Th)=>{"use strict";var F_=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};Th.exports=hr;var Nh=Jf(),zf=Xf();jr()(hr,Nh);for(Vf=F_(zf.prototype),Rs=0;Rs<Vf.length;Rs++)ks=Vf[Rs],hr.prototype[ks]||(hr.prototype[ks]=zf.prototype[ks]);var Vf,ks,Rs;function hr(r){if(!(this instanceof hr))return new hr(r);Nh.call(this,r),zf.call(this,r),this.allowHalfOpen=!0,r&&(r.readable===!1&&(this.readable=!1),r.writable===!1&&(this.writable=!1),r.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",q_)))}Object.defineProperty(hr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(hr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(hr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function q_(){this._writableState.ended||process.nextTick(W_,this)}function W_(r){r.end()}Object.defineProperty(hr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var Uh=_e((Zf,Oh)=>{var vs=require("buffer"),lr=vs.Buffer;function Lh(r,e){for(var t in r)e[t]=r[t]}lr.from&&lr.alloc&&lr.allocUnsafe&&lr.allocUnsafeSlow?Oh.exports=vs:(Lh(vs,Zf),Zf.Buffer=Vr);function Vr(r,e,t){return lr(r,e,t)}Vr.prototype=Object.create(lr.prototype);Lh(lr,Vr);Vr.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return lr(r,e,t)};Vr.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=lr(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};Vr.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return lr(r)};Vr.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return vs.SlowBuffer(r)}});var ra=_e(Dh=>{"use strict";var ta=Uh().Buffer,Ph=ta.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function K_(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function $_(r){var e=K_(r);if(typeof e!="string"&&(ta.isEncoding===Ph||!Ph(r)))throw new Error("Unknown encoding: "+r);return e||r}Dh.StringDecoder=Ei;function Ei(r){this.encoding=$_(r);var e;switch(this.encoding){case"utf16le":this.text=z_,this.end=J_,e=4;break;case"utf8":this.fillLast=j_,e=4;break;case"base64":this.text=Z_,this.end=ep,e=3;break;default:this.write=tp,this.end=rp;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=ta.allocUnsafe(e)}Ei.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};Ei.prototype.end=V_;Ei.prototype.text=X_;Ei.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function ea(r){return r<=127?0:r>>5===6?2:r>>4===14?3:r>>3===30?4:r>>6===2?-1:-2}function G_(r,e,t){var n=e.length-1;if(n<t)return 0;var i=ea(e[n]);return i>=0?(i>0&&(r.lastNeed=i-1),i):--n<t||i===-2?0:(i=ea(e[n]),i>=0?(i>0&&(r.lastNeed=i-2),i):--n<t||i===-2?0:(i=ea(e[n]),i>=0?(i>0&&(i===2?i=0:r.lastNeed=i-3),i):0))}function Y_(r,e,t){if((e[0]&192)!==128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return r.lastNeed=2,"\uFFFD"}}function j_(r){var e=this.lastTotal-this.lastNeed,t=Y_(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function X_(r,e){var t=G_(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var n=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,n),r.toString("utf8",e,n)}function V_(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function z_(r,e){if((r.length-e)%2===0){var t=r.toString("utf16le",e);if(t){var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function J_(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function Z_(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function ep(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function tp(r){return r.toString(this.encoding)}function rp(r){return r&&r.length?this.write(r):""}});var Ns=_e((Vb,Mh)=>{"use strict";var Hh=Ur().codes.ERR_STREAM_PREMATURE_CLOSE;function np(r){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];r.apply(this,n)}}}function ip(){}function sp(r){return r.setHeader&&typeof r.abort=="function"}function Qh(r,e,t){if(typeof e=="function")return Qh(r,null,e);e||(e={}),t=np(t||ip);var n=e.readable||e.readable!==!1&&r.readable,i=e.writable||e.writable!==!1&&r.writable,s=function(){r.writable||f()},o=r._writableState&&r._writableState.finished,f=function(){i=!1,o=!0,n||t.call(r)},a=r._readableState&&r._readableState.endEmitted,c=function(){n=!1,a=!0,i||t.call(r)},h=function(y){t.call(r,y)},l=function(){var y;if(n&&!a)return(!r._readableState||!r._readableState.ended)&&(y=new Hh),t.call(r,y);if(i&&!o)return(!r._writableState||!r._writableState.ended)&&(y=new Hh),t.call(r,y)},g=function(){r.req.on("finish",f)};return sp(r)?(r.on("complete",f),r.on("abort",l),r.req?g():r.on("request",g)):i&&!r._writableState&&(r.on("end",s),r.on("close",s)),r.on("end",c),r.on("finish",f),e.error!==!1&&r.on("error",h),r.on("close",l),function(){r.removeListener("complete",f),r.removeListener("abort",l),r.removeListener("request",g),r.req&&r.req.removeListener("finish",f),r.removeListener("end",s),r.removeListener("close",s),r.removeListener("finish",f),r.removeListener("end",c),r.removeListener("error",h),r.removeListener("close",l)}}Mh.exports=Qh});var qh=_e((zb,Fh)=>{"use strict";var Ts;function Dr(r,e,t){return e=op(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function op(r){var e=fp(r,"string");return typeof e=="symbol"?e:String(e)}function fp(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ap=Ns(),Hr=Symbol("lastResolve"),zr=Symbol("lastReject"),bi=Symbol("error"),Ls=Symbol("ended"),Jr=Symbol("lastPromise"),na=Symbol("handlePromise"),Zr=Symbol("stream");function Qr(r,e){return{value:r,done:e}}function cp(r){var e=r[Hr];if(e!==null){var t=r[Zr].read();t!==null&&(r[Jr]=null,r[Hr]=null,r[zr]=null,e(Qr(t,!1)))}}function up(r){process.nextTick(cp,r)}function hp(r,e){return function(t,n){r.then(function(){if(e[Ls]){t(Qr(void 0,!0));return}e[na](t,n)},n)}}var lp=Object.getPrototypeOf(function(){}),dp=Object.setPrototypeOf((Ts={get stream(){return this[Zr]},next:function(){var e=this,t=this[bi];if(t!==null)return Promise.reject(t);if(this[Ls])return Promise.resolve(Qr(void 0,!0));if(this[Zr].destroyed)return new Promise(function(o,f){process.nextTick(function(){e[bi]?f(e[bi]):o(Qr(void 0,!0))})});var n=this[Jr],i;if(n)i=new Promise(hp(n,this));else{var s=this[Zr].read();if(s!==null)return Promise.resolve(Qr(s,!1));i=new Promise(this[na])}return this[Jr]=i,i}},Dr(Ts,Symbol.asyncIterator,function(){return this}),Dr(Ts,"return",function(){var e=this;return new Promise(function(t,n){e[Zr].destroy(null,function(i){if(i){n(i);return}t(Qr(void 0,!0))})})}),Ts),lp),gp=function(e){var t,n=Object.create(dp,(t={},Dr(t,Zr,{value:e,writable:!0}),Dr(t,Hr,{value:null,writable:!0}),Dr(t,zr,{value:null,writable:!0}),Dr(t,bi,{value:null,writable:!0}),Dr(t,Ls,{value:e._readableState.endEmitted,writable:!0}),Dr(t,na,{value:function(s,o){var f=n[Zr].read();f?(n[Jr]=null,n[Hr]=null,n[zr]=null,s(Qr(f,!1))):(n[Hr]=s,n[zr]=o)},writable:!0}),t));return n[Jr]=null,ap(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=n[zr];s!==null&&(n[Jr]=null,n[Hr]=null,n[zr]=null,s(i)),n[bi]=i;return}var o=n[Hr];o!==null&&(n[Jr]=null,n[Hr]=null,n[zr]=null,o(Qr(void 0,!0))),n[Ls]=!0}),e.on("readable",up.bind(null,n)),n};Fh.exports=gp});var Gh=_e((Jb,$h)=>{"use strict";function Wh(r,e,t,n,i,s,o){try{var f=r[s](o),a=f.value}catch(c){t(c);return}f.done?e(a):Promise.resolve(a).then(n,i)}function Ap(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function o(a){Wh(s,n,i,o,f,"next",a)}function f(a){Wh(s,n,i,o,f,"throw",a)}o(void 0)})}}function Kh(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function _p(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Kh(Object(t),!0).forEach(function(n){pp(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Kh(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function pp(r,e,t){return e=Ep(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ep(r){var e=bp(r,"string");return typeof e=="symbol"?e:String(e)}function bp(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var yp=Ur().codes.ERR_INVALID_ARG_TYPE;function wp(r,e,t){var n;if(e&&typeof e.next=="function")n=e;else if(e&&e[Symbol.asyncIterator])n=e[Symbol.asyncIterator]();else if(e&&e[Symbol.iterator])n=e[Symbol.iterator]();else throw new yp("iterable",["Iterable"],e);var i=new r(_p({objectMode:!0},t)),s=!1;i._read=function(){s||(s=!0,o())};function o(){return f.apply(this,arguments)}function f(){return f=Ap(function*(){try{var a=yield n.next(),c=a.value,h=a.done;h?i.push(null):i.push(yield c)?o():s=!1}catch(l){i.destroy(l)}}),f.apply(this,arguments)}return i}$h.exports=wp});var Jf=_e((ey,rl)=>{"use strict";rl.exports=tt;var Tn;tt.ReadableState=Vh;var Zb=require("events").EventEmitter,Xh=function(e,t){return e.listeners(t).length},wi=Qf(),Os=require("buffer").Buffer,xp=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Sp(r){return Os.from(r)}function Ip(r){return Os.isBuffer(r)||r instanceof xp}var ia=require("util"),We;ia&&ia.debuglog?We=ia.debuglog("stream"):We=function(){};var mp=Ah(),ha=qf(),Bp=Wf(),Cp=Bp.getHighWaterMark,Us=Ur().codes,Rp=Us.ERR_INVALID_ARG_TYPE,kp=Us.ERR_STREAM_PUSH_AFTER_EOF,vp=Us.ERR_METHOD_NOT_IMPLEMENTED,Np=Us.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Ln,sa,oa;jr()(tt,wi);var yi=ha.errorOrDestroy,fa=["error","close","destroy","pause","resume"];function Tp(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function Vh(r,e,t){Tn=Tn||Xr(),r=r||{},typeof t!="boolean"&&(t=e instanceof Tn),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode),this.highWaterMark=Cp(this,r,"readableHighWaterMark",t),this.buffer=new mp,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(Ln||(Ln=ra().StringDecoder),this.decoder=new Ln(r.encoding),this.encoding=r.encoding)}function tt(r){if(Tn=Tn||Xr(),!(this instanceof tt))return new tt(r);var e=this instanceof Tn;this._readableState=new Vh(r,this,e),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),wi.call(this)}Object.defineProperty(tt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}});tt.prototype.destroy=ha.destroy;tt.prototype._undestroy=ha.undestroy;tt.prototype._destroy=function(r,e){e(r)};tt.prototype.push=function(r,e){var t=this._readableState,n;return t.objectMode?n=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=Os.from(r,e),e=""),n=!0),zh(this,r,e,!1,n)};tt.prototype.unshift=function(r){return zh(this,r,null,!0,!1)};function zh(r,e,t,n,i){We("readableAddChunk",e);var s=r._readableState;if(e===null)s.reading=!1,Up(r,s);else{var o;if(i||(o=Lp(s,e)),o)yi(r,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==Os.prototype&&(e=Sp(e)),n)s.endEmitted?yi(r,new Np):aa(r,s,e,!0);else if(s.ended)yi(r,new kp);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?aa(r,s,e,!1):ua(r,s)):aa(r,s,e,!1)}else n||(s.reading=!1,ua(r,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function aa(r,e,t,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,r.emit("data",t)):(e.length+=e.objectMode?1:t.length,n?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&Ps(r)),ua(r,e)}function Lp(r,e){var t;return!Ip(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new Rp("chunk",["string","Buffer","Uint8Array"],e)),t}tt.prototype.isPaused=function(){return this._readableState.flowing===!1};tt.prototype.setEncoding=function(r){Ln||(Ln=ra().StringDecoder);var e=new Ln(r);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var t=this._readableState.buffer.head,n="";t!==null;)n+=e.write(t.data),t=t.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var Yh=1073741824;function Op(r){return r>=Yh?r=Yh:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function jh(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=Op(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}tt.prototype.read=function(r){We("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return We("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?ca(this):Ps(this),null;if(r=jh(r,e),r===0&&e.ended)return e.length===0&&ca(this),null;var n=e.needReadable;We("need readable",n),(e.length===0||e.length-r<e.highWaterMark)&&(n=!0,We("length less than watermark",n)),e.ended||e.reading?(n=!1,We("reading or ended",n)):n&&(We("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=jh(t,e)));var i;return r>0?i=el(r,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,r=0):(e.length-=r,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&ca(this)),i!==null&&this.emit("data",i),i};function Up(r,e){if(We("onEofChunk"),!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?Ps(r):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Jh(r)))}}function Ps(r){var e=r._readableState;We("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(We("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Jh,r))}function Jh(r){var e=r._readableState;We("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(r.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,la(r)}function ua(r,e){e.readingMore||(e.readingMore=!0,process.nextTick(Pp,r,e))}function Pp(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var t=e.length;if(We("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}tt.prototype._read=function(r){yi(this,new vp("_read()"))};tt.prototype.pipe=function(r,e){var t=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=r;break;case 1:n.pipes=[n.pipes,r];break;default:n.pipes.push(r);break}n.pipesCount+=1,We("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=i?f:b;n.endEmitted?process.nextTick(s):t.once("end",s),r.on("unpipe",o);function o(x,m){We("onunpipe"),x===t&&m&&m.hasUnpiped===!1&&(m.hasUnpiped=!0,h())}function f(){We("onend"),r.end()}var a=Dp(t);r.on("drain",a);var c=!1;function h(){We("cleanup"),r.removeListener("close",p),r.removeListener("finish",y),r.removeListener("drain",a),r.removeListener("error",g),r.removeListener("unpipe",o),t.removeListener("end",f),t.removeListener("end",b),t.removeListener("data",l),c=!0,n.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&a()}t.on("data",l);function l(x){We("ondata");var m=r.write(x);We("dest.write",m),m===!1&&((n.pipesCount===1&&n.pipes===r||n.pipesCount>1&&tl(n.pipes,r)!==-1)&&!c&&(We("false write response, pause",n.awaitDrain),n.awaitDrain++),t.pause())}function g(x){We("onerror",x),b(),r.removeListener("error",g),Xh(r,"error")===0&&yi(r,x)}Tp(r,"error",g);function p(){r.removeListener("finish",y),b()}r.once("close",p);function y(){We("onfinish"),r.removeListener("close",p),b()}r.once("finish",y);function b(){We("unpipe"),t.unpipe(r)}return r.emit("pipe",t),n.flowing||(We("pipe resume"),t.resume()),r};function Dp(r){return function(){var t=r._readableState;We("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&Xh(r,"data")&&(t.flowing=!0,la(r))}}tt.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=tl(e.pipes,r);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};tt.prototype.on=function(r,e){var t=wi.prototype.on.call(this,r,e),n=this._readableState;return r==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):r==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,We("on readable",n.length,n.reading),n.length?Ps(this):n.reading||process.nextTick(Hp,this)),t};tt.prototype.addListener=tt.prototype.on;tt.prototype.removeListener=function(r,e){var t=wi.prototype.removeListener.call(this,r,e);return r==="readable"&&process.nextTick(Zh,this),t};tt.prototype.removeAllListeners=function(r){var e=wi.prototype.removeAllListeners.apply(this,arguments);return(r==="readable"||r===void 0)&&process.nextTick(Zh,this),e};function Zh(r){var e=r._readableState;e.readableListening=r.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:r.listenerCount("data")>0&&r.resume()}function Hp(r){We("readable nexttick read 0"),r.read(0)}tt.prototype.resume=function(){var r=this._readableState;return r.flowing||(We("resume"),r.flowing=!r.readableListening,Qp(this,r)),r.paused=!1,this};function Qp(r,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(Mp,r,e))}function Mp(r,e){We("resume",e.reading),e.reading||r.read(0),e.resumeScheduled=!1,r.emit("resume"),la(r),e.flowing&&!e.reading&&r.read(0)}tt.prototype.pause=function(){return We("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(We("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function la(r){var e=r._readableState;for(We("flow",e.flowing);e.flowing&&r.read()!==null;);}tt.prototype.wrap=function(r){var e=this,t=this._readableState,n=!1;r.on("end",function(){if(We("wrapped end"),t.decoder&&!t.ended){var o=t.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),r.on("data",function(o){if(We("wrapped data"),t.decoder&&(o=t.decoder.write(o)),!(t.objectMode&&o==null)&&!(!t.objectMode&&(!o||!o.length))){var f=e.push(o);f||(n=!0,r.pause())}});for(var i in r)this[i]===void 0&&typeof r[i]=="function"&&(this[i]=function(f){return function(){return r[f].apply(r,arguments)}}(i));for(var s=0;s<fa.length;s++)r.on(fa[s],this.emit.bind(this,fa[s]));return this._read=function(o){We("wrapped _read",o),n&&(n=!1,r.resume())},this};typeof Symbol=="function"&&(tt.prototype[Symbol.asyncIterator]=function(){return sa===void 0&&(sa=qh()),sa(this)});Object.defineProperty(tt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(tt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(tt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});tt._fromList=el;Object.defineProperty(tt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function el(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.first():t=e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t}function ca(r){var e=r._readableState;We("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(Fp,e,r))}function Fp(r,e){if(We("endReadableNT",r.endEmitted,r.length),!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"),r.autoDestroy)){var t=e._writableState;(!t||t.autoDestroy&&t.finished)&&e.destroy()}}typeof Symbol=="function"&&(tt.from=function(r,e){return oa===void 0&&(oa=Gh()),oa(tt,r,e)});function tl(r,e){for(var t=0,n=r.length;t<n;t++)if(r[t]===e)return t;return-1}});var da=_e((ty,il)=>{"use strict";il.exports=xr;var Ds=Ur().codes,qp=Ds.ERR_METHOD_NOT_IMPLEMENTED,Wp=Ds.ERR_MULTIPLE_CALLBACK,Kp=Ds.ERR_TRANSFORM_ALREADY_TRANSFORMING,$p=Ds.ERR_TRANSFORM_WITH_LENGTH_0,Hs=Xr();jr()(xr,Hs);function Gp(r,e){var t=this._transformState;t.transforming=!1;var n=t.writecb;if(n===null)return this.emit("error",new Wp);t.writechunk=null,t.writecb=null,e!=null&&this.push(e),n(r);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function xr(r){if(!(this instanceof xr))return new xr(r);Hs.call(this,r),this._transformState={afterTransform:Gp.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",Yp)}function Yp(){var r=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,t){nl(r,e,t)}):nl(this,null,null)}xr.prototype.push=function(r,e){return this._transformState.needTransform=!1,Hs.prototype.push.call(this,r,e)};xr.prototype._transform=function(r,e,t){t(new qp("_transform()"))};xr.prototype._write=function(r,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=r,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};xr.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};xr.prototype._destroy=function(r,e){Hs.prototype._destroy.call(this,r,function(t){e(t)})};function nl(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new $p;if(r._transformState.transforming)throw new Kp;return r.push(null)}});var fl=_e((ry,ol)=>{"use strict";ol.exports=xi;var sl=da();jr()(xi,sl);function xi(r){if(!(this instanceof xi))return new xi(r);sl.call(this,r)}xi.prototype._transform=function(r,e,t){t(null,r)}});var ll=_e((ny,hl)=>{"use strict";var ga;function jp(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var ul=Ur().codes,Xp=ul.ERR_MISSING_ARGS,Vp=ul.ERR_STREAM_DESTROYED;function al(r){if(r)throw r}function zp(r){return r.setHeader&&typeof r.abort=="function"}function Jp(r,e,t,n){n=jp(n);var i=!1;r.on("close",function(){i=!0}),ga===void 0&&(ga=Ns()),ga(r,{readable:e,writable:t},function(o){if(o)return n(o);i=!0,n()});var s=!1;return function(o){if(!i&&!s){if(s=!0,zp(r))return r.abort();if(typeof r.destroy=="function")return r.destroy();n(o||new Vp("pipe"))}}}function cl(r){r()}function Zp(r,e){return r.pipe(e)}function eE(r){return!r.length||typeof r[r.length-1]!="function"?al:r.pop()}function tE(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=eE(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Xp("streams");var i,s=e.map(function(o,f){var a=f<e.length-1,c=f>0;return Jp(o,a,c,function(h){i||(i=h),h&&s.forEach(cl),!a&&(s.forEach(cl),n(i))})});return e.reduce(Zp)}hl.exports=tE});var dl=_e((er,Ii)=>{var Si=require("stream");process.env.READABLE_STREAM==="disable"&&Si?(Ii.exports=Si.Readable,Object.assign(Ii.exports,Si),Ii.exports.Stream=Si):(er=Ii.exports=Jf(),er.Stream=Si||er,er.Readable=er,er.Writable=Xf(),er.Duplex=Xr(),er.Transform=da(),er.PassThrough=fl(),er.finished=Ns(),er.pipeline=ll())});var Al=_e((iy,gl)=>{var rE=Object.prototype.toString,Aa=typeof Buffer<"u"&&typeof Buffer.alloc=="function"&&typeof Buffer.allocUnsafe=="function"&&typeof Buffer.from=="function";function nE(r){return rE.call(r).slice(8,-1)==="ArrayBuffer"}function iE(r,e,t){e>>>=0;var n=r.byteLength-e;if(n<0)throw new RangeError("'offset' is out of bounds");if(t===void 0)t=n;else if(t>>>=0,t>n)throw new RangeError("'length' is out of bounds");return Aa?Buffer.from(r.slice(e,e+t)):new Buffer(new Uint8Array(r.slice(e,e+t)))}function sE(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!Buffer.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');return Aa?Buffer.from(r,e):new Buffer(r,e)}function oE(r,e,t){if(typeof r=="number")throw new TypeError('"value" argument must not be a number');return nE(r)?iE(r,e,t):typeof r=="string"?sE(r,e):Aa?Buffer.from(r):new Buffer(r)}gl.exports=oE});var wl=_e(ke=>{var _l=void 0,fE=1e5,ht=function(){var r=Object.prototype.toString,e=Object.prototype.hasOwnProperty;return{Class:function(t){return r.call(t).replace(/^\[object *|\]$/g,"")},HasProperty:function(t,n){return n in t},HasOwnProperty:function(t,n){return e.call(t,n)},IsCallable:function(t){return typeof t=="function"},ToInt32:function(t){return t>>0},ToUint32:function(t){return t>>>0}}}(),aE=Math.LN2,cE=Math.abs,Qs=Math.floor,uE=Math.log,hE=Math.min,or=Math.pow,lE=Math.round;function _a(r){if(pl&&On){var e=pl(r),t;for(t=0;t<e.length;t+=1)On(r,e[t],{value:r[e[t]],writable:!1,enumerable:!1,configurable:!1})}}var On;Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}()?On=Object.defineProperty:On=function(r,e,t){if(!r===Object(r))throw new TypeError("Object.defineProperty called on non-object");return ht.HasProperty(t,"get")&&Object.prototype.__defineGetter__&&Object.prototype.__defineGetter__.call(r,e,t.get),ht.HasProperty(t,"set")&&Object.prototype.__defineSetter__&&Object.prototype.__defineSetter__.call(r,e,t.set),ht.HasProperty(t,"value")&&(r[e]=t.value),r};var pl=Object.getOwnPropertyNames||function(r){if(r!==Object(r))throw new TypeError("Object.getOwnPropertyNames called on non-object");var e=[],t;for(t in r)ht.HasOwnProperty(r,t)&&e.push(t);return e};function dE(r){if(!On)return;if(r.length>fE)throw new RangeError("Array too large for polyfill");function e(n){On(r,n,{get:function(){return r._getter(n)},set:function(i){r._setter(n,i)},enumerable:!0,configurable:!1})}var t;for(t=0;t<r.length;t+=1)e(t)}function pa(r,e){var t=32-e;return r<<t>>t}function Ea(r,e){var t=32-e;return r<<t>>>t}function gE(r){return[r&255]}function AE(r){return pa(r[0],8)}function _E(r){return[r&255]}function El(r){return Ea(r[0],8)}function pE(r){return r=lE(Number(r)),[r<0?0:r>255?255:r&255]}function EE(r){return[r>>8&255,r&255]}function bE(r){return pa(r[0]<<8|r[1],16)}function yE(r){return[r>>8&255,r&255]}function wE(r){return Ea(r[0]<<8|r[1],16)}function xE(r){return[r>>24&255,r>>16&255,r>>8&255,r&255]}function SE(r){return pa(r[0]<<24|r[1]<<16|r[2]<<8|r[3],32)}function IE(r){return[r>>24&255,r>>16&255,r>>8&255,r&255]}function mE(r){return Ea(r[0]<<24|r[1]<<16|r[2]<<8|r[3],32)}function bl(r,e,t){var n=(1<<e-1)-1,i,s,o,f,a,c,h,l;function g(p){var y=Qs(p),b=p-y;return b<.5?y:b>.5||y%2?y+1:y}for(r!==r?(s=(1<<e)-1,o=or(2,t-1),i=0):r===1/0||r===-1/0?(s=(1<<e)-1,o=0,i=r<0?1:0):r===0?(s=0,o=0,i=1/r===-1/0?1:0):(i=r<0,r=cE(r),r>=or(2,1-n)?(s=hE(Qs(uE(r)/aE),1023),o=g(r/or(2,s)*or(2,t)),o/or(2,t)>=2&&(s=s+1,o=1),s>n?(s=(1<<e)-1,o=0):(s=s+n,o=o-or(2,t))):(s=0,o=g(r/or(2,1-n-t)))),c=[],a=t;a;a-=1)c.push(o%2?1:0),o=Qs(o/2);for(a=e;a;a-=1)c.push(s%2?1:0),s=Qs(s/2);for(c.push(i?1:0),c.reverse(),h=c.join(""),l=[];h.length;)l.push(parseInt(h.substring(0,8),2)),h=h.substring(8);return l}function yl(r,e,t){var n=[],i,s,o,f,a,c,h,l;for(i=r.length;i;i-=1)for(o=r[i-1],s=8;s;s-=1)n.push(o%2?1:0),o=o>>1;return n.reverse(),f=n.join(""),a=(1<<e-1)-1,c=parseInt(f.substring(0,1),2)?-1:1,h=parseInt(f.substring(1,1+e),2),l=parseInt(f.substring(1+e),2),h===(1<<e)-1?l!==0?NaN:c*(1/0):h>0?c*or(2,h-a)*(1+l/or(2,t)):l!==0?c*or(2,-(a-1))*(l/or(2,t)):c<0?-0:0}function BE(r){return yl(r,11,52)}function CE(r){return bl(r,11,52)}function RE(r){return yl(r,8,23)}function kE(r){return bl(r,8,23)}(function(){var r=function(p){if(p=ht.ToInt32(p),p<0)throw new RangeError("ArrayBuffer size is not a small enough positive integer");this.byteLength=p,this._bytes=[],this._bytes.length=p;var y;for(y=0;y<this.byteLength;y+=1)this._bytes[y]=0;_a(this)};ke.ArrayBuffer=ke.ArrayBuffer||r;var e=function(){};function t(g,p,y){var b;return b=function(x,m,L){var W,N,K,q;if(!arguments.length||typeof arguments[0]=="number"){if(this.length=ht.ToInt32(arguments[0]),L<0)throw new RangeError("ArrayBufferView size is not a small enough positive integer");this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new r(this.byteLength),this.byteOffset=0}else if(typeof arguments[0]=="object"&&arguments[0].constructor===b)for(W=arguments[0],this.length=W.length,this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new r(this.byteLength),this.byteOffset=0,K=0;K<this.length;K+=1)this._setter(K,W._getter(K));else if(typeof arguments[0]=="object"&&!(arguments[0]instanceof r||ht.Class(arguments[0])==="ArrayBuffer"))for(N=arguments[0],this.length=ht.ToUint32(N.length),this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new r(this.byteLength),this.byteOffset=0,K=0;K<this.length;K+=1)q=N[K],this._setter(K,Number(q));else if(typeof arguments[0]=="object"&&(arguments[0]instanceof r||ht.Class(arguments[0])==="ArrayBuffer")){if(this.buffer=x,this.byteOffset=ht.ToUint32(m),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(this.byteOffset%this.BYTES_PER_ELEMENT)throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.");if(arguments.length<3){if(this.byteLength=this.buffer.byteLength-this.byteOffset,this.byteLength%this.BYTES_PER_ELEMENT)throw new RangeError("length of buffer minus byteOffset not a multiple of the element size");this.length=this.byteLength/this.BYTES_PER_ELEMENT}else this.length=ht.ToUint32(L),this.byteLength=this.length*this.BYTES_PER_ELEMENT;if(this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer")}else throw new TypeError("Unexpected argument type(s)");this.constructor=b,_a(this),dE(this)},b.prototype=new e,b.prototype.BYTES_PER_ELEMENT=g,b.prototype._pack=p,b.prototype._unpack=y,b.BYTES_PER_ELEMENT=g,b.prototype._getter=function(x){if(arguments.length<1)throw new SyntaxError("Not enough arguments");if(x=ht.ToUint32(x),x>=this.length)return _l;var m=[],L,W;for(L=0,W=this.byteOffset+x*this.BYTES_PER_ELEMENT;L<this.BYTES_PER_ELEMENT;L+=1,W+=1)m.push(this.buffer._bytes[W]);return this._unpack(m)},b.prototype.get=b.prototype._getter,b.prototype._setter=function(x,m){if(arguments.length<2)throw new SyntaxError("Not enough arguments");if(x=ht.ToUint32(x),x>=this.length)return _l;var L=this._pack(m),W,N;for(W=0,N=this.byteOffset+x*this.BYTES_PER_ELEMENT;W<this.BYTES_PER_ELEMENT;W+=1,N+=1)this.buffer._bytes[N]=L[W]},b.prototype.set=function(x,m){if(arguments.length<1)throw new SyntaxError("Not enough arguments");var L,W,N,K,q,X,S,I,O,F;if(typeof arguments[0]=="object"&&arguments[0].constructor===this.constructor){if(L=arguments[0],N=ht.ToUint32(arguments[1]),N+L.length>this.length)throw new RangeError("Offset plus length of array is out of range");if(I=this.byteOffset+N*this.BYTES_PER_ELEMENT,O=L.length*this.BYTES_PER_ELEMENT,L.buffer===this.buffer){for(F=[],q=0,X=L.byteOffset;q<O;q+=1,X+=1)F[q]=L.buffer._bytes[X];for(q=0,S=I;q<O;q+=1,S+=1)this.buffer._bytes[S]=F[q]}else for(q=0,X=L.byteOffset,S=I;q<O;q+=1,X+=1,S+=1)this.buffer._bytes[S]=L.buffer._bytes[X]}else if(typeof arguments[0]=="object"&&typeof arguments[0].length<"u"){if(W=arguments[0],K=ht.ToUint32(W.length),N=ht.ToUint32(arguments[1]),N+K>this.length)throw new RangeError("Offset plus length of array is out of range");for(q=0;q<K;q+=1)X=W[q],this._setter(N+q,Number(X))}else throw new TypeError("Unexpected argument type(s)")},b.prototype.subarray=function(x,m){function L(N,K,q){return N<K?K:N>q?q:N}x=ht.ToInt32(x),m=ht.ToInt32(m),arguments.length<1&&(x=0),arguments.length<2&&(m=this.length),x<0&&(x=this.length+x),m<0&&(m=this.length+m),x=L(x,0,this.length),m=L(m,0,this.length);var W=m-x;return W<0&&(W=0),new this.constructor(this.buffer,this.byteOffset+x*this.BYTES_PER_ELEMENT,W)},b}var n=t(1,gE,AE),i=t(1,_E,El),s=t(1,pE,El),o=t(2,EE,bE),f=t(2,yE,wE),a=t(4,xE,SE),c=t(4,IE,mE),h=t(4,kE,RE),l=t(8,CE,BE);ke.Int8Array=ke.Int8Array||n,ke.Uint8Array=ke.Uint8Array||i,ke.Uint8ClampedArray=ke.Uint8ClampedArray||s,ke.Int16Array=ke.Int16Array||o,ke.Uint16Array=ke.Uint16Array||f,ke.Int32Array=ke.Int32Array||a,ke.Uint32Array=ke.Uint32Array||c,ke.Float32Array=ke.Float32Array||h,ke.Float64Array=ke.Float64Array||l})();(function(){function r(s,o){return ht.IsCallable(s.get)?s.get(o):s[o]}var e=function(){var s=new ke.Uint16Array([4660]),o=new ke.Uint8Array(s.buffer);return r(o,0)===18}(),t=function(o,f,a){if(arguments.length===0)o=new ke.ArrayBuffer(0);else if(!(o instanceof ke.ArrayBuffer||ht.Class(o)==="ArrayBuffer"))throw new TypeError("TypeError");if(this.buffer=o||new ke.ArrayBuffer(0),this.byteOffset=ht.ToUint32(f),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(arguments.length<3?this.byteLength=this.buffer.byteLength-this.byteOffset:this.byteLength=ht.ToUint32(a),this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer");_a(this)};function n(s){return function(o,f){if(o=ht.ToUint32(o),o+s.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");o+=this.byteOffset;var a=new ke.Uint8Array(this.buffer,o,s.BYTES_PER_ELEMENT),c=[],h;for(h=0;h<s.BYTES_PER_ELEMENT;h+=1)c.push(r(a,h));return!!f==!!e&&c.reverse(),r(new s(new ke.Uint8Array(c).buffer),0)}}t.prototype.getUint8=n(ke.Uint8Array),t.prototype.getInt8=n(ke.Int8Array),t.prototype.getUint16=n(ke.Uint16Array),t.prototype.getInt16=n(ke.Int16Array),t.prototype.getUint32=n(ke.Uint32Array),t.prototype.getInt32=n(ke.Int32Array),t.prototype.getFloat32=n(ke.Float32Array),t.prototype.getFloat64=n(ke.Float64Array);function i(s){return function(o,f,a){if(o=ht.ToUint32(o),o+s.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");var c=new s([f]),h=new ke.Uint8Array(c.buffer),l=[],g,p;for(g=0;g<s.BYTES_PER_ELEMENT;g+=1)l.push(r(h,g));!!a==!!e&&l.reverse(),p=new ke.Uint8Array(this.buffer,o,s.BYTES_PER_ELEMENT),p.set(l)}}t.prototype.setUint8=i(ke.Uint8Array),t.prototype.setInt8=i(ke.Int8Array),t.prototype.setUint16=i(ke.Uint16Array),t.prototype.setInt16=i(ke.Int16Array),t.prototype.setUint32=i(ke.Uint32Array),t.prototype.setInt32=i(ke.Int32Array),t.prototype.setFloat32=i(ke.Float32Array),t.prototype.setFloat64=i(ke.Float64Array),ke.DataView=ke.DataView||t})()});var ml=_e((fy,Il)=>{var xl=dl().Writable,vE=jr(),mi=Al();typeof Uint8Array>"u"?Ms=wl().Uint8Array:Ms=Uint8Array;var Ms;function en(r,e){if(!(this instanceof en))return new en(r,e);typeof r=="function"&&(e=r,r={}),r||(r={});var t=r.encoding,n=!1;t?(t=String(t).toLowerCase(),(t==="u8"||t==="uint8")&&(t="uint8array")):n=!0,xl.call(this,{objectMode:!0}),this.encoding=t,this.shouldInferEncoding=n,e&&this.on("finish",function(){e(this.getBody())}),this.body=[]}Il.exports=en;vE(en,xl);en.prototype._write=function(r,e,t){this.body.push(r),t()};en.prototype.inferEncoding=function(r){var e=r===void 0?this.body[0]:r;return Buffer.isBuffer(e)?"buffer":typeof Uint8Array<"u"&&e instanceof Uint8Array?"uint8array":Array.isArray(e)?"array":typeof e=="string"?"string":Object.prototype.toString.call(e)==="[object Object]"?"object":"buffer"};en.prototype.getBody=function(){return!this.encoding&&this.body.length===0?[]:(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),this.encoding==="array"?OE(this.body):this.encoding==="string"?TE(this.body):this.encoding==="buffer"?LE(this.body):this.encoding==="uint8array"?UE(this.body):this.body)};var oy=Array.isArray||function(r){return Object.prototype.toString.call(r)=="[object Array]"};function NE(r){return/Array\]$/.test(Object.prototype.toString.call(r))}function Sl(r){return typeof r=="string"||NE(r)||r&&typeof r.subarray=="function"}function TE(r){for(var e=[],t=!1,n=0;n<r.length;n++){var i=r[n];typeof i=="string"||Buffer.isBuffer(i)?e.push(i):Sl(i)?e.push(mi(i)):e.push(mi(String(i)))}return Buffer.isBuffer(r[0])?(e=Buffer.concat(e),e=e.toString("utf8")):e=e.join(""),e}function LE(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];Buffer.isBuffer(n)?e.push(n):Sl(n)?e.push(mi(n)):e.push(mi(String(n)))}return Buffer.concat(e)}function OE(r){for(var e=[],t=0;t<r.length;t++)e.push.apply(e,r[t]);return e}function UE(r){for(var e=0,t=0;t<r.length;t++)typeof r[t]=="string"&&(r[t]=mi(r[t])),e+=r[t].length;for(var n=new Ms(e),t=0,i=0;t<r.length;t++)for(var s=r[t],o=0;o<s.length;o++)n[i++]=s[o];return n}});var Rl=_e((ay,Cl)=>{"use strict";function Bl(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function PE(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return Bl(r,t)}catch{t.message=r.message,t.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),Bl(new i,t)}}Cl.exports=PE});var vl=_e((cy,kl)=>{function tr(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}kl.exports=tr;tr.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts};tr.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null};tr.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),t=this._timeouts.shift();else return!1;var n=this,i=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},t);return this._options.unref&&i.unref(),!0};tr.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};tr.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};tr.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};tr.prototype.start=tr.prototype.try;tr.prototype.errors=function(){return this._errors};tr.prototype.attempts=function(){return this._attempts};tr.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,n=0;n<this._errors.length;n++){var i=this._errors[n],s=i.message,o=(r[s]||0)+1;r[s]=o,o>=t&&(e=i,t=o)}return e}});var Nl=_e(tn=>{var DE=vl();tn.operation=function(r){var e=tn.timeouts(r);return new DE(e,{forever:r&&r.forever,unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};tn.timeouts=function(r){if(r instanceof Array)return[].concat(r);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in r)e[t]=r[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<e.retries;i++)n.push(this.createTimeout(i,e));return r&&r.forever&&!n.length&&n.push(this.createTimeout(i,e)),n.sort(function(s,o){return s-o}),n};tn.createTimeout=function(r,e){var t=e.randomize?Math.random()+1:1,n=Math.round(t*e.minTimeout*Math.pow(e.factor,r));return n=Math.min(n,e.maxTimeout),n};tn.wrap=function(r,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var n in r)typeof r[n]=="function"&&t.push(n)}for(var i=0;i<t.length;i++){var s=t[i],o=r[s];r[s]=function(a){var c=tn.operation(e),h=Array.prototype.slice.call(arguments,1),l=h.pop();h.push(function(g){c.retry(g)||(g&&(arguments[0]=c.mainError()),l.apply(this,arguments))}),c.attempt(function(){a.apply(r,h)})}.bind(r,o),r[s].options=e}}});var Ll=_e((hy,Tl)=>{Tl.exports=Nl()});var Pl=_e((ly,Ul)=>{"use strict";var HE=Rl(),QE=Ll(),ME=Object.prototype.hasOwnProperty;function Ol(r){return r&&r.code==="EPROMISERETRY"&&ME.call(r,"retried")}function FE(r,e){var t,n;return typeof r=="object"&&typeof e=="function"&&(t=e,e=r,r=t),n=QE.operation(e),new Promise(function(i,s){n.attempt(function(o){Promise.resolve().then(function(){return r(function(f){throw Ol(f)&&(f=f.retried),HE(new Error("Retrying"),"EPROMISERETRY",{retried:f})},o)}).then(i,function(f){Ol(f)&&(f=f.retried,n.retry(f||new Error))||s(f)})})})}Ul.exports=FE});var ba=_e((dy,Dl)=>{var qE={generic:"ERR_GENERIC_CLIENT",connect:"ERR_NOT_CONNECTED",badPath:"ERR_BAD_PATH",permission:"EACCES",notexist:"ENOENT",notdir:"ENOTDIR",badAuth:"ERR_BAD_AUTH"},WE={writeFile:1,readFile:2,writeDir:3,readDir:4,readObj:5,writeObj:6};Dl.exports={errorCode:qE,targetType:WE}});var Wl=_e((gy,ql)=>{var Bi=require("fs"),KE=require("path"),{errorCode:Hl}=ba();function Ql(r,e,t){return i=>{if(r.endCalled||r.errorHandled){r.debugMsg(`${e} errorListener - ignoring handled error`);return}r.errorHandled=!0;let s=new Error(`${e}: ${i.message}`);if(s.code=i.code,t)t(s);else throw s}}function $E(r,e){return()=>{r.endCalled||r.errorHandled||r.closeHandled?r.debugMsg(`Global ${e} event: Ignoring expected and handled event`):(r.debugMsg(`Global ${e} event: Handling unexpected event`),r.sftp=void 0)}}function Ml(r,e,t){return function(){if(r.sftp=void 0,r.endCalled||r.endHandled||r.errorHandled){r.debugMsg(`${e} endListener - ignoring handled error`);return}r.endHandled=!0,r.debugMsg(`${e} Unexpected end event - ignoring`)}}function Fl(r,e,t){return function(){if(r.sftp=void 0,r.endCalled||r.closeHandled||r.errorHandled||r.endHandled){r.debugMsg(`${e} closeListener - ignoring handled error`);return}r.closeHandled=!0,r.debugMsg(`${e} Unexpected close event raised - ignoring`)}}function GE(r,e,t){let n={end:Ml(r,e,t),close:Fl(r,e,t),error:Ql(r,e,t)};return r.on("end",n.end),r.on("close",n.close),r.on("error",n.error),r._resetEventFlags(),n}function YE(r,e,t){try{r.removeListener("end",e.end),r.removeListener("close",e.close),r.removeListener("error",e.error)}catch(n){throw new Error(`${t}: Error removing temp listeners: ${n.message}`)}}function ya(r){let e=Bi.statSync(r,{throwIfNoEntry:!1});if(e){if(e.isDirectory())return"d";if(e.isFile())return"-";{let t=new Error(`Bad path: ${r}: target must be a file or directory`);throw t.code=Hl.badPath,t}}else return!1}function wa(r,e="r"){let t=Bi.constants.F_OK|e==="w"?Bi.constants.W_OK:Bi.constants.R_OK;try{return Bi.accessSync(r,t),{status:!0,type:ya(r),details:"access OK",code:0}}catch(n){switch(n.errno){case-2:return{status:!1,type:null,details:"not exist",code:-2};case-13:return{status:!1,type:ya(r),details:"permission denied",code:-13};case-20:return{status:!1,type:null,details:"parent not a directory"};default:return{status:!1,type:null,details:n.message}}}}function jE(r){let{status:e,details:t,type:n}=wa(r,"w");if(!e&&t==="permission denied")return{status:e,details:t,type:n};if(!e){let i=KE.dirname(r),s=wa(i,"w");return s.status&&s.type!=="d"?{status:!1,details:`${i}: not a directory`,type:null}:s.status?{status:!0,details:"access OK",type:null,code:0}:{status:s.status,details:`${i}: ${s.details}`,type:null}}return{status:e,details:t,type:n}}async function XE(r,e){try{return e.startsWith("..")?`${await r.realPath("..")}/${e.slice(3)}`:e.startsWith(".")?`${await r.realPath(".")}/${e.slice(2)}`:e}catch(t){throw new Error(`normalizeRemotePath: ${t.message}`)}}function VE(r,e,t){if(!r.sftp){let n=new Error(`${e}: No SFTP connection available`);if(n.code=Hl.connect,t)return t(n),!1;throw n}return!0}function zE(r){return new Promise((e,t)=>{try{isNaN(r)||r<0?t("Argument must be  anumber >= 0"):setTimeout(()=>{e(!0)},r)}catch(n){t(n)}})}ql.exports={globalListener:$E,errorListener:Ql,endListener:Ml,closeListener:Fl,addTempListeners:GE,removeTempListeners:YE,haveLocalAccess:wa,haveLocalCreate:jE,normalizeRemotePath:XE,localExists:ya,haveConnection:VE,sleep:zE}});var Yl=_e((Ay,Gl)=>{"use strict";var{Client:JE}=ah(),Fs=require("fs"),ZE=ml(),eb=Pl(),{join:Ci,parse:tb}=require("path"),{globalListener:xa,addTempListeners:gt,removeTempListeners:At,haveConnection:Nt,normalizeRemotePath:Ri,localExists:Kl,haveLocalAccess:$l,haveLocalCreate:Sa}=Wl(),{errorCode:lt}=ba(),Ia=class{constructor(e){this.version="9.0.4",this.client=new JE,this.sftp=void 0,this.clientName=e||"sftp",this.endCalled=!1,this.errorHandled=!1,this.closeHandled=!1,this.endHandled=!1,this.remotePlatform="unix",this.debug=void 0,this.client.on("close",xa(this,"close")),this.client.on("end",xa(this,"end")),this.client.on("error",xa(this,"error"))}debugMsg(e,t){this.debug&&(t?this.debug(`CLIENT[${this.clientName}]: ${e} ${JSON.stringify(t,null," ")}`):this.debug(`CLIENT[${this.clientName}]: ${e}`))}fmtError(e,t="sftp",n,i){let s="",o="",f=i?` after ${i} ${i>1?"attempts":"attempt"}`:"";if(e===void 0)s=`${t}: Undefined error - probably a bug!`,o=lt.generic;else if(typeof e=="string")s=`${t}: ${e}${f}`,o=n||lt.generic;else if(e.custom)s=`${t}->${e.message}${f}`,o=e.code;else{switch(e.code){case"ENOTFOUND":s=`${t}: Address lookup failed for host${f}`;break;case"ECONNREFUSED":s=`${t}: Remote host refused connection${f}`;break;case"ECONNRESET":s=`${t}: Remote host has reset the connection: ${e.message}${f}`;break;default:s=`${t}: ${e.message}${f}`}o=e.code?e.code:lt.generic}let a=new Error(s);return a.code=o,a.custom=!0,this.debugMsg(`${a.message} (${a.code})`),a}on(e,t){this.client.prependListener(e,t)}removeListener(e,t){this.client.removeListener(e,t)}_resetEventFlags(){this.closeHandled=!1,this.endHandled=!1,this.errorHandled=!1}getConnection(e){let t,n;return new Promise((i,s)=>{n=gt(this,"getConnection",s),t=()=>{this.debugMsg("getConnection ready listener: got connection - promise resolved"),i(!0)},this.on("ready",t);try{this.client.connect(e)}catch(o){this.debugMsg(`getConnection: ${o.message}`),s(o)}}).finally(()=>{this.removeListener("ready",t),At(this,n,"getConnection")})}getSftpChannel(){return new Promise((e,t)=>{this.client.sftp((n,i)=>{n?t(this.fmtError(n,"getSftpChannel",n.code)):(this.sftp=i,e(i))})})}async connect(e){let t;try{if(t=gt(this,"connect"),e.debug&&(this.debug=e.debug,this.debugMsg("connect: Debugging turned on"),this.debugMsg(`ssh2-sftp-client Version: ${this.version} `,process.versions)),this.sftp)throw this.fmtError("An existing SFTP connection is already defined","connect",lt.connect);let n={retries:e.retries??1,factor:e.factor??2,minTimeout:e.retry_minTimeout??25e3};return await eb(n,async(s,o)=>{try{this.debugMsg(`connect: Connect attempt ${o}`),await this.getConnection(e)}catch(f){switch(f.code){case"ENOTFOUND":case"ECONNREFUSED":case"ERR_SOCKET_BAD_PORT":throw f;case void 0:{if(f.message.endsWith("All configured authentication methods failed")||f.message.startsWith("Cannot parse privateKey"))throw f;s(f);break}default:s(f)}}}),await this.getSftpChannel()}catch(n){throw this.end(),n.custom?n:this.fmtError(n,"connect")}finally{At(this,t,"connect")}}realPath(e,t=!0){let n;return new Promise((i,s)=>{t&&(n=gt(this,"realPath",s)),this.debugMsg(`realPath -> ${e}`),this.sftp.realpath(e,(o,f)=>{o&&(o.code===2?(this.debugMsg('realPath <- ""'),i("")):(this.debugMsg(`${o.message} ${e}`,"realPath"),s(this.fmtError(`${o.message} ${e}`,"realPath",o.code)))),this.debugMsg(`realPath <- ${f}`),i(f)})}).finally(()=>{t&&At(this,n,"realPath")})}cwd(){return this.realPath(".")}_xstat(e,t,n=!0){let i;return new Promise((s,o)=>{let f=(a,c)=>{if(a)a.code===2||a.code===4?o(this.fmtError(`No such file: ${t}`,"_xstat",lt.notexist)):o(this.fmtError(`${a.message} ${t}`,"_xstat",a.code));else{let h={mode:c.mode,uid:c.uid,gid:c.gid,size:c.size,accessTime:c.atime*1e3,modifyTime:c.mtime*1e3,isDirectory:c.isDirectory(),isFile:c.isFile(),isBlockDevice:c.isBlockDevice(),isCharacterDevice:c.isCharacterDevice(),isSymbolicLink:c.isSymbolicLink(),isFIFO:c.isFIFO(),isSocket:c.isSocket()};this.debugMsg("_xstat: result = ",h),s(h)}};n&&(i=gt(this,"_xstat",o)),e==="stat"?this.sftp.stat(t,f):this.sftp.lstat(t,f)}).finally(()=>{n&&At(this,i,"_xstat")})}async stat(e){try{return Nt(this,"stat"),await this._xstat("stat",e)}catch(t){throw t.custom?t:this.fmtError(t,"stat",t.code)}}async lstat(e){try{return Nt(this,"lstat"),await this._xstat("lstat",e)}catch(t){throw t.custom?t:this.fmtError(t,"lstat",t.code)}}async exists(e){this.debugMsg(`exists: remotePath = ${e}`);try{if(e===".")return"d";let t=await this.lstat(e);return this.debugMsg("exists: <- ",t),t.isDirectory?"d":t.isSymbolicLink?"l":t.isFile?"-":!1}catch(t){if(t.code===lt.notexist)return!1;throw t.custom?t:this.fmtError(t.message,"exists",t.code)}}list(e,t,n=!0){let i;return new Promise((s,o)=>{n&&(i=gt(this,"list",o)),Nt(this,"list",o)&&this.sftp.readdir(e,(f,a)=>{if(f)o(this.fmtError(`${f.message} ${e}`,"list",f.code));else{let c=/-/gi,h=a.map(l=>({type:l.longname.slice(0,1),name:l.filename,size:l.attrs.size,modifyTime:l.attrs.mtime*1e3,accessTime:l.attrs.atime*1e3,rights:{user:l.longname.slice(1,4).replace(c,""),group:l.longname.slice(4,7).replace(c,""),other:l.longname.slice(7,10).replace(c,"")},owner:l.attrs.uid,group:l.attrs.gid,longname:l.longname}));s(t?h.filter(l=>t(l)):h)}})}).finally(()=>{n&&At(this,i,"list")})}get(e,t,n,i=!0){let s,o,f;return new Promise((a,c)=>{if(i&&(s=gt(this,"get",c)),Nt(this,"get",c)){if(n={readStreamOptions:{...n?.readStreamOptions,autoClose:!0},writeStreamOptions:{...n?.writeStreamOptions,autoClose:!0},pipeOptions:{...n?.pipeOptions,end:!0}},o=this.sftp.createReadStream(e,n.readStreamOptions),o.once("error",h=>{t&&typeof t!="string"&&!t.destroyed&&t.destroy(),c(this.fmtError(`${h.message} ${e}`,"get",h.code))}),t===void 0)this.debugMsg("get resolving buffer of data"),f=ZE(h=>{a(h)});else if(typeof t=="string"){this.debugMsg("get returning local file");let h=Sa(t);if(h.status)f=Fs.createWriteStream(t,n.writeStreamOptions);else{c(this.fmtError(`Bad path: ${t}: ${h.details}`,"get",h.code));return}}else this.debugMsg("get: returning data into supplied stream"),f=t;f.once("error",h=>{c(this.fmtError(`${h.message} ${typeof t=="string"?t:"<stream>"}`,"get",h.code))}),o.once("end",()=>{typeof t=="string"?(this.debugMsg("get: resolving with dst filename"),a(t)):t!==void 0&&(this.debugMsg("get: resolving with writer stream object"),a(f))}),o.pipe(f,n.pipeOptions)}}).finally(()=>{i&&At(this,s,"get")})}_fastGet(e,t,n,i=!0){let s;return new Promise((o,f)=>{i&&(s=gt(this,"_fastGet",f)),Nt(this,"_fastGet",f)&&this.sftp.fastGet(e,t,n,a=>{a&&f(this.fmtError(`${a.message} Remote: ${e} Local: ${t}`)),o(`${e} was successfully download to ${t}!`)})}).finally(()=>{i&&At(this,s,"_fastGet")})}async fastGet(e,t,n){try{let i=await this.exists(e);if(i!=="-"){let o=`${i?"Not a regular file":"No such file "} ${e}`;throw this.fmtError(o,"fastGet",lt.badPath)}let s=Sa(t);if(!s.status)throw this.fmtError(`Bad path: ${t}: ${s.details}`,"fastGet",lt.badPath);return await this._fastGet(e,t,n)}catch(i){throw this.fmtError(i,"fastGet")}}_fastPut(e,t,n,i=!0){let s;return new Promise((o,f)=>{i&&(s=gt(this,"_fastPut",f)),Nt(this,"_fastPut",f)&&this.sftp.fastPut(e,t,n,a=>{a&&f(this.fmtError(`${a.message} Local: ${e} Remote: ${t}`,"fastPut",a.code)),o(`${e} was successfully uploaded to ${t}!`)})}).finally(()=>{i&&At(this,s,"_fastPut")})}async fastPut(e,t,n){try{this.debugMsg(`fastPut -> local ${e} remote ${t}`);let i=$l(e);if(i.status){if(i.status&&Kl(e)==="d")throw this.fmtError(`Bad path: ${e} not a regular file`,"fastgPut",lt.badPath)}else throw this.fmtError(`Bad path: ${e}: ${i.details}`,"fastPut",i.code);return await this._fastPut(e,t,n)}catch(i){throw i.custom?i:this.fmtError(i.message,"fastPut",i.code)}}_put(e,t,n,i=!0){let s,o,f;return new Promise((a,c)=>{i&&(s=gt(this,"_put",c)),n={readStreamOptions:{...n?.readStreamOptions,autoClose:!0},writeStreamOptions:{...n?.writeStreamOptions,autoClose:!0},pipeOptions:{...n?.pipeOptions,end:!0}},Nt(this,"_put",c)&&(o=this.sftp.createWriteStream(t,n.writeStreamOptions),o.once("error",h=>{c(this.fmtError(`Write stream error: ${h.message} ${t}`,"_put",h.code))}),o.once("close",()=>{a(`Uploaded data stream to ${t}`)}),e instanceof Buffer?(this.debugMsg("put source is a buffer"),o.end(e)):(f=typeof e=="string"?Fs.createReadStream(e,n.readStreamOptions):e,f.once("error",h=>{c(this.fmtError(`Read stream error: ${h.message} ${typeof e=="string"?e:"<stream>"}`,"_put",h.code))}),f.pipe(o,n.pipeOptions)))}).finally(()=>{i&&At(this,s,"_put")})}async put(e,t,n){try{if(typeof e=="string"){let i=$l(e);if(!i.status)throw this.fmtError(`Bad path: ${e} ${i.details}`,"put",i.code)}return await this._put(e,t,n)}catch(i){throw i.custom?i:this.fmtError(`Re-thrown: ${i.message}`,"put",i.code)}}_append(e,t,n,i=!0){let s;return new Promise((o,f)=>{if(i&&(s=gt(this,"_append",f)),Nt(this,"_append",f)){this.debugMsg(`append -> remote: ${t} `,n),n.flags="a";let a=this.sftp.createWriteStream(t,n);a.on("error",c=>{f(this.fmtError(`${c.message} ${t}`,"append",c.code))}),a.on("close",()=>{o(`Appended data to ${t}`)}),e instanceof Buffer?(a.write(e),a.end()):e.pipe(a)}}).finally(()=>{i&&At(this,s,"_append")})}async append(e,t,n={}){try{if(typeof e=="string")throw this.fmtError("Cannot append one file to another","append",lt.badPath);let i=await this.exists(t);if(i&&i==="d")throw this.fmtError(`Bad path: ${t}: cannot append to a directory`,"append",lt.badPath);await this._append(e,t,n)}catch(i){throw i.custom?i:this.fmtError(i.message,"append",i.code)}}_doMkdir(e,t=!0){let n;return new Promise((i,s)=>{t&&(n=gt(this,"_doMkdir",s)),this.sftp.mkdir(e,o=>{o?o.code===4?s(this.fmtError(`Bad path: ${e} permission denied`,"_doMkdir",lt.badPath)):o.code===2?s(this.fmtError(`Bad path: ${e} parent not a directory or not exist`,"_doMkdir",lt.badPath)):s(this.fmtError(`${o.message} ${e}`,"_doMkdir",o.code)):i(`${e} directory created`)})}).finally(()=>{t&&At(this,n,"_doMkdir")})}async _mkdir(e,t){try{let n=await Ri(this,e),i=await this.exists(n);if(i&&i!=="d")throw this.fmtError(`Bad path: ${n} already exists as a file`,"_mkdir",lt.badPath);if(i)return`${n} already exists`;if(!t)return await this._doMkdir(n);let s=tb(n).dir;if(s){let o=await this.exists(s);if(!o)await this._mkdir(s,!0);else if(o!=="d")throw this.fmtError(`Bad path: ${s} not a directory`,"_mkdir",lt.badPath)}return await this._doMkdir(n)}catch(n){throw n.custom?n:this.fmtError(`${n.message} ${e}`,"_mkdir",n.code)}}async mkdir(e,t=!1){try{return Nt(this,"mkdir"),await this._mkdir(e,t)}catch(n){throw this.fmtError(`${n.message}`,"mkdir",n.code)}}async rmdir(e,t=!1){let n=s=>{let o;return new Promise((f,a)=>{o=gt(this,"_rmdir",a),this.debugMsg(`_rmdir: dir = ${s}`),this.sftp.rmdir(s,c=>{c&&a(this.fmtError(`${c.message} ${s}`,"rmdir",c.code)),f("Successfully removed directory")})}).finally(()=>{At(this,o,"_rmdir")})},i=(s,o)=>{let f;return new Promise((a,c)=>{f=gt(this,"_delFiles",c),this.debugMsg(`_delFiles: path = ${s} fileList = ${o}`);let h=[];for(let l of o)h.push(this.delete(`${s}/${l.name}`,!0,!1));a(h)}).then(a=>Promise.all(a)).finally(()=>{At(this,f,"_delFiles")})};try{this.debugMsg(`rmdir: dir = ${e} recursive = ${t}`);let s=await Ri(this,e),o=await this.exists(s);if(this.debugMsg(`rmdir: ${s} existStatus = ${o}`),!o)throw this.fmtError(`Bad Path: ${e}: No such directory`,"rmdir",lt.badPath);if(o!=="d")throw this.fmtError(`Bad Path: ${e}: Not a directory`,"rmdir",lt.badPath);if(!t)return this.debugMsg("rmdir: non-recursive - just try to remove it"),await n(s);let f=await this.list(s);if(this.debugMsg(`rmdir: listing count = ${f.length}`),!f.length)return this.debugMsg("rmdir: No sub dir or files, just rmdir"),await n(s);let a=f.filter(h=>h.type!=="d");this.debugMsg(`rmdir: dir content files to remove = ${a.length}`);let c=f.filter(h=>h.type==="d");this.debugMsg(`rmdir: sub-directories to remove = ${c.length}`),await i(s,a);for(let h of c)await this.rmdir(`${s}/${h.name}`,!0);return await n(s),"Successfully removed directory"}catch(s){throw s.custom?s:this.fmtError(`${s.message} ${e}`,"rmdir",s.code)}}delete(e,t=!1,n=!0){let i;return new Promise((s,o)=>{n&&(i=gt(this,"delete",o)),this.sftp.unlink(e,f=>{f&&(t&&f.code===2?s(`Successfully deleted ${e}`):o(this.fmtError(`${f.message} ${e}`,"delete",f.code))),s(`Successfully deleted ${e}`)})}).finally(()=>{n&&At(this,i,"delete")})}rename(e,t,n=!0){let i;return new Promise((s,o)=>{n&&(i=gt(this,"rename",o)),Nt(this,"rename",o)&&this.sftp.rename(e,t,f=>{f&&o(this.fmtError(`${f.message} From: ${e} To: ${t}`,"_rename",f.code)),s(`Successfully renamed ${e} to ${t}`)})}).finally(()=>{n&&At(this,i,"rename")})}posixRename(e,t,n=!0){let i;return new Promise((s,o)=>{n&&(i=gt(this,"posixRename",o)),Nt(this,"posixRename",o)&&this.sftp.ext_openssh_rename(e,t,f=>{f&&o(this.fmtError(`${f.message} From: ${e} To: ${t}`,"_posixRename",f.code)),s(`Successful POSIX rename ${e} to ${t}`)})}).finally(()=>{At(this,i,"posixRename")})}chmod(e,t,n=!0){let i;return new Promise((s,o)=>{n&&(i=gt(this,"chmod",o)),Nt(this,"chmod",o)&&this.sftp.chmod(e,t,f=>{f&&o(this.fmtError(`${f.message} ${e}`,"_chmod",f.code)),s("Successfully change file mode")})}).finally(()=>{n&&At(this,i,"chmod")})}async uploadDir(e,t,n){let i=async f=>{let a=await Ri(this,f),c=await this.exists(a);if(c&&c!=="d")throw this.fmtError(`Bad path ${a} Not a directory`,"getRemoteStatus",lt.badPath);return{remoteDir:a,remoteStatus:c}},s=f=>{let a=Kl(f);if(!a)throw this.fmtError(`Bad path: ${f} not exist`,"getLocalStatus",lt.badPath);if(a!=="d")throw this.fmtError(`Bad path: ${f}: not a directory`,"getLocalStatus",lt.badPath);return a},o=(f,a,c,h)=>{let l;return new Promise((g,p)=>{l=gt(this,"uploadFiles",p);let y=[];for(let b of c){let x=Ci(f,b.name),m=`${a}/${b.name}`;b.isFile()?(h?y.push(this._fastPut(x,m,null,!1)):y.push(this._put(x,m,null,!1)),this.client.emit("upload",{source:x,destination:m})):this.debugMsg(`uploadFiles: File ignored: ${b.name} not a regular file`)}g(Promise.all(y))}).then(g=>Promise.all(g)).finally(()=>{At(this,l,o)})};try{Nt(this,"uploadDir"),this.debugMsg(`uploadDir: srcDir = ${e} dstDir = ${t} options = ${n}`);let{remoteDir:f,remoteStatus:a}=await i(t);this.debugMsg(`uploadDir: remoteDir = ${f} remoteStatus = ${a}`),s(e),a||await this._mkdir(f,!0);let c=Fs.readdirSync(e,{encoding:"utf8",withFileTypes:!0});this.debugMsg(`uploadDir: dirEntries = ${c}`),n?.filter&&(c=c.filter(g=>n.filter(Ci(e,g.name),g.isDirectory())));let h=c.filter(g=>g.isDirectory()),l=c.filter(g=>!g.isDirectory());this.debugMsg(`uploadDir: dirUploads = ${h}`),this.debugMsg(`uploadDir: fileUploads = ${l}`),await o(e,f,l,n?.useFastput);for(let g of h){let p=Ci(e,g.name),y=`${f}/${g.name}`;await this.uploadDir(p,y,n)}return`${e} uploaded to ${t}`}catch(f){throw f.custom?f:this.fmtError(`${f.message} ${e}`,"uploadDir",f.code)}}async downloadDir(e,t,n={filter:null,useFastget:!1}){let i=async(f,a)=>{try{let c=await this.list(f);return a?c.filter(h=>a(`${f}/${h.name}`,h.type==="d")):c}catch(c){throw c.custom?c:this.fmtError(c.message,"_getDownloadList",c.code)}},s=f=>{try{let a=Sa(f);if(!a.status&&a.details==="permission denied")throw this.fmtError(`Bad path: ${f}: ${a.details}`,"prepareDestination",a.code);if(a.status&&!a.type)Fs.mkdirSync(f,{recursive:!0});else if(a.status&&a.type!=="d")throw this.fmtError(`Bad path: ${t}: not a directory`,"_prepareDestination",lt.badPath)}catch(a){throw a.custom?a:this.fmtError(a.message,"_prepareDestination",a.code)}},o=(f,a,c,h)=>{let l;return new Promise((g,p)=>{l=gt(this,"_downloadFIles",p);let y=[];for(let b of c){let x=`${f}/${b.name}`,m=Ci(a,b.name);h?y.push(this.fastGet(x,m,!1)):y.push(this.get(x,m,!1)),this.client.emit("download",{source:x,destination:m})}return g(Promise.all(y))}).finally(()=>{At(this,l,"_downloadFiles")})};try{Nt(this,"downloadDir");let f=await i(e,n.filter);s(t);let a=f.filter(h=>h.type!=="d");a.length&&await o(e,t,a,n.useFastget);let c=f.filter(h=>h.type==="d");for(let h of c){let l=`${e}/${h.name}`,g=Ci(t,h.name);await this.downloadDir(l,g)}return`${e} downloaded to ${t}`}catch(f){throw f.custom?f:this.fmtError(`${f.message}: ${e}`,"downloadDir",f.code)}}createReadStream(e,t){let n;try{return n=gt(this,"createReadStream"),Nt(this,"createReadStream"),this.sftp.createReadStream(e,t)}catch(i){throw i.custom?i:this.fmtError(i.message,"createReadStream",i.code)}finally{At(this,n,"createReadStreame")}}createWriteStream(e,t){let n;try{return n=gt(this,"createWriteStream"),Nt(this,"createWriteStream"),this.sftp.createWriteStream(e,t)}catch(i){throw i.custom?i:this.fmtError(i.message,"createWriteStream",i.code)}finally{At(this,n,"createWriteStream")}}_rcopy(e,t){return new Promise((n,i)=>{let s=this.sftp.createWriteStream(t),o=this.sftp.createReadStream(e);s.on("error",f=>{i(this.fmtError(`${f.message} ${t}`,"_rcopy"))}),o.on("error",f=>{i(this.fmtError(`${f.message} ${e}`,"_rcopy"))}),s.on("close",()=>{n(`${e} copied to ${t}`)}),o.pipe(s)})}async rcopy(e,t){let n;try{n=gt(this,"rcopy"),Nt(this,"rcopy");let i=await Ri(this,e),s=await this.exists(i);if(!s)throw this.fmtError(`Source does not exist ${i}`,"rcopy",lt.badPath);if(s!=="-")throw this.fmtError(`Source not a file ${i}`,"rcopy",lt.badPath);let o=await Ri(this,t);if(await this.exists(o))throw this.fmtError(`Destination already exists ${o}`,"rcopy",lt.badPath);return this._rcopy(i,o)}catch(i){throw i.custom?i:this.fmtError(i,"rcopy")}finally{At(this,n,"rcopy")}}end(){let e,t;return new Promise((n,i)=>{t=gt(this,"end",i),this.endCalled=!0,e=()=>{this.sftp=void 0,this.debugMsg("end: Connection closed"),n(!0)},this.on("close",e),this.sftp?this.client.end():(this.debugMsg("end: Called when no connection active"),n(!0))}).finally(()=>{At(this,t,"end"),this.removeListener("close",e),this.endCalled=!1})}};Gl.exports=Ia});var qs=ka(Yl(),1),Ws=class{constructor(e){this.config=e}uploadData(e,t){return new Promise((n,i)=>{let s=new qs.default;s.connect(this.config).then(()=>s.put(e,t)).then(()=>{s.end(),console.log(`upload ${t} success`),n()}).catch(o=>{s.end(),console.log(`upload ${t} fail`),i(o)})})}uploadFile(e,t){return new Promise((n,i)=>{let s=new qs.default;s.connect(this.config).then(()=>s.fastPut(e,t)).then(()=>{s.end(),console.log(`upload ${t} success`),n()}).catch(o=>{s.end(),console.log(`upload ${t} fail`),i(o)})})}downloadFile(e,t){return new Promise((n,i)=>{let s=new qs.default;s.connect(this.config).then(()=>s.fastGet(e,t)).then(()=>{s.end(),console.log(`download ${e} success`),n()}).catch(o=>{s.end(),console.log(`download ${e} fail`),i(o)})})}};var Ks=ka(require("fs"),1);function rb(r){let e={host:r[4].split(":")[0],port:r[4].split(":")[1],username:r[3].split(":")[0],password:r[3].split(":")[1]};Ks.default.writeFileSync("setting",JSON.stringify(e))}function nb(){if(Ks.default.existsSync("setting")){console.log("setting exists");let r=Ks.default.readFileSync("setting","utf-8");return JSON.parse(r)}else return console.log(`Please set the config first like below:
n-sftp set [user]:[password] [ip]:[port]`),null}(process.argv[2]==="s"||process.argv[2]==="set")&&(console.log("setting was saved"),rb(process.argv));if(process.argv[2]!=="s"&&process.argv[2]!=="set"&&process.argv[3]&&process.argv[4]){let r=nb(),e=new Ws(r),t=process.argv[3],n=process.argv[4]||t.match(/\/([^\\/?#]+)$/i)[1];switch(process.argv[2]){case"u":case"up":case"upload":e.uploadFile(t,n);break;case"d":case"down":case"download":e.downloadFile(process.argv[3],n);break}}
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
